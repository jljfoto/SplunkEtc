/*!
(The MIT License)

Copyright (c) 2012-2014 Marcin Warpechowski
Copyright (c) 2015 Handsoncode sp. z o.o. <hello@handsoncode.net>

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
'Software'), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/
;!function(b){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function"==typeof define&&define.amd){define([],b)}else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,a.Handsontable=b()}}}(function(){var b;return function a(h,k,j){function g(i,e){if(!k[i]){if(!h[i]){var m="function"==typeof require&&require;if(!e&&m){return m(i,!0)}if(d){return d(i,!0)}if(f[i]&&"undefined"!=typeof window[f[i]]){return window[f[i]]}var o=new Error("Cannot find module '"+i+"'");throw o.code="MODULE_NOT_FOUND",o}var n=k[i]={exports:{}};h[i][0].call(n.exports,function(l){var p=h[i][1][l];return g(p?p:l)},n,n.exports,a,h,k,j)}return k[i].exports}for(var d="function"==typeof require&&require,f=JSON.parse('{"zeroclipboard":"ZeroClipboard","moment":"moment","pikaday":"Pikaday"}')||{},c=0;c<j.length;c++){g(j[c])}return g}({1:[function(d,c,f){window.jQuery&&!function(g){g.fn.handsontable=function(q){var k,v,u,p,j,m=this.first(),h=m.data("handsontable");if("string"!=typeof q){return j=q||{},h?h.updateSettings(j):(h=new Handsontable.Core(m[0],j),m.data("handsontable",h),h.init()),m}if(u=[],arguments.length>1){for(k=1,v=arguments.length;v>k;k++){u.push(arguments[k])}}if(h){if("undefined"==typeof h[q]){throw new Error("Handsontable do not provide action: "+q)}p=h[q].apply(h,u),"destroy"===q&&m.removeData()}return p}}(window.jQuery)},{}],2:[function(N,z,G){Object.defineProperties(G,{WalkontableBorder:{get:function(){return B}},__esModule:{value:!0}});var F,D,J,A,I,R,x=(F=N("helpers/dom/element"),F&&F.__esModule&&F||{"default":F}),P=x.getComputedStyle,K=x.getTrimmingContainer,O=x.innerWidth,M=x.innerHeight,E=x.offset,L=x.outerHeight,H=x.outerWidth,k=(D=N("helpers/dom/event"),D&&D.__esModule&&D||{"default":D}).stopImmediatePropagation,q=(J=N("helpers/browser"),J&&J.__esModule&&J||{"default":J}).isMobileBrowser,j=(A=N("eventManager"),A&&A.__esModule&&A||{"default":A}).EventManager,Q=(I=N("cell/coords"),I&&I.__esModule&&I||{"default":I}).WalkontableCellCoords,B=((R=N("overlay/_base.js"),R&&R.__esModule&&R||{"default":R}).WalkontableOverlay,function(d,c){c&&(this.eventManager=new j(d),this.instance=d,this.wot=d,this.settings=c,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"},this.corner=null,this.cornerStyle=null,this.createBorders(c),this.registerListeners())});$traceurRuntime.createClass(B,{registerListeners:function(){var f=this;this.eventManager.addEventListener(document.body,"mousedown",function(){return f.onMouseDown()}),this.eventManager.addEventListener(document.body,"mouseup",function(){return f.onMouseUp()});for(var c=this,h=function(i,e){c.eventManager.addEventListener(c.main.childNodes[i],"mouseenter",function(l){return f.onMouseEnter(l,f.main.childNodes[i])})},g=0,d=this.main.childNodes.length;d>g;g++){h(g,d)}},onMouseDown:function(){this.mouseDown=!0},onMouseUp:function(){this.mouseDown=!1},onMouseEnter:function(g,d){function l(i){return i.clientY<Math.floor(c.top)?!0:i.clientY>Math.ceil(c.top+c.height)?!0:i.clientX<Math.floor(c.left)?!0:i.clientX>Math.ceil(c.left+c.width)?!0:void 0}function h(i){l(i)&&(f.eventManager.removeEventListener(document.body,"mousemove",h),d.style.display="block")}if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){g.preventDefault(),k(g);var f=this,c=d.getBoundingClientRect();d.style.display="none",this.eventManager.addEventListener(document.body,"mousemove",h)}},createBorders:function(g){this.main=document.createElement("div");var d=["top","left","bottom","right","corner"],l=this.main.style;l.position="absolute",l.top=0,l.left=0;for(var h=0;5>h;h++){var f=d[h],c=document.createElement("div");c.className="wtBorder "+(this.settings.className||""),this.settings[f]&&this.settings[f].hide&&(c.className+=" hidden"),l=c.style,l.backgroundColor=this.settings[f]&&this.settings[f].color?this.settings[f].color:g.border.color,l.height=this.settings[f]&&this.settings[f].width?this.settings[f].width+"px":g.border.width+"px",l.width=this.settings[f]&&this.settings[f].width?this.settings[f].width+"px":g.border.width+"px",this.main.appendChild(c)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),q()&&this.createMultipleSelectorHandles(),this.disappear(),this.wot.wtTable.bordersHolder||(this.wot.wtTable.bordersHolder=document.createElement("div"),this.wot.wtTable.bordersHolder.className="htBorders",this.wot.wtTable.spreader.appendChild(this.wot.wtTable.bordersHolder)),this.wot.wtTable.bordersHolder.insertBefore(this.main,this.wot.wtTable.bordersHolder.firstChild)},createMultipleSelectorHandles:function(){this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};var g=10,d=40;this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var l={position:"absolute",height:d+"px",width:d+"px","border-radius":parseInt(d/1.5,10)+"px"};for(var h in l){l.hasOwnProperty(h)&&(this.selectionHandles.styles.bottomRightHitArea[h]=l[h],this.selectionHandles.styles.topLeftHitArea[h]=l[h])}var f={position:"absolute",height:g+"px",width:g+"px","border-radius":parseInt(g/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(var c in f){f.hasOwnProperty(c)&&(this.selectionHandles.styles.bottomRight[c]=f[c],this.selectionHandles.styles.topLeft[c]=f[c])}this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)},isPartRange:function(d,c){return this.wot.selections.area.cellRange&&(d!=this.wot.selections.area.cellRange.to.row||c!=this.wot.selections.area.cellRange.to.col)},updateMultipleSelectionHandlesPosition:function(m,f,u,p,h,d){var g=parseInt(this.selectionHandles.styles.topLeft.width,10),c=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(u-g,10)+"px",this.selectionHandles.styles.topLeft.left=parseInt(p-g,10)+"px",this.selectionHandles.styles.topLeftHitArea.top=parseInt(u-c/4*3,10)+"px",this.selectionHandles.styles.topLeftHitArea.left=parseInt(p-c/4*3,10)+"px",this.selectionHandles.styles.bottomRight.top=parseInt(u+d,10)+"px",this.selectionHandles.styles.bottomRight.left=parseInt(p+h,10)+"px",this.selectionHandles.styles.bottomRightHitArea.top=parseInt(u+d-c/4,10)+"px",this.selectionHandles.styles.bottomRightHitArea.left=parseInt(p+h-c/4,10)+"px",this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(m,f)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),m==this.wot.wtSettings.getSetting("fixedRowsTop")||f==this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")},appear:function(ao){if(!this.disabled){var ad,ak,aj,ah,an,af,al,ap,ab,aa,V,ag,aq,g,f,ac,d,v,m;m=this.wot.wtTable.getRenderedRowsCount();for(var am=0;m>am;am++){var Z=this.wot.wtTable.rowFilter.renderedToSource(am);if(Z>=ao[0]&&Z<=ao[2]){aq=Z;break}}for(var ae=m-1;ae>=0;ae--){var ai=this.wot.wtTable.rowFilter.renderedToSource(ae);if(ai>=ao[0]&&ai<=ao[2]){f=ai;break}}m=this.wot.wtTable.getRenderedColumnsCount();for(var Y=0;m>Y;Y++){var h=this.wot.wtTable.columnFilter.renderedToSource(Y);if(h>=ao[1]&&h<=ao[3]){g=h;break}}for(var p=m-1;p>=0;p--){var U=this.wot.wtTable.columnFilter.renderedToSource(p);if(U>=ao[1]&&U<=ao[3]){ac=U;break}}if(void 0===aq||void 0===g){return void this.disappear()}ad=aq!==f||g!==ac,ak=this.wot.wtTable.getCell(new Q(aq,g)),aj=ad?this.wot.wtTable.getCell(new Q(f,ac)):ak,ah=E(ak),an=ad?E(aj):ah,af=E(this.wot.wtTable.TABLE),ap=ah.top,V=an.top+L(aj)-ap,aa=ah.left,ag=an.left+H(aj)-aa,al=ap-af.top-1,ab=aa-af.left-1;var c=P(ak);parseInt(c.borderTopWidth,10)>0&&(al+=1,V=V>0?V-1:0),parseInt(c.borderLeftWidth,10)>0&&(ab+=1,ag=ag>0?ag-1:0),this.topStyle.top=al+"px",this.topStyle.left=ab+"px",this.topStyle.width=ag+"px",this.topStyle.display="block",this.leftStyle.top=al+"px",this.leftStyle.left=ab+"px",this.leftStyle.height=V+"px",this.leftStyle.display="block";var X=Math.floor(this.settings.border.width/2);this.bottomStyle.top=al+V-X+"px",this.bottomStyle.left=ab+"px",this.bottomStyle.width=ag+"px",this.bottomStyle.display="block",this.rightStyle.top=al+"px",this.rightStyle.left=ab+ag-X+"px",this.rightStyle.height=V+1+"px",this.rightStyle.display="block",q()||!this.hasSetting(this.settings.border.cornerVisible)||this.isPartRange(f,ac)?this.cornerStyle.display="none":(this.cornerStyle.top=al+V-4+"px",this.cornerStyle.left=ab+ag-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="block",d=K(this.wot.wtTable.TABLE),ac===this.wot.getSetting("totalColumns")-1&&(v=aj.offsetLeft+H(aj)>=O(d),v&&(this.cornerStyle.left=Math.floor(ab+ag-3-parseInt(this.cornerDefaultStyle.width)/2)+"px",this.cornerStyle.borderRightWidth=0)),f===this.wot.getSetting("totalRows")-1&&(v=aj.offsetTop+L(aj)>=M(d),v&&(this.cornerStyle.top=Math.floor(al+V-3-parseInt(this.cornerDefaultStyle.height)/2)+"px",this.cornerStyle.borderBottomWidth=0))),q()&&this.updateMultipleSelectionHandlesPosition(aq,g,al,ab,ag,V)}},disappear:function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",q()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")},hasSetting:function(c){return"function"==typeof c?c():!!c}},{}),window.WalkontableBorder=B},{"cell/coords":5,eventManager:41,"helpers/browser":43,"helpers/dom/element":46,"helpers/dom/event":47,"overlay/_base.js":11}],3:[function(g,d,j){Object.defineProperties(j,{WalkontableViewportColumnsCalculator:{get:function(){return f}},__esModule:{value:!0}});var h=new WeakMap,f=function(v,p,w,u,o,q,m){var k=void 0!==arguments[7]?arguments[7]:function(i){return i};h.set(this,{viewportWidth:v,scrollOffset:p,totalColumns:w,columnWidthFn:u,overrideFn:o,onlyFullyVisible:q,stretchingColumnWidthFn:k}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=m,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()},c=f;$traceurRuntime.createClass(f,{calculate:function(){for(var v,A=0,m=!0,k=[],p=h.get(this),B=p.onlyFullyVisible,o=p.overrideFn,y=p.scrollOffset,z=p.totalColumns,x=p.viewportWidth,q=0;z>q;q++){if(v=this._getColumnWidth(q),y>=A&&!B&&(this.startColumn=q),A>=y&&y+x>=A+v&&(null==this.startColumn&&(this.startColumn=q),this.endColumn=q),k.push(A),A+=v,B||(this.endColumn=q),A>=y+x){m=!1;break}}if(this.endColumn===z-1&&m){for(this.startColumn=this.endColumn;this.startColumn>0;){var w=k[this.endColumn]+v-k[this.startColumn-1];if((x>=w||!B)&&this.startColumn--,w>x){break}}}null!==this.startColumn&&o&&o(this),this.startPosition=k[this.startColumn],void 0==this.startPosition&&(this.startPosition=null),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)},refreshStretching:function(q){if("none"!==this.stretch){this.totalTargetWidth=q;for(var y=h.get(this),m=y.totalColumns,k=0,p=0;m>p;p++){var z=this._getColumnWidth(p),o=y.stretchingColumnWidthFn(void 0,p);"number"==typeof o?q-=o:k+=z}var w=q-k;if("all"===this.stretch&&w>0){this.stretchAllRatio=q/k,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0}else{if("last"===this.stretch&&q!==1/0){var x=this._getColumnWidth(m-1),v=w+x;this.stretchLastWidth=v>=0?v:x}}}},getStretchedColumnWidth:function(k,i){var l=null;return"all"===this.stretch&&0!==this.stretchAllRatio?l=this._getStretchedAllColumnWidth(k,i):"last"===this.stretch&&0!==this.stretchLastWidth&&(l=this._getStretchedLastColumnWidth(k)),l},_getStretchedAllColumnWidth:function(v,p){var w=0,u=h.get(this),o=u.totalColumns;if(!this.stretchAllColumnsWidth[v]){var q=Math.round(p*this.stretchAllRatio),m=u.stretchingColumnWidthFn(q,v);void 0===m?this.stretchAllColumnsWidth[v]=q:this.stretchAllColumnsWidth[v]=isNaN(m)?this._getColumnWidth(v):m}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var k=0;k<this.stretchAllColumnsWidth.length;k++){w+=this.stretchAllColumnsWidth[k]}w!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-w)}return this.stretchAllColumnsWidth[v]},_getStretchedLastColumnWidth:function(k){var i=h.get(this),l=i.totalColumns;return k===l-1?this.stretchLastWidth:null},_getColumnWidth:function(k){var i=h.get(this).columnWidthFn(k);return void 0===i&&(i=c.DEFAULT_WIDTH),i}},{get DEFAULT_WIDTH(){return 50}}),window.WalkontableViewportColumnsCalculator=f},{}],4:[function(g,d,j){Object.defineProperties(j,{WalkontableViewportRowsCalculator:{get:function(){return f}},__esModule:{value:!0}});var h=new WeakMap,f=function(u,o,v,q,m,p,k){h.set(this,{viewportHeight:u,scrollOffset:o,totalRows:v,rowHeightFn:q,overrideFn:m,onlyFullyVisible:p,horizontalScrollbarHeight:k}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()},c=f;$traceurRuntime.createClass(f,{calculate:function(){for(var x=0,C=!0,m=[],i=h.get(this),D=i.onlyFullyVisible,o=i.overrideFn,A=i.rowHeightFn,B=i.scrollOffset,z=i.totalRows,q=i.viewportHeight,y=i.horizontalScrollbarHeight||0,w=0;z>w;w++){var k=A(w);if(void 0===k&&(k=c.DEFAULT_HEIGHT),B>=x&&!D&&(this.startRow=w),x>=B&&B+q-y>=x+k&&(null===this.startRow&&(this.startRow=w),this.endRow=w),m.push(x),x+=k,D||(this.endRow=w),x>=B+q-y){C=!1;break}}if(this.endRow===z-1&&C){for(this.startRow=this.endRow;this.startRow>0;){var v=m[this.endRow]+k-m[this.startRow-1];if((q-y>=v||!D)&&this.startRow--,v>=q-y){break}}}null!==this.startRow&&o&&o(this),this.startPosition=m[this.startRow],void 0==this.startPosition&&(this.startPosition=null),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}},{get DEFAULT_HEIGHT(){return 23}}),window.WalkontableViewportRowsCalculator=f},{}],5:[function(d,c,g){Object.defineProperties(g,{WalkontableCellCoords:{get:function(){return f}},__esModule:{value:!0}});var f=function(i,h){"undefined"!=typeof i&&"undefined"!=typeof h?(this.row=i,this.col=h):(this.row=null,this.col=null)};$traceurRuntime.createClass(f,{isValid:function(h){return this.row<0||this.col<0?!1:!(this.row>=h.getSetting("totalRows")||this.col>=h.getSetting("totalColumns"))},isEqual:function(h){return h===this?!0:this.row===h.row&&this.col===h.col},isSouthEastOf:function(h){return this.row>=h.row&&this.col>=h.col},isNorthWestOf:function(h){return this.row<=h.row&&this.col<=h.col},isSouthWestOf:function(h){return this.row>=h.row&&this.col<=h.col},isNorthEastOf:function(h){return this.row<=h.row&&this.col>=h.col}},{}),window.WalkontableCellCoords=f},{}],6:[function(h,d,k){Object.defineProperties(k,{WalkontableCellRange:{get:function(){return c}},__esModule:{value:!0}});var j,g=(j=h("cell/coords"),j&&j.__esModule&&j||{"default":j}).WalkontableCellCoords,c=function(l,i,m){this.highlight=l,this.from=i,this.to=m},f=c;$traceurRuntime.createClass(c,{isValid:function(i){return this.from.isValid(i)&&this.to.isValid(i)},isSingle:function(){return this.from.row===this.to.row&&this.from.col===this.to.col},getHeight:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1},getWidth:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1},includes:function(q){var m=q,u=m.row,s=m.col,p=this.getTopLeftCorner(),l=this.getBottomRightCorner();return p.row<=u&&l.row>=u&&p.col<=s&&l.col>=s},includesRange:function(i){return this.includes(i.getTopLeftCorner())&&this.includes(i.getBottomRightCorner())},isEqual:function(i){return Math.min(this.from.row,this.to.row)==Math.min(i.from.row,i.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(i.from.row,i.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(i.from.col,i.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(i.from.col,i.to.col)},overlaps:function(i){return i.isSouthEastOf(this.getTopLeftCorner())&&i.isNorthWestOf(this.getBottomRightCorner())},isSouthEastOf:function(i){return this.getTopLeftCorner().isSouthEastOf(i)||this.getBottomRightCorner().isSouthEastOf(i)},isNorthWestOf:function(i){return this.getTopLeftCorner().isNorthWestOf(i)||this.getBottomRightCorner().isNorthWestOf(i)},expand:function(l){var i=this.getTopLeftCorner(),m=this.getBottomRightCorner();return l.row<i.row||l.col<i.col||l.row>m.row||l.col>m.col?(this.from=new g(Math.min(i.row,l.row),Math.min(i.col,l.col)),this.to=new g(Math.max(m.row,l.row),Math.max(m.col,l.col)),!0):!1},expandByRange:function(y){if(this.includesRange(y)||!this.overlaps(y)){return !1}var D=this.getTopLeftCorner(),r=this.getBottomRightCorner(),q=(this.getTopRightCorner(),this.getBottomLeftCorner(),y.getTopLeftCorner()),v=y.getBottomRightCorner(),s=Math.min(D.row,q.row),B=Math.min(D.col,q.col),C=Math.max(r.row,v.row),A=Math.max(r.col,v.col),w=new g(s,B),z=new g(C,A),x=new f(w,w,z).isCorner(this.from,y),m=y.isEqual(new f(w,w,z));return x&&!m&&(this.from.col>w.col&&(w.col=A,z.col=B),this.from.row>w.row&&(w.row=C,z.row=s)),this.from=w,this.to=z,!0},getDirection:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0},setDirection:function(i){switch(i){case"NW-SE":this.from=this.getTopLeftCorner(),this.to=this.getBottomRightCorner();break;case"NE-SW":this.from=this.getTopRightCorner(),this.to=this.getBottomLeftCorner();break;case"SE-NW":this.from=this.getBottomRightCorner(),this.to=this.getTopLeftCorner();break;case"SW-NE":this.from=this.getBottomLeftCorner(),this.to=this.getTopRightCorner()}},getTopLeftCorner:function(){return new g(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},getBottomRightCorner:function(){return new g(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getTopRightCorner:function(){return new g(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getBottomLeftCorner:function(){return new g(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},isCorner:function(l,i){return i&&i.includes(l)&&(this.getTopLeftCorner().isEqual(new g(i.from.row,i.from.col))||this.getTopRightCorner().isEqual(new g(i.from.row,i.to.col))||this.getBottomLeftCorner().isEqual(new g(i.to.row,i.from.col))||this.getBottomRightCorner().isEqual(new g(i.to.row,i.to.col)))?!0:l.isEqual(this.getTopLeftCorner())||l.isEqual(this.getTopRightCorner())||l.isEqual(this.getBottomLeftCorner())||l.isEqual(this.getBottomRightCorner())},getOppositeCorner:function(l,i){if(!(l instanceof g)){return !1}if(i&&i.includes(l)){if(this.getTopLeftCorner().isEqual(new g(i.from.row,i.from.col))){return this.getBottomRightCorner()}if(this.getTopRightCorner().isEqual(new g(i.from.row,i.to.col))){return this.getBottomLeftCorner()}if(this.getBottomLeftCorner().isEqual(new g(i.to.row,i.from.col))){return this.getTopRightCorner()}if(this.getBottomRightCorner().isEqual(new g(i.to.row,i.to.col))){return this.getTopLeftCorner()}}return l.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():l.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():l.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():l.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0},getBordersSharedWith:function(l){if(!this.includesRange(l)){return[]}var i={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},p={top:Math.min(l.from.row,l.to.row),bottom:Math.max(l.from.row,l.to.row),left:Math.min(l.from.col,l.to.col),right:Math.max(l.from.col,l.to.col)},m=[];return i.top==p.top&&m.push("top"),i.right==p.right&&m.push("right"),i.bottom==p.bottom&&m.push("bottom"),i.left==p.left&&m.push("left"),m},getInner:function(){for(var p=this.getTopLeftCorner(),m=this.getBottomRightCorner(),r=[],q=p.row;q<=m.row;q++){for(var l=p.col;l<=m.col;l++){this.from.row===q&&this.from.col===l||this.to.row===q&&this.to.col===l||r.push(new g(q,l))}}return r},getAll:function(){for(var p=this.getTopLeftCorner(),m=this.getBottomRightCorner(),r=[],q=p.row;q<=m.row;q++){for(var l=p.col;l<=m.col;l++){p.row===q&&p.col===l?r.push(p):m.row===q&&m.col===l?r.push(m):r.push(new g(q,l))}}return r},forAll:function(q){for(var m=this.getTopLeftCorner(),u=this.getBottomRightCorner(),s=m.row;s<=u.row;s++){for(var p=m.col;p<=u.col;p++){var l=q(s,p);if(l===!1){return}}}}},{}),window.WalkontableCellRange=c},{"cell/coords":5}],7:[function(ah,N,Z){Object.defineProperties(Z,{Walkontable:{get:function(){return W}},__esModule:{value:!0}});var Y,V,ad,Q,ab,al,K,aj,ae,ai,ag,X,af,aa,I=(Y=ah("helpers/dom/element"),Y&&Y.__esModule&&Y||{"default":Y}),J=I.addClass,F=I.fastInnerText,ak=I.isVisible,U=I.removeClass,am=(V=ah("helpers/object"),V&&V.__esModule&&V||{"default":V}).objectEach,x=(ad=ah("helpers/string"),ad&&ad.__esModule&&ad||{"default":ad}),q=x.toUpperCaseFirst,L=x.randomString,j=(Q=ah("event"),Q&&Q.__esModule&&Q||{"default":Q}).WalkontableEvent,B=(ab=ah("overlays"),ab&&ab.__esModule&&ab||{"default":ab}).WalkontableOverlays,z=(al=ah("scroll"),al&&al.__esModule&&al||{"default":al}).WalkontableScroll,ac=(K=ah("settings"),K&&K.__esModule&&K||{"default":K}).WalkontableSettings,G=(aj=ah("table"),aj&&aj.__esModule&&aj||{"default":aj}).WalkontableTable,P=(ae=ah("viewport"),ae&&ae.__esModule&&ae||{"default":ae}).WalkontableViewport,W=((ai=ah("overlay/_base.js"),ai&&ai.__esModule&&ai||{"default":ai}).WalkontableOverlay,(ag=ah("overlay/top.js"),ag&&ag.__esModule&&ag||{"default":ag}).WalkontableTopOverlay,(X=ah("overlay/left.js"),X&&X.__esModule&&X||{"default":X}).WalkontableLeftOverlay,(af=ah("overlay/debug.js"),af&&af.__esModule&&af||{"default":af}).WalkontableDebugOverlay,(aa=ah("overlay/topLeftCorner.js"),aa&&aa.__esModule&&aa||{"default":aa}).WalkontableTopLeftCornerOverlay,function(d){var c=[];if(this.guid="wt_"+L(),d.cloneSource?(this.cloneSource=d.cloneSource,this.cloneOverlay=d.cloneOverlay,this.wtSettings=d.cloneSource.wtSettings,this.wtTable=new G(this,d.table,d.wtRootElement),this.wtScroll=new z(this),this.wtViewport=d.cloneSource.wtViewport,this.wtEvent=new j(this),this.selections=this.cloneSource.selections):(this.wtSettings=new ac(this,d),this.wtTable=new G(this,d.table),this.wtScroll=new z(this),this.wtViewport=new P(this),this.wtEvent=new j(this),this.selections=this.getSetting("selections"),this.wtOverlays=new B(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var g=0,f=this.wtTable.THEAD.childNodes[0].childNodes.length;f>g;g++){c.push(this.wtTable.THEAD.childNodes[0].childNodes[g].innerHTML)}this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(h,i){F(i,c[h])}])}this.drawn=!1,this.drawInterrupted=!1});$traceurRuntime.createClass(W,{draw:function(){var c=void 0!==arguments[0]?arguments[0]:!1;return this.drawInterrupted=!1,c||ak(this.wtTable.TABLE)?this.wtTable.draw(c):this.drawInterrupted=!0,this},getCell:function(g){var d=void 0!==arguments[1]?arguments[1]:!1;if(!d){return this.wtTable.getCell(g)}var k=this.wtSettings.getSetting("totalRows"),h=this.wtSettings.getSetting("fixedRowsTop"),f=this.wtSettings.getSetting("fixedRowsBottom"),c=this.wtSettings.getSetting("fixedColumnsLeft");if(g.row<h&&g.col<c){return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(g)}if(g.row<h){return this.wtOverlays.topOverlay.clone.wtTable.getCell(g)}if(g.col<c&&g.row>=k-f){if(this.wtOverlays.bottomLeftCornerOverlay.clone){return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(g)}}else{if(g.col<c){return this.wtOverlays.leftOverlay.clone.wtTable.getCell(g)}if(g.row<k&&g.row>k-f&&this.wtOverlays.bottomOverlay.clone){return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(g)}}return this.wtTable.getCell(g)},update:function(d,c){return this.wtSettings.update(d,c)},scrollVertical:function(c){return this.wtOverlays.topOverlay.scrollTo(c),this.getSetting("onScrollVertically"),this},scrollHorizontal:function(c){return this.wtOverlays.leftOverlay.scrollTo(c),this.getSetting("onScrollHorizontally"),this},scrollViewport:function(c){return this.wtScroll.scrollViewport(c),this},getViewport:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},getOverlayName:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"},isOverlayName:function(c){return this.cloneOverlay?this.cloneOverlay.type===c:!1},exportSettingsAsClassNames:function(){var d=this,c={rowHeaders:["array"],columnHeaders:["array"]},g=[],f=[];am(c,function(e,h){e.indexOf("array")>-1&&d.getSetting(h).length&&f.push("ht"+q(h)),g.push("ht"+q(h))}),U(this.wtTable.wtRootElement.parentNode,g),J(this.wtTable.wtRootElement.parentNode,f)},getSetting:function(f,c,h,g,d){return this.wtSettings.getSetting(f,c,h,g,d)},hasSetting:function(c){return this.wtSettings.has(c)},destroy:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{}),window.Walkontable=W},{event:8,"helpers/dom/element":46,"helpers/object":52,"helpers/string":54,"overlay/_base.js":11,"overlay/debug.js":12,"overlay/left.js":13,"overlay/top.js":14,"overlay/topLeftCorner.js":15,overlays:16,scroll:17,settings:19,table:20,viewport:22}],8:[function(q,z,j){function g(G){var H=this,u=v(G);this.instance=G;var h=[null,null];this.dblClickTimeout=[null,null];var c,D=function(i){var l=H.parentCell(i.realTarget);y(i.realTarget,"corner")?H.instance.getSetting("onCellCornerMouseDown",i,i.realTarget):l.TD&&H.instance.hasSetting("onCellMouseDown")&&H.instance.getSetting("onCellMouseDown",i,l.coords,l.TD,H.instance),2!==i.button&&l.TD&&(h[0]=l.TD,clearTimeout(H.dblClickTimeout[0]),H.dblClickTimeout[0]=setTimeout(function(){h[0]=null},1000))},I=function(i){H.instance.touchMoving=!0},C=function(i){u.addEventListener(this,"touchmove",I),H.checkIfTouchMove=setTimeout(function(){return H.instance.touchMoving===!0?(H.instance.touchMoving=void 0,void u.removeEventListener("touchmove",I,!1)):void D(i)},30)},F=function(l){var t,s,i;H.instance.hasSetting("onCellMouseOver")&&(t=H.instance.wtTable.TABLE,s=x(l.realTarget,["TD","TH"],t),i=H.instance.cloneSource||H.instance,s&&s!==i.lastMouseOver&&w(s,t)&&(i.lastMouseOver=s,H.instance.getSetting("onCellMouseOver",l,H.instance.wtTable.getCoords(s),s,H.instance)))},d=function(i){if(2!==i.button){var l=H.parentCell(i.realTarget);l.TD===h[0]&&l.TD===h[1]?(y(i.realTarget,"corner")?H.instance.getSetting("onCellCornerDblClick",i,l.coords,l.TD,H.instance):H.instance.getSetting("onCellDblClick",i,l.coords,l.TD,H.instance),h[0]=null,h[1]=null):l.TD===h[0]&&(h[1]=l.TD,clearTimeout(H.dblClickTimeout[1]),H.dblClickTimeout[1]=setTimeout(function(){h[1]=null},500))}},E=function(i){clearTimeout(c),i.preventDefault(),d(i)};if(u.addEventListener(this.instance.wtTable.holder,"mousedown",D),u.addEventListener(this.instance.wtTable.TABLE,"mouseover",F),u.addEventListener(this.instance.wtTable.holder,"mouseup",d),this.instance.wtTable.holder.parentNode.parentNode&&p()&&!H.instance.wtTable.isWorkingOnClone()){var B="."+this.instance.wtTable.holder.parentNode.className.split(" ").join(".");u.addEventListener(this.instance.wtTable.holder,"touchstart",function(i){H.instance.touchApplied=!0,w(i.target,B)&&C.call(i.target,i)}),u.addEventListener(this.instance.wtTable.holder,"touchend",function(i){H.instance.touchApplied=!1,w(i.target,B)&&E.call(i.target,i)}),H.instance.momentumScrolling||(H.instance.momentumScrolling={}),u.addEventListener(this.instance.wtTable.holder,"scroll",function(i){clearTimeout(H.instance.momentumScrolling._timeout),H.instance.momentumScrolling.ongoing||H.instance.getSetting("onBeforeTouchScroll"),H.instance.momentumScrolling.ongoing=!0,H.instance.momentumScrolling._timeout=setTimeout(function(){H.instance.touchApplied||(H.instance.momentumScrolling.ongoing=!1,H.instance.getSetting("onAfterMomentumScroll"))},200)})}u.addEventListener(window,"resize",function(){"none"!==H.instance.getSetting("stretchH")&&H.instance.draw()}),this.destroy=function(){clearTimeout(this.dblClickTimeout[0]),clearTimeout(this.dblClickTimeout[1]),u.destroy()}}Object.defineProperties(j,{WalkontableEvent:{get:function(){return g}},__esModule:{value:!0}});var f,m,A,k=(f=q("helpers/dom/element"),f&&f.__esModule&&f||{"default":f}),x=k.closest,y=k.hasClass,w=k.isChildOf,p=(m=q("helpers/browser"),m&&m.__esModule&&m||{"default":m}).isMobileBrowser,v=(A=q("eventManager"),A&&A.__esModule&&A||{"default":A}).eventManager;g.prototype.parentCell=function(h){var c={},l=this.instance.wtTable.TABLE,i=x(h,["TD","TH"],l),d=x(i,["TABLE"]);return i&&w(i,l)&&d==l?(c.coords=this.instance.wtTable.getCoords(i),c.TD=i):y(h,"wtBorder")&&y(h,"current")?(c.coords=this.instance.selections.current.cellRange.highlight,c.TD=this.instance.wtTable.getCell(c.coords)):y(h,"wtBorder")&&y(h,"area")&&this.instance.selections.area.cellRange&&(c.coords=this.instance.selections.area.cellRange.to,c.TD=this.instance.wtTable.getCell(c.coords)),c},window.WalkontableEvent=g},{eventManager:41,"helpers/browser":43,"helpers/dom/element":46}],9:[function(d,c,g){Object.defineProperties(g,{WalkontableColumnFilter:{get:function(){return f}},__esModule:{value:!0}});var f=function(i,h,j){this.offset=i,this.total=h,this.countTH=j};$traceurRuntime.createClass(f,{offsetted:function(h){return h+this.offset},unOffsetted:function(h){return h-this.offset},renderedToSource:function(h){return this.offsetted(h)},sourceToRendered:function(h){return this.unOffsetted(h)},offsettedTH:function(h){return h-this.countTH},unOffsettedTH:function(h){return h+this.countTH},visibleRowHeadedColumnToSourceColumn:function(h){return this.renderedToSource(this.offsettedTH(h))},sourceColumnToVisibleRowHeadedColumn:function(h){return this.unOffsettedTH(this.sourceToRendered(h))}},{}),window.WalkontableColumnFilter=f},{}],10:[function(d,c,g){Object.defineProperties(g,{WalkontableRowFilter:{get:function(){return f}},__esModule:{value:!0}});var f=function(i,h,j){this.offset=i,this.total=h,this.countTH=j};$traceurRuntime.createClass(f,{offsetted:function(h){return h+this.offset},unOffsetted:function(h){return h-this.offset},renderedToSource:function(h){return this.offsetted(h)},sourceToRendered:function(h){return this.unOffsetted(h)},offsettedTH:function(h){return h-this.countTH},unOffsettedTH:function(h){return h+this.countTH},visibleColHeadedRowToSourceRow:function(h){return this.renderedToSource(this.offsettedTH(h))},sourceRowToVisibleColHeadedRow:function(h){return this.unOffsettedTH(this.sourceToRendered(h))}},{}),window.WalkontableRowFilter=f},{}],11:[function(w,B,k){Object.defineProperties(k,{WalkontableOverlay:{get:function(){return x}},__esModule:{value:!0}});var j,g,p,C=(j=w("helpers/dom/element"),j&&j.__esModule&&j||{"default":j}),m=C.getScrollableElement,z=C.getTrimmingContainer,A=(g=w("helpers/object"),g&&g.__esModule&&g||{"default":g}).defineGetter,y=(p=w("eventManager"),p&&p.__esModule&&p||{"default":p}).eventManager,q={},x=function(c){A(this,"wot",c,{writable:!1}),this.instance=this.wot,this.type="",this.mainTableScrollableElement=null,this.TABLE=this.wot.wtTable.TABLE,this.hider=this.wot.wtTable.hider,this.spreader=this.wot.wtTable.spreader,this.holder=this.wot.wtTable.holder,this.wtRootElement=this.wot.wtTable.wtRootElement,this.trimmingContainer=z(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.areElementSizesAdjusted=!1},v=x;$traceurRuntime.createClass(x,{shouldBeRendered:function(){return !0},updateTrimmingContainer:function(){this.trimmingContainer=z(this.hider.parentNode.parentNode)},updateMainScrollableElement:function(){this.mainTableScrollableElement=m(this.wot.wtTable.TABLE)},makeClone:function(d){if(-1===v.CLONE_TYPES.indexOf(d)){throw new Error('Clone type "'+d+'" is not supported.')}var c=document.createElement("DIV"),h=document.createElement("TABLE");c.className="ht_clone_"+d+" handsontable",c.style.position="absolute",c.style.top=0,c.style.left=0,c.style.overflow="hidden",h.className=this.wot.wtTable.TABLE.className,c.appendChild(h),this.type=d,this.wot.wtTable.wtRootElement.parentNode.appendChild(c);var f=this.wot.getSetting("preventOverflow");return f===!0||"horizontal"===f&&this.type===v.CLONE_TOP||"vertical"===f&&this.type===v.CLONE_LEFT?this.mainTableScrollableElement=window:this.mainTableScrollableElement=m(this.wot.wtTable.TABLE),new Walkontable({cloneSource:this.wot,cloneOverlay:this,table:h})},refresh:function(){var d=void 0!==arguments[0]?arguments[0]:!1,c=this.shouldBeRendered();this.clone&&(this.needFullRender||c)&&this.clone.draw(d),this.needFullRender=c},destroy:function(){y(this.clone).destroy()}},{get CLONE_TOP(){return"top"},get CLONE_BOTTOM(){return"bottom"},get CLONE_LEFT(){return"left"},get CLONE_TOP_LEFT_CORNER(){return"top_left_corner"},get CLONE_BOTTOM_LEFT_CORNER(){return"bottom_left_corner"},get CLONE_DEBUG(){return"debug"},get CLONE_TYPES(){return[v.CLONE_TOP,v.CLONE_BOTTOM,v.CLONE_LEFT,v.CLONE_TOP_LEFT_CORNER,v.CLONE_BOTTOM_LEFT_CORNER,v.CLONE_DEBUG]},registerOverlay:function(d,c){if(-1===v.CLONE_TYPES.indexOf(d)){throw new Error("Unsupported overlay ("+d+").")}q[d]=c},createOverlay:function(d,c){return new q[d](c)},isOverlayTypeOf:function(d,c){return d&&q[c]?d instanceof q[c]:!1}}),window.WalkontableOverlay=x},{eventManager:41,"helpers/dom/element":46,"helpers/object":52}],12:[function(j,m,f){Object.defineProperties(f,{WalkontableDebugOverlay:{get:function(){return g}},__esModule:{value:!0}});var d,c,h=(d=j("helpers/dom/element"),d&&d.__esModule&&d||{"default":d}).addClass,p=(c=j("_base"),c&&c.__esModule&&c||{"default":c}).WalkontableOverlay,g=function(i){$traceurRuntime.superConstructor(k).call(this,i),this.clone=this.makeClone(p.CLONE_DEBUG),this.clone.wtTable.holder.style.opacity=0.4,this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",h(this.clone.wtTable.holder.parentNode,"wtDebugVisible")},k=g;$traceurRuntime.createClass(g,{},{},p),window.WalkontableDebugOverlay=g,p.registerOverlay(p.CLONE_DEBUG,g)},{_base:11,"helpers/dom/element":46}],13:[function(J,x,C){Object.defineProperties(C,{WalkontableLeftOverlay:{get:function(){return j}},__esModule:{value:!0}});var B,z,F=(B=J("helpers/dom/element"),B&&B.__esModule&&B||{"default":B}),y=F.addClass,E=F.getScrollbarWidth,M=F.getScrollLeft,q=F.getWindowScrollTop,L=F.hasClass,G=F.outerWidth,K=F.innerHeight,I=F.removeClass,A=F.setOverlayPosition,H=F.resetCssTransform,D=(z=J("_base"),z&&z.__esModule&&z||{"default":z}).WalkontableOverlay,j=function(c){$traceurRuntime.superConstructor(k).call(this,c),this.clone=this.makeClone(D.CLONE_LEFT)},k=j;$traceurRuntime.createClass(j,{shouldBeRendered:function(){return !(!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)},resetFixedPosition:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var m=this.clone.wtTable.holder.parentNode,f=0,u=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||u&&"horizontal"===u){f=this.getScrollPosition(),H(m)}else{var p,h,d=this.wot.wtTable.hider.getBoundingClientRect(),g=Math.ceil(d.left),c=Math.ceil(d.right);h=this.wot.wtTable.hider.style.top,h=""===h?0:h,p=0>g&&c-m.offsetWidth>0?-g:0,f=p,p+="px",A(m,p,h)}this.adjustHeaderBordersPosition(f),this.adjustElementsSize()}},setScrollPosition:function(c){this.mainTableScrollableElement===window?window.scrollTo(c,q()):this.mainTableScrollableElement.scrollLeft=c},onScroll:function(){this.wot.getSetting("onScrollVertically")},sumCellSizes:function(d,c){for(var g=0,f=this.wot.wtSettings.defaultColumnWidth;c>d;){g+=this.wot.wtTable.getStretchedColumnWidth(d)||f,d++}return g},adjustElementsSize:function(){var c=void 0!==arguments[0]?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||c)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),c||(this.areElementSizesAdjusted=!0))},adjustRootElementSize:function(){var h,d=this.wot.wtTable.holder,m=d.clientHeight===d.offsetHeight?0:E(),l=this.clone.wtTable.holder.parentNode,g=l.style,c=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||"vertical"===c){var f=this.wot.wtViewport.getWorkspaceHeight()-m;f=Math.min(f,K(this.wot.wtTable.wtRootElement)),g.height=f+"px"}else{g.height=""}this.clone.wtTable.holder.style.height=g.height,h=G(this.clone.wtTable.TABLE),g.width=(0===h?h:h+4)+"px"},adjustRootChildrenSize:function(){var c=E();this.clone.wtTable.hider.style.height=this.hider.style.height,this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height,0===c&&(c=30),this.clone.wtTable.holder.style.width=parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+c+"px"},applyToDOM:function(){var c=this.wot.getSetting("totalColumns");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition){this.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px"}else{if(0!==c){throw new Error("Incorrect value of the columnsRenderCalculator")}this.spreader.style.left="0"}this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.top=""},scrollTo:function(g,d){var l=this.getTableParentOffset(),h=this.wot.cloneSource?this.wot.cloneSource:this.wot,f=h.wtTable.holder,c=0;d&&f.offsetWidth!==f.clientWidth&&(c=E()),d?(l+=this.sumCellSizes(0,g+1),l-=this.wot.wtViewport.getViewportWidth()):l+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),g),l+=c,this.setScrollPosition(l)},getTableParentOffset:function(){var d=this.wot.getSetting("preventOverflow"),c=0;return d||this.trimmingContainer!==window||(c=this.wot.wtTable.holderOffset.left),c},getScrollPosition:function(){return M(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(f){var c=this.wot.wtTable.holder.parentNode,h=this.wot.getSetting("rowHeaders"),g=this.wot.getSetting("fixedColumnsLeft");if(g&&!h.length){y(c,"innerBorderLeft")}else{if(!g&&h.length){var d=L(c,"innerBorderLeft");f?y(c,"innerBorderLeft"):I(c,"innerBorderLeft"),(!d&&f||d&&!f)&&this.wot.wtOverlays.adjustElementsSize()}}}},{},D),window.WalkontableLeftOverlay=j,D.registerOverlay(D.CLONE_LEFT,j)},{_base:11,"helpers/dom/element":46}],14:[function(J,x,C){Object.defineProperties(C,{WalkontableTopOverlay:{get:function(){return j}},__esModule:{value:!0}});var B,z,F=(B=J("helpers/dom/element"),B&&B.__esModule&&B||{"default":B}),y=F.addClass,E=F.getScrollbarWidth,M=F.getScrollTop,q=F.getWindowScrollLeft,L=F.hasClass,G=F.outerHeight,K=F.innerWidth,I=F.removeClass,A=F.setOverlayPosition,H=F.resetCssTransform,D=(z=J("_base"),z&&z.__esModule&&z||{"default":z}).WalkontableOverlay,j=function(c){$traceurRuntime.superConstructor(k).call(this,c),this.clone=this.makeClone(D.CLONE_TOP)},k=j;$traceurRuntime.createClass(j,{shouldBeRendered:function(){return !(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length)},resetFixedPosition:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var m=this.clone.wtTable.holder.parentNode,f=0,u=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||u&&"vertical"===u){f=this.getScrollPosition(),H(m)}else{var p,h,d=this.wot.wtTable.hider.getBoundingClientRect(),g=Math.ceil(d.top),c=Math.ceil(d.bottom);p=this.wot.wtTable.hider.style.left,p=""===p?0:p,h=0>g&&c-m.offsetHeight>0?-g:0,f=h,h+="px",A(m,p,h)}this.adjustHeaderBordersPosition(f),this.adjustElementsSize()}},setScrollPosition:function(c){this.mainTableScrollableElement===window?window.scrollTo(q(),c):this.mainTableScrollableElement.scrollTop=c},onScroll:function(){this.wot.getSetting("onScrollHorizontally")},sumCellSizes:function(f,c){for(var h=0,g=this.wot.wtSettings.settings.defaultRowHeight;c>f;){var d=this.wot.wtTable.getRowHeight(f);h+=void 0===d?g:d,f++}return h},adjustElementsSize:function(){var c=void 0!==arguments[0]?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||c)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),c||(this.areElementSizesAdjusted=!0))},adjustRootElementSize:function(){var h,d=this.wot.wtTable.holder,m=d.clientWidth===d.offsetWidth?0:E(),l=this.clone.wtTable.holder.parentNode,g=l.style,c=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||"horizontal"===c){var f=this.wot.wtViewport.getWorkspaceWidth()-m;f=Math.min(f,K(this.wot.wtTable.wtRootElement)),g.width=f+"px"}else{g.width=""}this.clone.wtTable.holder.style.width=g.width,h=G(this.clone.wtTable.TABLE),g.height=(0===h?h:h+4)+"px"},adjustRootChildrenSize:function(){var c=E();this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===c&&(c=30),this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+c+"px"},applyToDOM:function(){var c=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition){this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px"}else{if(0!==c){throw new Error("Incorrect value of the rowsRenderCalculator")}this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.left=""},scrollTo:function(l,f){var p=this.getTableParentOffset(),m=this.wot.cloneSource?this.wot.cloneSource:this.wot,h=m.wtTable.holder,d=0;if(f&&h.offsetHeight!==h.clientHeight&&(d=E()),f){var g=this.wot.getSetting("fixedRowsBottom"),c=(this.wot.getSetting("fixedRowsTop"),this.wot.getSetting("totalRows"));p+=this.sumCellSizes(0,l+1),p-=this.wot.wtViewport.getViewportHeight()-this.sumCellSizes(c-g,c),p+=1}else{p+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),l)}p+=d,this.setScrollPosition(p)},getTableParentOffset:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0},getScrollPosition:function(){return M(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(f){if(0===this.wot.getSetting("fixedRowsTop")&&this.wot.getSetting("columnHeaders").length>0){var c=this.wot.wtTable.holder.parentNode,h=L(c,"innerBorderTop");f||0===this.wot.getSetting("totalRows")?y(c,"innerBorderTop"):I(c,"innerBorderTop"),(!h&&f||h&&!f)&&this.wot.wtOverlays.adjustElementsSize()}if(0===this.wot.getSetting("rowHeaders").length){var g=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(g){for(var d=0;d<g.length;d++){g[d].style["border-left-width"]=0}}}}},{},D),window.WalkontableTopOverlay=j,D.registerOverlay(D.CLONE_TOP,j)},{_base:11,"helpers/dom/element":46}],15:[function(q,z,j){Object.defineProperties(j,{WalkontableTopLeftCornerOverlay:{get:function(){return p}},__esModule:{value:!0}});var g,f,m=(g=q("helpers/dom/element"),g&&g.__esModule&&g||{"default":g}),A=m.outerHeight,k=m.outerWidth,x=m.setOverlayPosition,y=m.resetCssTransform,w=(f=q("_base"),f&&f.__esModule&&f||{"default":f}).WalkontableOverlay,p=function(c){$traceurRuntime.superConstructor(v).call(this,c),this.clone=this.makeClone(w.CLONE_TOP_LEFT_CORNER)},v=p;$traceurRuntime.createClass(p,{shouldBeRendered:function(){return !(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length||!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)},resetFixedPosition:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var F=this.clone.wtTable.holder.parentNode,I=A(this.clone.wtTable.TABLE),B=k(this.clone.wtTable.TABLE),u=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===window){var l=this.wot.wtTable.hider.getBoundingClientRect(),C=Math.ceil(l.top),H=Math.ceil(l.left),D=Math.ceil(l.bottom),G=Math.ceil(l.right),E="0",s="0";u&&"vertical"!==u||0>H&&G-F.offsetWidth>0&&(E=-H+"px"),u&&"horizontal"!==u||0>C&&D-F.offsetHeight>0&&(s=-C+"px"),x(F,E,s)}else{y(F)}F.style.height=(0===I?I:I+4)+"px",F.style.width=(0===B?B:B+4)+"px"}}},{},w),window.WalkontableTopLeftCornerOverlay=p,w.registerOverlay(w.CLONE_TOP_LEFT_CORNER,p)},{_base:11,"helpers/dom/element":46}],16:[function(H,q,A){Object.defineProperties(A,{WalkontableOverlays:{get:function(){return j}},__esModule:{value:!0}});var z,x,D,v,C,K=(z=H("helpers/dom/element"),z&&z.__esModule&&z||{"default":z}),k=K.getScrollableElement,J=K.getScrollbarWidth,E=K.getScrollLeft,I=K.getScrollTop,G=(x=H("helpers/array"),x&&x.__esModule&&x||{"default":x}).arrayEach,y=(D=H("helpers/unicode"),D&&D.__esModule&&D||{"default":D}).isKey,F=(v=H("helpers/browser"),v&&v.__esModule&&v||{"default":v}).isMobileBrowser,B=(C=H("eventManager"),C&&C.__esModule&&C||{"default":C}).EventManager,j=function(c){this.wot=c,this.instance=this.wot,this.eventManager=new B(this.wot),this.wot.update("scrollbarWidth",J()),this.wot.update("scrollbarHeight",J()),this.scrollableElement=k(this.wot.wtTable.TABLE),this.topOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_TOP,this.wot),"undefined"==typeof WalkontableBottomOverlay?this.bottomOverlay={needFullRender:!1}:this.bottomOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_BOTTOM,this.wot),this.leftOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_LEFT,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_TOP_LEFT_CORNER,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&"undefined"!=typeof WalkontableBottomLeftCornerOverlay?this.bottomLeftCornerOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER,this.wot):this.bottomLeftCornerOverlay={needFullRender:!1},this.wot.getSetting("debug")&&(this.debug=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_DEBUG,this.wot)),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},bottom:{top:null,left:0},left:{top:0,left:null}},this.pendingScrollCallbacks={master:{top:0,left:0},top:{left:0},bottom:{left:0},left:{top:0}},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.delegatedScrollCallback=!1,this.registeredListeners=[],this.registerListeners()};$traceurRuntime.createClass(j,{refreshAll:function(){if(this.wot.drawn){if(!this.wot.wtTable.holder.parentNode){return void this.destroy()}this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}},registerListeners:function(){var f=this,c=this.topOverlay.mainTableScrollableElement,h=this.leftOverlay.mainTableScrollableElement,g=[];for(g.push([document.documentElement,"keydown",function(e){return f.onKeyDown(e)}]),g.push([document.documentElement,"keyup",function(){return f.onKeyUp()}]),g.push([document,"visibilitychange",function(){return f.onKeyUp()}]),g.push([c,"scroll",function(e){return f.onTableScroll(e)}]),c!==h&&g.push([h,"scroll",function(e){return f.onTableScroll(e)}]),this.topOverlay.needFullRender&&(g.push([this.topOverlay.clone.wtTable.holder,"scroll",function(e){return f.onTableScroll(e)}]),g.push([this.topOverlay.clone.wtTable.holder,"wheel",function(e){return f.onTableScroll(e)}])),this.bottomOverlay.needFullRender&&(g.push([this.bottomOverlay.clone.wtTable.holder,"scroll",function(e){return f.onTableScroll(e)}]),g.push([this.bottomOverlay.clone.wtTable.holder,"wheel",function(e){return f.onTableScroll(e)}])),this.leftOverlay.needFullRender&&(g.push([this.leftOverlay.clone.wtTable.holder,"scroll",function(e){return f.onTableScroll(e)}]),g.push([this.leftOverlay.clone.wtTable.holder,"wheel",function(e){return f.onTableScroll(e)}])),this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window&&g.push([window,"wheel",function(e){var m,l=e.wheelDeltaY||e.deltaY,i=e.wheelDeltaX||e.deltaX;f.topOverlay.clone.wtTable.holder.contains(e.realTarget)?m="top":f.bottomOverlay.clone&&f.bottomOverlay.clone.wtTable.holder.contains(e.realTarget)?m="bottom":f.leftOverlay.clone.wtTable.holder.contains(e.realTarget)&&(m="left"),"top"==m&&0!==l?e.preventDefault():"left"==m&&0!==i?e.preventDefault():"bottom"==m&&0!==l&&e.preventDefault()}]);g.length;){var d=g.pop();this.eventManager.addEventListener(d[0],d[1],d[2]),this.registeredListeners.push(d)}},deregisterListeners:function(){for(;this.registeredListeners.length;){var c=this.registeredListeners.pop();this.eventManager.removeEventListener(c[0],c[1],c[2])}},onTableScroll:function(d){if(!F()){var c=this.leftOverlay.mainTableScrollableElement,g=this.topOverlay.mainTableScrollableElement,f=d.target;this.keyPressed&&(g!==window&&f!==window&&!d.target.contains(g)||c!==window&&f!==window&&!d.target.contains(c))||("scroll"===d.type?this.syncScrollPositions(d):this.translateMouseWheelToScroll(d))}},onKeyDown:function(c){this.keyPressed=y(c.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")},onKeyUp:function(){this.keyPressed=!1},translateMouseWheelToScroll:function(m){var u,f=this.topOverlay.clone.wtTable.holder,d=this.bottomOverlay.clone?this.bottomOverlay.clone.wtTable.holder:null,c=this.leftOverlay.clone.wtTable.holder,h={type:"wheel"},w=m.target,g=m.wheelDeltaY||-1*m.deltaY,p=m.wheelDeltaX||-1*m.deltaX;for(1===m.deltaMode&&(g=120*g,p=120*p);w!=document&&null!=w;){if(w.className.indexOf("wtHolder")>-1){u=w;break}w=w.parentNode}return h.target=u,u==f?this.syncScrollPositions(h,-0.2*g):u==d?this.syncScrollPositions(h,-0.2*g):u==c&&this.syncScrollPositions(h,-0.2*p),!1},syncScrollPositions:function(L){var P=void 0!==arguments[1]?arguments[1]:null;if(!this.destroyed){if(0===arguments.length){return void this.syncScrollWithMaster()}var h,g,d,p=this.leftOverlay.mainTableScrollableElement,Q=this.topOverlay.mainTableScrollableElement,m=L.target,N=0,O=!1,M=!1,w=this.wot.getSetting("preventOverflow");this.topOverlay.needFullRender&&(h=this.topOverlay.clone.wtTable.holder),this.bottomOverlay.needFullRender&&(d=this.bottomOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&(g=this.leftOverlay.clone.wtTable.holder),m===document&&(m=window),m===p||m===Q?(N=E(w?this.scrollableElement:m),this.horizontalScrolling=!0,this.overlayScrollPositions.master.left=N,O=!0,this.pendingScrollCallbacks.master.left>0?this.pendingScrollCallbacks.master.left--:(h&&h.scrollLeft!==N&&(null==P&&this.pendingScrollCallbacks.top.left++,h.scrollLeft=N,M=p!==window),d&&d.scrollLeft!==N&&(null==P&&this.pendingScrollCallbacks.bottom.left++,d.scrollLeft=N,M=p!==window)),N=I(m),this.verticalScrolling=!0,this.overlayScrollPositions.master.top=N,O=!0,this.pendingScrollCallbacks.master.top>0?this.pendingScrollCallbacks.master.top--:g&&g.scrollTop!==N&&(null==P&&this.pendingScrollCallbacks.left.top++,g.scrollTop=N,M=Q!==window)):m===d?(N=E(m),this.horizontalScrolling=!0,this.overlayScrollPositions.bottom.left=N,O=!0,this.pendingScrollCallbacks.bottom.left>0?this.pendingScrollCallbacks.bottom.left--:(null==P&&this.pendingScrollCallbacks.master.left++,p.scrollLeft=N,h&&h.scrollLeft!==N&&(null==P&&this.pendingScrollCallbacks.top.left++,h.scrollLeft=N,M=Q!==window)),null!==P&&(O=!0,Q.scrollTop+=P)):m===h?(N=E(m),this.horizontalScrolling=!0,this.overlayScrollPositions.top.left=N,O=!0,this.pendingScrollCallbacks.top.left>0?this.pendingScrollCallbacks.top.left--:(null==P&&this.pendingScrollCallbacks.master.left++,p.scrollLeft=N),null!==P&&(O=!0,Q.scrollTop+=P),d&&d.scrollLeft!==N&&(null==P&&this.pendingScrollCallbacks.bottom.left++,d.scrollLeft=N,M=Q!==window)):m===g&&(N=I(m),this.overlayScrollPositions.left.top!==N&&(this.verticalScrolling=!0,this.overlayScrollPositions.left.top=N,O=!0,this.pendingScrollCallbacks.left.top>0?this.pendingScrollCallbacks.left.top--:(null==P&&this.pendingScrollCallbacks.master.top++,Q.scrollTop=N)),null!==P&&(O=!0,Q.scrollLeft+=P)),!this.keyPressed&&O&&"scroll"===L.type&&(this.delegatedScrollCallback?this.delegatedScrollCallback=!1:this.refreshAll(),M&&(this.delegatedScrollCallback=!0))}},syncScrollWithMaster:function(){var c=this.topOverlay.mainTableScrollableElement;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=c.scrollLeft),this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=c.scrollTop)},updateMainScrollableElements:function(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement(),this.scrollableElement=k(this.wot.wtTable.TABLE),this.registerListeners()},destroy:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.debug&&this.debug.destroy(),this.destroyed=!0},refresh:function(){var d=void 0!==arguments[0]?arguments[0]:!1;if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var c=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,g=c.clientWidth,f=c.clientHeight;g===this.spreaderLastSize.width&&f===this.spreaderLastSize.height||(this.spreaderLastSize.width=g,this.spreaderLastSize.height=f,this.adjustElementsSize())}this.bottomOverlay.clone&&this.bottomOverlay.refresh(d),this.leftOverlay.refresh(d),this.topOverlay.refresh(d),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(d),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(d),this.debug&&this.debug.refresh(d)},adjustElementsSize:function(){var g=void 0!==arguments[0]?arguments[0]:!1,d=this.wot.getSetting("totalColumns"),l=this.wot.getSetting("totalRows"),h=this.wot.wtViewport.getRowHeaderWidth(),f=this.wot.wtViewport.getColumnHeaderHeight(),c=this.wot.wtTable.hider.style;c.width=h+this.leftOverlay.sumCellSizes(0,d)+"px",c.height=f+this.topOverlay.sumCellSizes(0,l)+1+"px",this.topOverlay.adjustElementsSize(g),this.leftOverlay.adjustElementsSize(g),this.bottomOverlay.clone&&this.bottomOverlay.adjustElementsSize(g)},applyToDOM:function(){this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted||this.adjustElementsSize(),this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.leftOverlay.applyToDOM()},getParentOverlay:function(d){if(!d){return null}var c=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],f=null;return G(c,function(e,g){e&&e.clone&&e.clone.wtTable.TABLE.contains(d)&&(f=e.clone)}),f}},{}),window.WalkontableOverlays=j},{eventManager:41,"helpers/array":42,"helpers/browser":43,"helpers/dom/element":46,"helpers/unicode":55}],17:[function(y,D,m){Object.defineProperties(m,{WalkontableScroll:{get:function(){return j}},__esModule:{value:!0}});var k,g,v=(k=y("helpers/dom/element"),k&&k.__esModule&&k||{"default":k}),E=v.innerHeight,q=v.innerWidth,B=v.getScrollLeft,C=v.getScrollTop,A=v.offset,w=(g=y("helpers/number"),g&&g.__esModule&&g||{"default":g}),z=w.rangeEach,x=w.rangeEachReverse,j=function(c){this.wot=c,this.instance=c};$traceurRuntime.createClass(j,{scrollViewport:function(u){if(this.wot.drawn){var G=this._getVariables(),f=G.topOverlay,d=G.leftOverlay,c=G.totalRows,p=G.totalColumns,H=G.fixedRowsTop,h=G.fixedRowsBottom,F=G.fixedColumnsLeft;if(u.row<0||u.row>c-1){throw new Error("row "+u.row+" does not exist")}if(u.col<0||u.col>p-1){throw new Error("column "+u.col+" does not exist")}u.row>=H&&u.row<this.getFirstVisibleRow()?f.scrollTo(u.row):u.row>this.getLastVisibleRow()&&u.row<c-h&&f.scrollTo(u.row,!0),u.col>=F&&u.col<this.getFirstVisibleColumn()?d.scrollTo(u.col):u.col>this.getLastVisibleColumn()&&d.scrollTo(u.col,!0)}},getFirstVisibleRow:function(){var J=this._getVariables(),M=J.topOverlay,u=J.wtTable,s=J.wtViewport,c=J.totalRows,G=J.fixedRowsTop,F=u.getFirstVisibleRow();if(M.mainTableScrollableElement===window){var L=A(u.wtRootElement),H=E(u.hider),K=E(window),f=C(window);if(L.top+H-K<=f){var I=s.getColumnHeaderHeight();I+=M.sumCellSizes(0,G),x(c,1,function(d){return I+=M.sumCellSizes(d-1,d),L.top+H-I<=f?(F=d,!1):void 0})}}return F},getLastVisibleRow:function(){var H=this._getVariables(),J=H.topOverlay,p=H.wtTable,d=H.wtViewport,c=H.totalRows,u=p.getLastVisibleRow();if(J.mainTableScrollableElement===window){var s=A(p.wtRootElement),I=E(window),F=C(window);if(s.top>F){var G=d.getColumnHeaderHeight();z(1,c,function(f){return G+=J.sumCellSizes(f-1,f),s.top+G-F>=I?(u=f-2,!1):void 0})}}return u},getFirstVisibleColumn:function(){var I=this._getVariables(),L=I.leftOverlay,F=I.wtTable,l=I.wtViewport,c=I.totalColumns,G=(I.fixedColumnsLeft,F.getFirstVisibleColumn());if(L.mainTableScrollableElement===window){var M=A(F.wtRootElement),K=q(F.hider),H=q(window),J=B(window);if(M.left+K-H<=J){var f=l.getRowHeaderWidth();x(c,1,function(d){return f+=L.sumCellSizes(d-1,d),M.left+K-f<=J?(G=d,!1):void 0})}}return G},getLastVisibleColumn:function(){var H=this._getVariables(),J=H.leftOverlay,l=H.wtTable,d=H.wtViewport,c=H.totalColumns,p=l.getLastVisibleColumn();if(J.mainTableScrollableElement===window){var K=A(l.wtRootElement),I=q(window),F=B(window);if(K.left>F){var G=d.getRowHeaderWidth();z(1,c,function(f){return G+=J.sumCellSizes(f-1,f),K.left+G-F>=I?(p=f-2,!1):void 0})}}return p},_getVariables:function(){var F=this.wot,I=F.wtOverlays.topOverlay,f=F.wtOverlays.leftOverlay,d=F.wtTable,c=F.wtViewport,p=F.getSetting("totalRows"),J=F.getSetting("totalColumns"),h=F.getSetting("fixedRowsTop"),G=F.getSetting("fixedRowsBottom"),H=F.getSetting("fixedColumnsLeft");return{topOverlay:I,leftOverlay:f,wtTable:d,wtViewport:c,totalRows:p,totalColumns:J,fixedRowsTop:h,fixedRowsBottom:G,fixedColumnsLeft:H}}},{}),window.WalkontableScroll=j},{"helpers/dom/element":46,"helpers/number":51}],18:[function(p,x,g){Object.defineProperties(g,{WalkontableSelection:{get:function(){return m}},__esModule:{value:!0}});var f,d,k,y,j=(f=p("helpers/dom/element"),f&&f.__esModule&&f||{"default":f}).addClass,v=(d=p("border"),d&&d.__esModule&&d||{"default":d}).WalkontableBorder,w=(k=p("cell/coords"),k&&k.__esModule&&k||{"default":k}).WalkontableCellCoords,q=(y=p("cell/range"),y&&y.__esModule&&y||{"default":y}).WalkontableCellRange,m=function(h,c){this.settings=h,this.cellRange=c||null,this.instanceBorders={}};$traceurRuntime.createClass(m,{getBorder:function(c){return this.instanceBorders[c.guid]?this.instanceBorders[c.guid]:void (this.instanceBorders[c.guid]=new v(c,this.settings))},isEmpty:function(){return null===this.cellRange},add:function(c){this.isEmpty()?this.cellRange=new q(c,c,c):this.cellRange.expand(c)},replace:function(h,c){if(!this.isEmpty()){if(this.cellRange.from.isEqual(h)){return this.cellRange.from=c,!0}if(this.cellRange.to.isEqual(h)){return this.cellRange.to=c,!0}}return !1},clear:function(){this.cellRange=null},getCorners:function(){var h=this.cellRange.getTopLeftCorner(),c=this.cellRange.getBottomRightCorner();return[h.row,h.col,c.row,c.col]},addClassAtCoords:function(i,c,s,l){var h=i.wtTable.getCell(new w(c,s));"object"==typeof h&&j(h,l)},draw:function(D){if(this.isEmpty()){if(this.settings.border){var I=this.getBorder(D);I&&I.disappear()}}else{for(var A,z,l,B=D.wtTable.getRenderedRowsCount(),J=D.wtTable.getRenderedColumnsCount(),G=this.getCorners(),H=0;J>H;H++){z=D.wtTable.columnFilter.renderedToSource(H),z>=G[1]&&z<=G[3]&&(l=D.wtTable.getColumnHeader(z),l&&this.settings.highlightColumnClassName&&j(l,this.settings.highlightColumnClassName))}for(var F=0;B>F;F++){A=D.wtTable.rowFilter.renderedToSource(F),A>=G[0]&&A<=G[2]&&(l=D.wtTable.getRowHeader(A),l&&this.settings.highlightRowClassName&&j(l,this.settings.highlightRowClassName));for(var C=0;J>C;C++){z=D.wtTable.columnFilter.renderedToSource(C),A>=G[0]&&A<=G[2]&&z>=G[1]&&z<=G[3]?this.settings.className&&this.addClassAtCoords(D,A,z,this.settings.className):A>=G[0]&&A<=G[2]?this.settings.highlightRowClassName&&this.addClassAtCoords(D,A,z,this.settings.highlightRowClassName):z>=G[1]&&z<=G[3]&&this.settings.highlightColumnClassName&&this.addClassAtCoords(D,A,z,this.settings.highlightColumnClassName)}}if(D.getSetting("onBeforeDrawBorders",G,this.settings.className),this.settings.border){var E=this.getBorder(D);E&&E.appear(G)}}}},{}),window.WalkontableSelection=m},{border:2,"cell/coords":5,"cell/range":6,"helpers/dom/element":46}],19:[function(g,d,j){Object.defineProperties(j,{WalkontableSettings:{get:function(){return c}},__esModule:{value:!0}});var h,f=(h=g("helpers/dom/element"),h&&h.__esModule&&h||{"default":h}).fastInnerText,c=function(k,i){var m=this;this.wot=k,this.instance=k,this.defaults={table:void 0,debug:!1,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return !1},data:void 0,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(q,p,r){var n=m.getSetting("data",q,p);f(r,void 0===n||null===n?"":n)},columnWidth:function(n){},rowHeight:function(n){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(n){return n},scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null},this.settings={};for(var l in this.defaults){if(this.defaults.hasOwnProperty(l)){if(void 0!==i[l]){this.settings[l]=i[l]}else{if(void 0===this.defaults[l]){throw new Error('A required setting "'+l+'" was not provided')}this.settings[l]=this.defaults[l]}}}};$traceurRuntime.createClass(c,{update:function(k,i){if(void 0===i){for(var l in k){k.hasOwnProperty(l)&&(this.settings[l]=k[l])}}else{this.settings[k]=i}return this.wot},getSetting:function(l,i,p,m,k){return"function"==typeof this.settings[l]?this.settings[l](i,p,m,k):void 0!==i&&Array.isArray(this.settings[l])?this.settings[l][i]:this.settings[l]},has:function(i){return !!this.settings[i]}},{}),window.WalkontableSettings=c},{"helpers/dom/element":46}],20:[function(O,A,H){Object.defineProperties(H,{WalkontableTable:{get:function(){return j}},__esModule:{value:!0}});var G,E,K,B,J,T,z=(G=O("helpers/dom/element"),G&&G.__esModule&&G||{"default":G}),Q=z.getStyle,L=z.getTrimmingContainer,P=z.hasClass,N=z.index,F=z.offset,M=z.removeClass,I=z.removeTextNodes,q=z.overlayContainsElement,x=z.closest,k=(E=O("cell/coords"),E&&E.__esModule&&E||{"default":E}).WalkontableCellCoords,S=((K=O("cell/range"),K&&K.__esModule&&K||{"default":K}).WalkontableCellRange,(B=O("filter/column"),B&&B.__esModule&&B||{"default":B}).WalkontableColumnFilter),D=(J=O("filter/row"),J&&J.__esModule&&J||{"default":J}).WalkontableRowFilter,U=(T=O("tableRenderer"),T&&T.__esModule&&T||{"default":T}).WalkontableTableRenderer,j=function(d,c){this.wot=d,this.instance=this.wot,this.TABLE=c,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.tableOffset=0,this.holderOffset=0,I(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.rowFilter=null,this.columnFilter=null};$traceurRuntime.createClass(j,{fixTableDomTree:function(){this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=document.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=document.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=document.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(document.createElement("TR"))},createSpreader:function(d){var c,f=d.parentNode;return f&&1===f.nodeType&&P(f,"wtHolder")||(c=document.createElement("div"),c.className="wtSpreader",f&&f.insertBefore(c,d),c.appendChild(d)),c.style.position="relative",c},createHider:function(d){var c,f=d.parentNode;return f&&1===f.nodeType&&P(f,"wtHolder")||(c=document.createElement("div"),c.className="wtHider",f&&f.insertBefore(c,d),c.appendChild(d)),c},createHolder:function(d){var c,f=d.parentNode;return f&&1===f.nodeType&&P(f,"wtHolder")||(c=document.createElement("div"),c.style.position="relative",c.className="wtHolder",f&&f.insertBefore(c,d),this.isWorkingOnClone()||(c.parentNode.className+="ht_master handsontable"),c.appendChild(d)),c},alignOverlaysWithTrimmingContainer:function(){var d=L(this.wtRootElement);if(!this.isWorkingOnClone()){if(this.holder.parentNode.style.position="relative",d===window){var c=this.wot.getSetting("preventOverflow");c||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{this.holder.style.width=Q(d,"width"),this.holder.style.height=Q(d,"height"),this.holder.style.overflow=""}}},isWorkingOnClone:function(){return !!this.wot.cloneSource},draw:function(d){var c=this.instance.getSetting("totalRows");if(this.isWorkingOnClone()||(this.holderOffset=F(this.holder),d=this.wot.wtViewport.createRenderCalculators(d)),d){this.isWorkingOnClone()||this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays&&this.wot.wtOverlays.refresh(!0)}else{this.isWorkingOnClone()?this.tableOffset=this.wot.cloneSource.wtTable.tableOffset:this.tableOffset=F(this.TABLE);var g;g=WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_DEBUG)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP_LEFT_CORNER)?0:WalkontableOverlay.isOverlayTypeOf(this.instance.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM)||WalkontableOverlay.isOverlayTypeOf(this.instance.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)?Math.max(c-this.wot.getSetting("fixedRowsBottom"),0):this.wot.wtViewport.rowsRenderCalculator.startRow;var f;f=WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_DEBUG)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_LEFT)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP_LEFT_CORNER)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)?0:this.wot.wtViewport.columnsRenderCalculator.startColumn,this.rowFilter=new D(g,c,this.wot.getSetting("columnHeaders").length),this.columnFilter=new S(f,this.wot.getSetting("totalColumns"),this.wot.getSetting("rowHeaders").length),this.alignOverlaysWithTrimmingContainer(),this._doDraw()}return this.refreshSelections(d),this.isWorkingOnClone()||(this.wot.wtOverlays.topOverlay.resetFixedPosition(),this.wot.wtOverlays.bottomOverlay.clone&&this.wot.wtOverlays.bottomOverlay.resetFixedPosition(),this.wot.wtOverlays.leftOverlay.resetFixedPosition(),this.wot.wtOverlays.topLeftCornerOverlay&&this.wot.wtOverlays.topLeftCornerOverlay.resetFixedPosition(),this.instance.wtOverlays.bottomLeftCornerOverlay&&this.instance.wtOverlays.bottomLeftCornerOverlay.clone&&this.wot.wtOverlays.bottomLeftCornerOverlay.resetFixedPosition()),this.wot.drawn=!0,this},_doDraw:function(){var c=new U(this);c.render()},removeClassFromCells:function(d){for(var c=this.TABLE.querySelectorAll("."+d),g=0,f=c.length;f>g;g++){M(c[g],d)}},refreshSelections:function(d){if(this.wot.selections){var c=this.wot.selections.length;if(d){for(var g=0;c>g;g++){this.wot.selections[g].settings.className&&this.removeClassFromCells(this.wot.selections[g].settings.className),this.wot.selections[g].settings.highlightRowClassName&&this.removeClassFromCells(this.wot.selections[g].settings.highlightRowClassName),this.wot.selections[g].settings.highlightColumnClassName&&this.removeClassFromCells(this.wot.selections[g].settings.highlightColumnClassName)}}for(var f=0;c>f;f++){this.wot.selections[f].draw(this.wot,d)}}},getCell:function(d){if(this.isRowBeforeRenderedRows(d.row)){return -1}if(this.isRowAfterRenderedRows(d.row)){return -2}var c=this.TBODY.childNodes[this.rowFilter.sourceToRendered(d.row)];return c?c.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(d.col)]:void 0},getColumnHeader:function(d){var c=void 0!==arguments[1]?arguments[1]:0,f=this.THEAD.childNodes[c];return f?f.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(d)]:void 0},getRowHeader:function(d){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)){return null}var c=this.TBODY.childNodes[this.rowFilter.sourceToRendered(d)];return c?c.childNodes[0]:void 0},getCoords:function(f){"TD"!==f.nodeName&&"TH"!==f.nodeName&&(f=x(f,["TD","TH"]));var c=f.parentNode,h=c.parentNode,g=N(c),d=f.cellIndex;return q(WalkontableOverlay.CLONE_TOP_LEFT_CORNER,f)||q(WalkontableOverlay.CLONE_TOP,f)?"THEAD"===h.nodeName&&(g-=h.childNodes.length):g=h===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(g):this.rowFilter.renderedToSource(g),d=q(WalkontableOverlay.CLONE_TOP_LEFT_CORNER,f)||q(WalkontableOverlay.CLONE_LEFT,f)?this.columnFilter.offsettedTH(d):this.columnFilter.visibleRowHeadedColumnToSourceColumn(d),new k(g,d)},getTrForRow:function(c){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(c)]},getFirstRenderedRow:function(){return this.wot.wtViewport.rowsRenderCalculator.startRow},getFirstVisibleRow:function(){return this.wot.wtViewport.rowsVisibleCalculator.startRow},getFirstRenderedColumn:function(){return this.wot.wtViewport.columnsRenderCalculator.startColumn},getFirstVisibleColumn:function(){return this.wot.wtViewport.columnsVisibleCalculator.startColumn},getLastRenderedRow:function(){return this.wot.wtViewport.rowsRenderCalculator.endRow},getLastVisibleRow:function(){return this.wot.wtViewport.rowsVisibleCalculator.endRow},getLastRenderedColumn:function(){return this.wot.wtViewport.columnsRenderCalculator.endColumn},getLastVisibleColumn:function(){return this.wot.wtViewport.columnsVisibleCalculator.endColumn},isRowBeforeRenderedRows:function(c){return this.rowFilter.sourceToRendered(c)<0&&c>=0},isRowAfterViewport:function(c){return this.rowFilter.sourceToRendered(c)>this.getLastVisibleRow()},isRowAfterRenderedRows:function(c){return this.rowFilter.sourceToRendered(c)>this.getLastRenderedRow()},isColumnBeforeViewport:function(c){return this.columnFilter.sourceToRendered(c)<0&&c>=0},isColumnAfterViewport:function(c){return this.columnFilter.sourceToRendered(c)>this.getLastVisibleColumn()},isLastRowFullyVisible:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()},isLastColumnFullyVisible:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var d=this.wot.wtViewport.columnsRenderCalculator.count,c=this.wot.getSetting("totalColumns");if(this.wot.isOverlayName(WalkontableOverlay.CLONE_DEBUG)){d=c}else{if(this.wot.isOverlayName(WalkontableOverlay.CLONE_LEFT)||this.wot.isOverlayName(WalkontableOverlay.CLONE_TOP_LEFT_CORNER)||this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)){return Math.min(this.wot.getSetting("fixedColumnsLeft"),c)}}return d},getRenderedRowsCount:function(){var d=this.wot.wtViewport.rowsRenderCalculator.count,c=this.wot.getSetting("totalRows");return this.wot.isOverlayName(WalkontableOverlay.CLONE_DEBUG)?d=c:this.wot.isOverlayName(WalkontableOverlay.CLONE_TOP)||this.wot.isOverlayName(WalkontableOverlay.CLONE_TOP_LEFT_CORNER)?d=Math.min(this.wot.getSetting("fixedRowsTop"),c):(this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)||this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER))&&(d=Math.min(this.wot.getSetting("fixedRowsBottom"),c)),d},getVisibleRowsCount:function(){return this.wot.wtViewport.rowsVisibleCalculator.count},allRowsInViewport:function(){return this.wot.getSetting("totalRows")==this.getVisibleRowsCount()},getRowHeight:function(d){var c=this.wot.wtSettings.settings.rowHeight(d),f=this.wot.wtViewport.oversizedRows[d];return void 0!==f&&(c=void 0===c?f:Math.max(c,f)),c},getColumnHeaderHeight:function(d){var c=this.wot.wtSettings.settings.defaultRowHeight,f=this.wot.wtViewport.oversizedColumnHeaders[d];return void 0!==f&&(c=c?Math.max(c,f):f),c},getVisibleColumnsCount:function(){return this.wot.wtViewport.columnsVisibleCalculator.count},allColumnsInViewport:function(){return this.wot.getSetting("totalColumns")==this.getVisibleColumnsCount()},getColumnWidth:function(d){var c=this.wot.wtSettings.settings.columnWidth;return"function"==typeof c?c=c(d):"object"==typeof c&&(c=c[d]),c||this.wot.wtSettings.settings.defaultColumnWidth},getStretchedColumnWidth:function(f){var c=this.getColumnWidth(f),h=null==c?this.instance.wtSettings.settings.defaultColumnWidth:c,g=this.wot.wtViewport.columnsRenderCalculator;if(g){var d=g.getStretchedColumnWidth(f,h);d&&(h=d)}return h}},{}),window.WalkontableTable=j},{"cell/coords":5,"cell/range":6,"filter/column":9,"filter/row":10,"helpers/dom/element":46,tableRenderer:21}],21:[function(y,D,m){function k(d,c){var f=document.createElement("TH");return c.insertBefore(f,d),c.removeChild(d),f}function g(d,c){var f=document.createElement("TD");return c.insertBefore(f,d),c.removeChild(d),f}Object.defineProperties(m,{WalkontableTableRenderer:{get:function(){return j}},__esModule:{value:!0}});var v,E=(v=y("helpers/dom/element"),v&&v.__esModule&&v||{"default":v}),q=E.addClass,B=E.empty,C=E.getScrollbarWidth,A=E.hasClass,w=E.innerHeight,z=E.outerWidth,x=!1,j=function(c){this.wtTable=c,this.wot=c.instance,this.instance=c.instance,this.rowFilter=c.rowFilter,this.columnFilter=c.columnFilter,this.TABLE=c.TABLE,this.THEAD=c.THEAD,this.TBODY=c.TBODY,this.COLGROUP=c.COLGROUP,this.rowHeaders=[],this.rowHeaderCount=0,this.columnHeaders=[],this.columnHeaderCount=0,this.fixedRowsTop=0,this.fixedRowsBottom=0};$traceurRuntime.createClass(j,{render:function(){this.wtTable.isWorkingOnClone()||this.wot.getSetting("beforeDraw",!0),this.rowHeaders=this.wot.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.wot.getSetting("fixedRowsTop"),this.fixedRowsBottom=this.wot.getSetting("fixedRowsBottom"),this.columnHeaders=this.wot.getSetting("columnHeaders"),this.columnHeaderCount=this.columnHeaders.length;var N,R=this.wtTable.getRenderedColumnsCount(),H=this.wtTable.getRenderedRowsCount(),G=this.wot.getSetting("totalColumns"),d=this.wot.getSetting("totalRows"),J=!1;if((WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER))&&(this.columnHeaders=[],this.columnHeaderCount=0),G>0&&(this.adjustAvailableNodes(),J=!0,this.renderColumnHeaders(),this.renderRows(d,H,R),this.wtTable.isWorkingOnClone()||(N=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null),this.adjustColumnWidths(R),this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights()),J||this.adjustAvailableNodes(),this.removeRedundantRows(H),this.wtTable.isWorkingOnClone()&&!this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)||this.markOversizedRows(),this.wtTable.isWorkingOnClone()){this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)&&this.wot.cloneSource.wtOverlays.adjustElementsSize()}else{this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1);var S=z(this.wtTable.hider),I=z(this.wtTable.TABLE);if(0!==S&&I!==S&&this.adjustColumnWidths(R),this.wot.wtOverlays.applyToDOM(),N!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;var P=this.wtTable.getFirstRenderedColumn(),Q=this.wtTable.getLastRenderedColumn(),O=this.wot.getSetting("rowHeaderWidth");if(null!=O){for(var K=0;K<this.rowHeaderCount;K++){this.COLGROUP.childNodes[K].style.width=(isNaN(O)?O[K]:O)+"px"}}for(var M=P;Q>M;M++){var F=this.wtTable.getStretchedColumnWidth(M),L=this.columnFilter.sourceToRendered(M);this.COLGROUP.childNodes[L+this.rowHeaderCount].style.width=F+"px"}}this.wot.getSetting("onDraw",!0)}},removeRedundantRows:function(c){for(;this.wtTable.tbodyChildrenLength>c;){this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}},renderRows:function(u,G,f){for(var d,c,p=0,H=this.rowFilter.renderedToSource(p),h=this.wtTable.isWorkingOnClone();u>H&&H>=0&&(!x&&p>1000&&(x=!0,console.warn('Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.')),void 0===G||p!==G);){if(c=this.getOrCreateTrForRow(p,c),this.renderRowHeaders(H,c),this.adjustColumns(c,f+this.rowHeaderCount),d=this.renderCells(H,c,f),h&&!this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)||this.resetOversizedRow(H),c.firstChild){var F=this.wot.wtTable.getRowHeight(H);F?(F--,c.firstChild.style.height=F+"px"):c.firstChild.style.height=""}p++,H=this.rowFilter.renderedToSource(p)}},resetOversizedRow:function(c){this.wot.getSetting("externalRowCalculator")||this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[c]&&(this.wot.wtViewport.oversizedRows[c]=void 0)},markOversizedRows:function(){if(!this.wot.getSetting("externalRowCalculator")){var u,f,G,F,p,d=this.instance.wtTable.TBODY.childNodes.length,h=d*this.instance.wtSettings.settings.defaultRowHeight,c=w(this.instance.wtTable.TBODY)-1;this.instance.getSetting("totalRows");if(h!==c||this.instance.getSetting("fixedRowsBottom")){for(;d;){d--,G=this.instance.wtTable.rowFilter.renderedToSource(d),u=this.instance.wtTable.getRowHeight(G),F=this.instance.wtTable.getTrForRow(G),p=F.querySelector("th"),f=p?w(p):w(F)-1,(!u&&this.instance.wtSettings.settings.defaultRowHeight<f||f>u)&&(this.instance.wtViewport.oversizedRows[G]=++f)}}}},markOversizedColumnHeaders:function(){var d=this.wot.getOverlayName();if(this.columnHeaderCount&&!this.wot.wtViewport.hasOversizedColumnHeadersMarked[d]&&!this.wtTable.isWorkingOnClone()){for(var c=this.wtTable.getRenderedColumnsCount(),h=0;h<this.columnHeaderCount;h++){for(var f=-1*this.rowHeaderCount;c>f;f++){this.markIfOversizedColumnHeader(f)}}this.wot.wtViewport.hasOversizedColumnHeadersMarked[d]=!0}},adjustColumnHeaderHeights:function(){for(var f=this.wot.getSetting("columnHeaders"),c=this.wot.wtTable.THEAD.childNodes,i=this.wot.wtViewport.oversizedColumnHeaders,h=0,d=f.length;d>h;h++){if(i[h]){if(0===c[h].childNodes.length){return}c[h].childNodes[0].style.height=i[h]+"px"}}},markIfOversizedColumnHeader:function(u){for(var f,G,F,p=this.wot.wtTable.columnFilter.renderedToSource(u),d=this.columnHeaderCount,h=this.wot.wtSettings.settings.defaultRowHeight,c=this.wot.getSetting("columnHeaderHeight")||[];d;){d--,f=this.wot.wtTable.getColumnHeaderHeight(d),G=this.wot.wtTable.getColumnHeader(p,d),G&&(F=w(G),(!f&&F>h||F>f)&&(this.wot.wtViewport.oversizedColumnHeaders[d]=F),Array.isArray(c)?null!=c[d]&&(this.wot.wtViewport.oversizedColumnHeaders[d]=c[d]):isNaN(c)||(this.wot.wtViewport.oversizedColumnHeaders[d]=c),this.wot.wtViewport.oversizedColumnHeaders[d]<(c[d]||c)&&(this.wot.wtViewport.oversizedColumnHeaders[d]=c[d]||c))}},renderCells:function(h,d,p){for(var l,c,f=0;p>f;f++){c=this.columnFilter.renderedToSource(f),l=0===f?d.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(c)]:l.nextSibling,"TH"==l.nodeName&&(l=g(l,d)),A(l,"hide")||(l.className=""),l.removeAttribute("style"),this.wot.wtSettings.settings.cellRenderer(h,c,l)}return l},adjustColumnWidths:function(u){var f=0,G=this.wot.cloneSource?this.wot.cloneSource:this.wot,F=G.wtTable.holder;F.offsetHeight<F.scrollHeight&&(f=C()),this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-f);var p=this.wot.getSetting("rowHeaderWidth");if(null!=p){for(var d=0;d<this.rowHeaderCount;d++){this.COLGROUP.childNodes[d].style.width=(isNaN(p)?p[d]:p)+"px"}}for(var h=0;u>h;h++){var c=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(h));this.COLGROUP.childNodes[h+this.rowHeaderCount].style.width=c+"px"}},appendToTbody:function(c){this.TBODY.appendChild(c),this.wtTable.tbodyChildrenLength++},getOrCreateTrForRow:function(d,c){var f;return d>=this.wtTable.tbodyChildrenLength?(f=this.createRow(),this.appendToTbody(f)):f=0===d?this.TBODY.firstChild:c.nextSibling,f.className&&f.removeAttribute("class"),f},createRow:function(){for(var d=document.createElement("TR"),c=0;c<this.rowHeaderCount;c++){d.appendChild(document.createElement("TH"))}return d},renderRowHeader:function(d,c,f){f.className="",f.removeAttribute("style"),this.rowHeaders[c](d,f,c)},renderRowHeaders:function(f,c){for(var h=c.firstChild,d=0;d<this.rowHeaderCount;d++){h?"TD"==h.nodeName&&(h=k(h,c)):(h=document.createElement("TH"),c.appendChild(h)),this.renderRowHeader(f,d,h),h=h.nextSibling}},adjustAvailableNodes:function(){this.adjustColGroups(),this.adjustThead()},renderColumnHeaders:function(){this.wot.getOverlayName();if(this.columnHeaderCount){for(var f=this.wtTable.getRenderedColumnsCount(),c=0;c<this.columnHeaderCount;c++){for(var i=this.getTrForColumnHeaders(c),h=-1*this.rowHeaderCount;f>h;h++){var d=this.columnFilter.renderedToSource(h);this.renderColumnHeader(c,d,i.childNodes[h+this.rowHeaderCount])}}}},adjustColGroups:function(){for(var c=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<c+this.rowHeaderCount;){this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++}for(;this.wtTable.colgroupChildrenLength>c+this.rowHeaderCount;){this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--}this.rowHeaderCount&&q(this.COLGROUP.childNodes[0],"rowHeader")},adjustThead:function(){var h=this.wtTable.getRenderedColumnsCount(),d=this.THEAD.firstChild;if(this.columnHeaders.length){for(var p=0,l=this.columnHeaders.length;l>p;p++){for(d=this.THEAD.childNodes[p],d||(d=document.createElement("TR"),this.THEAD.appendChild(d)),this.theadChildrenLength=d.childNodes.length;this.theadChildrenLength<h+this.rowHeaderCount;){d.appendChild(document.createElement("TH")),this.theadChildrenLength++}for(;this.theadChildrenLength>h+this.rowHeaderCount;){d.removeChild(d.lastChild),this.theadChildrenLength--}}var f=this.THEAD.childNodes.length;if(f>this.columnHeaders.length){for(var c=this.columnHeaders.length;f>c;c++){this.THEAD.removeChild(this.THEAD.lastChild)}}}else{d&&B(d)}},getTrForColumnHeaders:function(c){return this.THEAD.childNodes[c]},renderColumnHeader:function(d,c,f){return f.className="",f.removeAttribute("style"),this.columnHeaders[d](c,f,d)},adjustColumns:function(d,c){for(var h=d.childNodes.length;c>h;){var f=document.createElement("TD");d.appendChild(f),h++}for(;h>c;){d.removeChild(d.lastChild),h--}},removeRedundantColumns:function(c){for(;this.wtTable.tbodyChildrenLength>c;){this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}}},{}),window.WalkontableTableRenderer=j},{"helpers/dom/element":46}],22:[function(J,x,C){Object.defineProperties(C,{WalkontableViewport:{get:function(){return k}},__esModule:{value:!0}});var B,z,F,y,E,M=(B=J("browser"),B&&B.__esModule&&B||{"default":B})["default"],q=(z=J("helpers/dom/element"),z&&z.__esModule&&z||{"default":z}),L=q.getScrollbarWidth,G=(q.getScrollTop,q.getStyle),K=q.offset,I=q.outerHeight,A=q.outerWidth,H=(F=J("eventManager"),F&&F.__esModule&&F||{"default":F}).EventManager,D=(y=J("calculator/viewportColumns"),y&&y.__esModule&&y||{"default":y}).WalkontableViewportColumnsCalculator,j=(E=J("calculator/viewportRows"),E&&E.__esModule&&E||{"default":E}).WalkontableViewportRowsCalculator,k=function(d){var c=this;this.wot=d,this.instance=this.wot,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new H(this.wot),this.eventManager.addEventListener(window,"resize",function(){c.clientHeight=c.getWorkspaceHeight()})};$traceurRuntime.createClass(k,{getWorkspaceHeight:function(){var d,c=this.instance.wtOverlays.topOverlay.trimmingContainer,f=0;return c===window?f=document.documentElement.clientHeight:(d=I(c),f=d>0&&c.clientHeight>0?c.clientHeight:1/0),f},getWorkspaceWidth:function(){var h,d,m=this.wot.getSetting("totalColumns"),l=this.instance.wtOverlays.leftOverlay.trimmingContainer,g=this.wot.getSetting("stretchH"),c=document.documentElement.offsetWidth,f=this.wot.getSetting("preventOverflow");return f?A(this.instance.wtTable.wtRootElement):(h=M.freezeOverlays?Math.min(c-this.getWorkspaceOffset().left,c):Math.min(this.getContainerFillWidth(),c-this.getWorkspaceOffset().left,c),l===window&&m>0&&this.sumColumnWidths(0,m-1)>h?document.documentElement.clientWidth:l!==window&&(d=G(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow"),"scroll"==d||"hidden"==d||"auto"==d)?Math.max(h,l.clientWidth):"none"!==g&&g?h:Math.max(h,A(this.instance.wtTable.TABLE)))},hasVerticalScroll:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()},hasHorizontalScroll:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()},sumColumnWidths:function(d,c){for(var f=0;c>d;){f+=this.wot.wtTable.getColumnWidth(d),d++}return f},getContainerFillWidth:function(){if(this.containerWidth){return this.containerWidth}var d,c,f=this.instance.wtTable.holder;return c=document.createElement("div"),c.style.width="100%",c.style.height="1px",f.appendChild(c),d=c.offsetWidth,this.containerWidth=d,f.removeChild(c),d},getWorkspaceOffset:function(){return K(this.wot.wtTable.TABLE)},getWorkspaceActualHeight:function(){return I(this.wot.wtTable.TABLE)},getWorkspaceActualWidth:function(){return A(this.wot.wtTable.TABLE)||A(this.wot.wtTable.TBODY)||A(this.wot.wtTable.THEAD)},getColumnHeaderHeight:function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=I(this.wot.wtTable.THEAD)),this.columnHeaderHeight},getViewportHeight:function(){var d,c=this.getWorkspaceHeight();return c===1/0?c:(d=this.getColumnHeaderHeight(),d>0&&(c-=d),c)},getRowHeaderWidth:function(){var h=this.instance.getSetting("rowHeaderWidth"),d=this.instance.getSetting("rowHeaders");if(h){this.rowHeaderWidth=0;for(var m=0,l=d.length;l>m;m++){this.rowHeaderWidth+=h[m]||h}}if(this.wot.cloneSource){return this.wot.cloneSource.wtViewport.getRowHeaderWidth()}if(isNaN(this.rowHeaderWidth)){if(d.length){var g=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var c=0,f=d.length;f>c;c++){g?(this.rowHeaderWidth+=A(g),g=g.nextSibling):this.rowHeaderWidth+=50}}else{this.rowHeaderWidth=0}}return this.rowHeaderWidth},getViewportWidth:function(){var d,c=this.getWorkspaceWidth();return c===1/0?c:(d=this.getRowHeaderWidth(),d>0?c-d:c)},createRowsCalculator:function(){var m,u,f,d,c,h,v,g=void 0!==arguments[0]?arguments[0]:!1,p=this;return this.rowHeaderWidth=NaN,m=this.wot.wtSettings.settings.renderAllRows?1/0:this.getViewportHeight(),u=this.wot.wtOverlays.topOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset(),0>u&&(u=0),f=this.wot.getSetting("fixedRowsTop"),c=this.wot.getSetting("fixedRowsBottom"),v=this.wot.getSetting("totalRows"),f&&(h=this.wot.wtOverlays.topOverlay.sumCellSizes(0,f),u+=h,m-=h),c&&this.wot.wtOverlays.bottomOverlay.clone&&(h=this.wot.wtOverlays.bottomOverlay.sumCellSizes(v-c,v),m-=h),d=this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight?0:L(),new j(m,u,this.wot.getSetting("totalRows"),function(i){return p.wot.wtTable.getRowHeight(i)},g?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,g,d)},createColumnsCalculator:function(){var g,d,l=void 0!==arguments[0]?arguments[0]:!1,h=this,f=this.getViewportWidth();if(this.columnHeaderHeight=NaN,g=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.leftOverlay.getTableParentOffset(),0>g&&(g=0),d=this.wot.getSetting("fixedColumnsLeft")){var c=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,d);g+=c,f-=c}return this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth&&(f-=L()),new D(f,g,this.wot.getSetting("totalColumns"),function(i){return h.wot.wtTable.getColumnWidth(i)},l?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,l,this.wot.getSetting("stretchH"),function(m,i){return h.wot.getSetting("onBeforeStretchingColumnWidth",m,i)})},createRenderCalculators:function(){var d=void 0!==arguments[0]?arguments[0]:!1;if(d){var c=this.createRowsCalculator(!0),f=this.createColumnsCalculator(!0);this.areAllProposedVisibleRowsAlreadyRendered(c)&&this.areAllProposedVisibleColumnsAlreadyRendered(f)||(d=!1)}return d||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,d},createVisibleCalculators:function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0),this.columnsVisibleCalculator=this.createColumnsCalculator(!0)},areAllProposedVisibleRowsAlreadyRendered:function(c){return this.rowsVisibleCalculator?c.startRow<this.rowsRenderCalculator.startRow||c.startRow===this.rowsRenderCalculator.startRow&&c.startRow>0?!1:!(c.endRow>this.rowsRenderCalculator.endRow||c.endRow===this.rowsRenderCalculator.endRow&&c.endRow<this.wot.getSetting("totalRows")-1):!1},areAllProposedVisibleColumnsAlreadyRendered:function(c){return this.columnsVisibleCalculator?c.startColumn<this.columnsRenderCalculator.startColumn||c.startColumn===this.columnsRenderCalculator.startColumn&&c.startColumn>0?!1:!(c.endColumn>this.columnsRenderCalculator.endColumn||c.endColumn===this.columnsRenderCalculator.endColumn&&c.endColumn<this.wot.getSetting("totalColumns")-1):!1}},{}),window.WalkontableViewport=k},{browser:23,"calculator/viewportColumns":3,"calculator/viewportRows":4,eventManager:41,"helpers/dom/element":46}],23:[function(aG,ar,ax){function aw(d,c){var f=new aw.Core(d,c||{});return f.init(),f}var au,aC,at,az,aK,aq,aI,aD,aH,aF,av,aE,ay,ao,ap,am,aJ,ai,aL,U,Q,ag;ar.exports=aw,aw.utils={},au=aG("shims/runtime"),au&&au.__esModule&&au||{"default":au},aC=aG("es6collections"),aC&&aC.__esModule&&aC||{"default":aC};var K=(at=aG("pluginHooks"),at&&at.__esModule&&at||{"default":at}).Hooks;aw.hooks||(aw.hooks=new K),aw.utils.Hooks=K,az=aG("core"),az&&az.__esModule&&az||{"default":az},aK=aG("renderers/_cellDecorator"),aK&&aK.__esModule&&aK||{"default":aK},aq=aG("cellTypes"),aq&&aq.__esModule&&aq||{"default":aq},aI=aG("plugins/jqueryHandsontable"),aI&&aI.__esModule&&aI||{"default":aI};var ab=(aD=aG("helpers/array"),aD&&aD.__esModule&&aD||{"default":aD}),Z=(aH=aG("helpers/browser"),aH&&aH.__esModule&&aH||{"default":aH}),aA=(aF=aG("helpers/data"),aF&&aF.__esModule&&aF||{"default":aF}),ae=(av=aG("helpers/date"),av&&av.__esModule&&av||{"default":av}),ah=(aE=aG("helpers/feature"),aE&&aE.__esModule&&aE||{"default":aE}),ak=(ay=aG("helpers/function"),ay&&ay.__esModule&&ay||{"default":ay}),an=(ao=aG("helpers/mixed"),ao&&ao.__esModule&&ao||{"default":ao}),X=(ap=aG("helpers/number"),ap&&ap.__esModule&&ap||{"default":ap}),aa=(am=aG("helpers/object"),am&&am.__esModule&&am||{"default":am}),ac=(aJ=aG("helpers/setting"),aJ&&aJ.__esModule&&aJ||{"default":aJ}),G=(ai=aG("helpers/string"),ai&&ai.__esModule&&ai||{"default":ai}),ad=(aL=aG("helpers/unicode"),aL&&aL.__esModule&&aL||{"default":aL}),aB=(U=aG("helpers/dom/element"),U&&U.__esModule&&U||{"default":U}),J=(Q=aG("helpers/dom/event"),Q&&Q.__esModule&&Q||{"default":Q}),af=[ab,Z,aA,ae,ah,ak,an,X,aa,ac,G,ad],aj=[aB,J];aw.buildDate="Mon Jun 06 2016 13:30:03 GMT+0200 (CEST)",aw.packageName="handsontable",aw.version="0.25.1";var al="@@baseVersion";/^@@/.test(al)||(aw.baseVersion=al),aw.plugins={};var q=(ag=aG("plugins"),ag&&ag.__esModule&&ag||{"default":ag}).registerPlugin;aw.plugins.registerPlugin=q,aw.helper={},aw.dom={},aw.Dom=aw.dom,ab.arrayEach(af,function(c){ab.arrayEach(Object.getOwnPropertyNames(c),function(d){"_"!==d.charAt(0)&&(aw.helper[d]=c[d])})}),ab.arrayEach(aj,function(c){ab.arrayEach(Object.getOwnPropertyNames(c),function(d){"_"!==d.charAt(0)&&(aw.dom[d]=c[d])})})},{cellTypes:24,core:25,es6collections:"es6collections","helpers/array":42,"helpers/browser":43,"helpers/data":44,"helpers/date":45,"helpers/dom/element":46,"helpers/dom/event":47,"helpers/feature":48,"helpers/function":49,"helpers/mixed":50,"helpers/number":51,"helpers/object":52,"helpers/setting":53,"helpers/string":54,"helpers/unicode":55,pluginHooks:58,plugins:59,"plugins/jqueryHandsontable":1,"renderers/_cellDecorator":93,"shims/runtime":100}],24:[function(ad,K,V){var U,P,Z,L,X,ah,I,af,aa,ae,ac,Q,ab,W,F,G,B,ag,N,ai,x,q,J,j,A=(U=ad("helpers/browser"),U&&U.__esModule&&U||{"default":U}).isMobileBrowser,z=(P=ad("editors"),P&&P.__esModule&&P||{"default":P}).getEditorConstructor,Y=(Z=ad("renderers"),Z&&Z.__esModule&&Z||{"default":Z}).getRenderer,D=((L=ad("editors/autocompleteEditor"),L&&L.__esModule&&L||{"default":L}).AutocompleteEditor,(X=ad("editors/checkboxEditor"),X&&X.__esModule&&X||{"default":X}).CheckboxEditor,(ah=ad("editors/dateEditor"),ah&&ah.__esModule&&ah||{"default":ah}).DateEditor,(I=ad("editors/dropdownEditor"),I&&I.__esModule&&I||{"default":I}).DropdownEditor,(af=ad("editors/handsontableEditor"),af&&af.__esModule&&af||{"default":af}).HandsontableEditor,(aa=ad("editors/mobileTextEditor"),aa&&aa.__esModule&&aa||{"default":aa}).MobileTextEditor,(ae=ad("editors/numericEditor"),ae&&ae.__esModule&&ae||{"default":ae}).NumericEditor,(ac=ad("editors/passwordEditor"),ac&&ac.__esModule&&ac||{"default":ac}).PasswordEditor,(Q=ad("editors/selectEditor"),Q&&Q.__esModule&&Q||{"default":Q}).SelectEditor,(ab=ad("editors/textEditor"),ab&&ab.__esModule&&ab||{"default":ab}).TextEditor,(W=ad("renderers/autocompleteRenderer"),W&&W.__esModule&&W||{"default":W}).AutocompleteRenderer,(F=ad("renderers/checkboxRenderer"),F&&F.__esModule&&F||{"default":F}).CheckboxRenderer,(G=ad("renderers/htmlRenderer"),G&&G.__esModule&&G||{"default":G}).HtmlRenderer,(B=ad("renderers/numericRenderer"),B&&B.__esModule&&B||{"default":B}).NumericRenderer,(ag=ad("renderers/passwordRenderer"),ag&&ag.__esModule&&ag||{"default":ag}).PasswordRenderer,(N=ad("renderers/textRenderer"),N&&N.__esModule&&N||{"default":N}).TextRenderer,(ai=ad("validators/autocompleteValidator"),ai&&ai.__esModule&&ai||{"default":ai}).AutocompleteValidator,(x=ad("validators/dateValidator"),x&&x.__esModule&&x||{"default":x}).DateValidator,(q=ad("validators/timeValidator"),q&&q.__esModule&&q||{"default":q}).TimeValidator,(J=ad("validators/numericValidator"),J&&J.__esModule&&J||{"default":J}).NumericValidator,(j=ad("browser"),j&&j.__esModule&&j||{"default":j})["default"]);D.AutocompleteCell={editor:z("autocomplete"),renderer:Y("autocomplete"),validator:D.AutocompleteValidator},D.CheckboxCell={editor:z("checkbox"),renderer:Y("checkbox")},D.TextCell={editor:z(A()?"mobile":"text"),renderer:Y("text")},D.NumericCell={editor:z("numeric"),renderer:Y("numeric"),validator:D.NumericValidator,dataType:"number"},D.DateCell={editor:z("date"),validator:D.DateValidator,renderer:Y("autocomplete")},D.TimeCell={editor:z("text"),validator:D.TimeValidator,renderer:Y("text")},D.HandsontableCell={editor:z("handsontable"),renderer:Y("autocomplete")},D.PasswordCell={editor:z("password"),renderer:Y("password"),copyable:!1},D.DropdownCell={editor:z("dropdown"),renderer:Y("autocomplete"),validator:D.AutocompleteValidator},D.cellTypes={text:D.TextCell,date:D.DateCell,time:D.TimeCell,numeric:D.NumericCell,checkbox:D.CheckboxCell,autocomplete:D.AutocompleteCell,handsontable:D.HandsontableCell,password:D.PasswordCell,dropdown:D.DropdownCell},D.cellLookup={validator:{numeric:D.NumericValidator,autocomplete:D.AutocompleteValidator}}},{browser:23,editors:29,"editors/autocompleteEditor":31,"editors/checkboxEditor":32,"editors/dateEditor":33,"editors/dropdownEditor":34,"editors/handsontableEditor":35,"editors/mobileTextEditor":36,"editors/numericEditor":37,"editors/passwordEditor":38,"editors/selectEditor":39,"editors/textEditor":40,"helpers/browser":43,renderers:92,"renderers/autocompleteRenderer":94,"renderers/checkboxRenderer":95,"renderers/htmlRenderer":96,"renderers/numericRenderer":97,"renderers/passwordRenderer":98,"renderers/textRenderer":99,"validators/autocompleteValidator":105,"validators/dateValidator":106,"validators/numericValidator":107,"validators/timeValidator":108}],25:[function(a0,aL,aR){var aQ,aN,aW,aM,aT,a5,aK,a2,aX,a1,aZ,aP,aY,aS,aI,aJ,aG,a3,aA,a6,ak,aj=(aQ=a0("browser"),aQ&&aQ.__esModule&&aQ||{"default":aQ})["default"],ay=(aN=a0("numeral"),aN&&aN.__esModule&&aN||{"default":aN})["default"],ai=(aW=a0("helpers/dom/element"),aW&&aW.__esModule&&aW||{"default":aW}),ap=ai.addClass,an=ai.empty,aU=ai.isChildOfWebComponentTable,av=ai.removeClass,az=(aM=a0("helpers/setting"),aM&&aM.__esModule&&aM||{"default":aM}).columnFactory,aC=(aT=a0("helpers/browser"),aT&&aT.__esModule&&aT||{"default":aT}).isMobileBrowser,aH=(a5=a0("dataMap"),a5&&a5.__esModule&&a5||{"default":a5}).DataMap,am=(aK=a0("editorManager"),aK&&aK.__esModule&&aK||{"default":aK}).EditorManager,ao=(a2=a0("eventManager"),a2&&a2.__esModule&&a2||{"default":a2}).eventManager,aq=(aX=a0("helpers/object"),aX&&aX.__esModule&&aX||{"default":aX}),af=aq.extend,au=aq.duckSchema,aV=aq.isObjectEquals,ag=aq.deepClone,ax=(a1=a0("helpers/array"),a1&&a1.__esModule&&a1||{"default":a1}),aB=ax.arrayFlatten,aF=ax.arrayMap,ac=(aZ=a0("plugins"),aZ&&aZ.__esModule&&aZ||{"default":aZ}).getPlugin,ah=(aP=a0("renderers"),aP&&aP.__esModule&&aP||{"default":aP}).getRenderer,aw=(aY=a0("helpers/string"),aY&&aY.__esModule&&aY||{"default":aY}).randomString,aD=(aS=a0("helpers/number"),aS&&aS.__esModule&&aS||{"default":aS}).rangeEach,ad=(aI=a0("tableView"),aI&&aI.__esModule&&aI||{"default":aI}).TableView,ar=(aJ=a0("dataSource"),aJ&&aJ.__esModule&&aJ||{"default":aJ}).DataSource,aO=(aG=a0("helpers/data"),aG&&aG.__esModule&&aG||{"default":aG}),ab=aO.translateRowsToColumns,at=aO.cellMethodLookupFactory,al=aO.spreadsheetColumnLabel,a4=(a3=a0("3rdparty/walkontable/src/cell/coords"),a3&&a3.__esModule&&a3||{"default":a3}).WalkontableCellCoords,ae=(aA=a0("3rdparty/walkontable/src/cell/range"),aA&&aA.__esModule&&aA||{"default":aA}).WalkontableCellRange,aa=((a6=a0("3rdparty/walkontable/src/selection"),a6&&a6.__esModule&&a6||{"default":a6}).WalkontableSelection,(ak=a0("3rdparty/walkontable/src/calculator/viewportColumns"),ak&&ak.__esModule&&ak||{"default":ak}).WalkontableViewportColumnsCalculator);aj.activeGuid=null,aj.Core=function(L,z){function E(){var c=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue++,c=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(d){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==c&&(c=!0,this.onQueueEmpty(this.valid))}}}function D(m,w,f){function d(){var c;m.length&&(c=aj.hooks.run(F,"beforeChange",m,w),"function"==typeof c?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):c===!1&&m.splice(0,m.length)),f()}var h=new E;h.onQueueEmpty=d;for(var y=m.length-1;y>=0;y--){if(null===m[y]){m.splice(y,1)}else{var g=m[y][0],p=I.propToCol(m[y][1]),v=F.getCellMeta(g,p);if("numeric"===v.type&&"string"==typeof m[y][3]&&m[y][3].length>0&&(/^-?[\d\s]*(\.|\,)?\d*$/.test(m[y][3])||v.format)){var n=m[y][3].length;"undefined"==typeof v.language?ay.language("en"):m[y][3].indexOf(".")===n-3&&-1===m[y][3].indexOf(",")?ay.language("en"):ay.language(v.language),ay.validate(m[y][3])&&(m[y][3]=ay().unformat(m[y][3]))}F.getCellValidator(v)&&(h.addValidatorToQueue(),F.validateCell(m[y][3],v,function(c,e){return function(i){if("boolean"!=typeof i){throw new Error("Validation error: result is not boolean")}i===!1&&e.allowInvalid===!1&&(m.splice(c,1),e.valid=!0,--c),h.removeValidatorFormQueue()}}(y,v),w))}}h.checkIfQueueIsEmpty()}function B(d,c){var f=d.length-1;if(!(0>f)){for(;f>=0;f--){if(null!==d[f]){if(null!=d[f][2]||null!=d[f][3]){if(N.settings.allowInsertRow){for(;d[f][0]>F.countRows()-1;){I.createRow()}}if("array"===F.dataType&&(!N.settings.columns||0===N.settings.columns.length)&&N.settings.allowInsertColumn){for(;I.propToCol(d[f][1])>F.countCols()-1;){I.createCol()}}I.set(d[f][0],d[f][1],d[f][3])}}else{d.splice(f,1)}}F.forceFullRender=!0,K.adjustRowsAndCols(),aj.hooks.run(F,"beforeChangeRender",d,c),C.refreshBorders(null,!0),F.view.wt.wtOverlays.adjustElementsSize(),aj.hooks.run(F,"afterChange",d,c||"edit")}}function H(d,c,f){return"object"==typeof d?d:[[d,c,f]]}function A(d){if(d.hasOwnProperty("type")){var c,g={};if("object"==typeof d.type){c=d.type}else{if("string"==typeof d.type&&(c=aj.cellTypes[d.type],void 0===c)){throw new Error('You declared cell type "'+d.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes')}}for(var f in c){c.hasOwnProperty(f)&&!d.hasOwnProperty(f)&&(g[f]=c[f])}return g}}function G(c){return aj.hooks.run(F,"modifyRow",c)}function O(c){return aj.hooks.run(F,"modifyCol",c)}function x(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed")}var N,I,M,K,C,J,F=this,k=function(){},q=ao(F);af(k.prototype,aE.prototype),af(k.prototype,z),af(k.prototype,A(z)),this.rootElement=L,this.isHotTableEnv=aU(this.rootElement),aj.eventManager.isHotTableEnv=this.isHotTableEnv,this.container=document.createElement("DIV"),this.renderCall=!1,L.insertBefore(this.container,L.firstChild),this.guid="ht_"+aw(),M=new ar(F),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid),N={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new k,selRange:null,isPopulated:null,scrollable:null,firstRun:!0},K={alter:function(R,Z,m,h,c){function P(s,g,v,u){var l=function(){var i;return"array"===u?i=[]:"object"===u&&(i={}),i},d=aF(new Array(v),function(){return l()});d.unshift(g,0),s.splice.apply(s,d)}var a7;switch(m=m||1,R){case"insert_row":if(F.getSettings().maxRows===F.countSourceRows()){return}a7=I.createRow(Z,m),P(N.cellSettings,Z,m,"array"),a7&&(C.isSelected()&&N.selRange.from.row>=Z?(N.selRange.from.row=N.selRange.from.row+a7,C.transformEnd(a7,0)):C.refreshBorders());break;case"insert_col":a7=I.createCol(Z,m);for(var p=0,Y=F.countSourceRows();Y>p;p++){N.cellSettings[p]&&P(N.cellSettings[p],Z,m)}if(a7){if(Array.isArray(F.getSettings().colHeaders)){var S=[Z,0];S.length+=a7,Array.prototype.splice.apply(F.getSettings().colHeaders,S)}C.isSelected()&&N.selRange.from.col>=Z?(N.selRange.from.col=N.selRange.from.col+a7,C.transformEnd(0,a7)):C.refreshBorders()}break;case"remove_row":I.removeRow(Z,m),N.cellSettings.splice(Z,m);var Q=F.countRows(),V=F.getSettings().fixedRowsTop;V>=Z+1&&(F.getSettings().fixedRowsTop-=Math.min(m,V-Z));var X=F.getSettings().fixedRowsBottom;X&&Z>=Q-X&&(F.getSettings().fixedRowsBottom-=Math.min(m,X)),K.adjustRowsAndCols(),C.refreshBorders();break;case"remove_col":var U=O(Z);I.removeCol(Z,m);for(var T=0,f=F.countSourceRows();f>T;T++){N.cellSettings[T]&&N.cellSettings[T].splice(U,m)}var W=F.getSettings().fixedColumnsLeft;W>=Z+1&&(F.getSettings().fixedColumnsLeft-=Math.min(m,W-Z)),Array.isArray(F.getSettings().colHeaders)&&("undefined"==typeof U&&(U=-1),F.getSettings().colHeaders.splice(U,m)),K.adjustRowsAndCols(),C.refreshBorders();break;default:throw new Error('There is no such action "'+R+'"')}c||K.adjustRowsAndCols()},adjustRowsAndCols:function(){if(N.settings.minRows){var w=F.countRows();if(w<N.settings.minRows){for(var R=0,h=N.settings.minRows;h-w>R;R++){I.createRow(F.countRows(),1,!0)}}}if(N.settings.minSpareRows){var g=F.countEmptyRows(!0);if(g<N.settings.minSpareRows){for(;g<N.settings.minSpareRows&&F.countRows()<N.settings.maxRows;g++){I.createRow(F.countRows(),1,!0)}}}var c;if((N.settings.minCols||N.settings.minSpareCols)&&(c=F.countEmptyCols(!0)),N.settings.minCols&&!N.settings.columns&&F.countCols()<N.settings.minCols){for(;F.countCols()<N.settings.minCols;c++){I.createCol(F.countCols(),1,!0)}}if(N.settings.minSpareCols&&!N.settings.columns&&"array"===F.dataType&&c<N.settings.minSpareCols){for(;c<N.settings.minSpareCols&&F.countCols()<N.settings.maxCols;c++){I.createCol(F.countCols(),1,!0)}}var p=F.countRows(),S=F.countCols();if(0!==p&&0!==S||C.deselect(),C.isSelected()){var m=!1,P=N.selRange.from.row,Q=N.selRange.from.col,y=N.selRange.to.row,v=N.selRange.to.col;P>p-1?(P=p-1,m=!0,y>P&&(y=P)):y>p-1&&(y=p-1,m=!0,P>y&&(P=y)),Q>S-1?(Q=S-1,m=!0,v>Q&&(v=Q)):v>S-1&&(v=S-1,m=!0,Q>v&&(Q=v)),m&&F.selectCell(P,Q,y,v)}F.view&&F.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(bs,bd,bl,bk,bh,bo,bf){var bm,bv,bb,bp,bt=[],br={};if(bv=bd.length,0===bv){return !1}var bj,bq,a9,ba;({row:null===bl?null:bl.row,col:null===bl?null:bl.col});switch(bh){case"shift_down":for(bj=bl?bl.col-bs.col+1:0,bq=bl?bl.row-bs.row+1:0,bd=ab(bd),bb=0,bp=bd.length,a9=Math.max(bp,bj);a9>bb;bb++){if(bp>bb){for(bm=0,bv=bd[bb].length;bq-bv>bm;bm++){bd[bb].push(bd[bb][bm%bv])}bd[bb].unshift(bs.col+bb,bs.row,0),F.spliceCol.apply(F,bd[bb])}else{bd[bb%bp][0]=bs.col+bb,F.spliceCol.apply(F,bd[bb%bp])}}break;case"shift_right":for(bj=bl?bl.col-bs.col+1:0,bq=bl?bl.row-bs.row+1:0,bm=0,bv=bd.length,ba=Math.max(bv,bq);ba>bm;bm++){if(bv>bm){for(bb=0,bp=bd[bm].length;bj-bp>bb;bb++){bd[bm].push(bd[bm][bb%bp])}bd[bm].unshift(bs.row+bm,bs.col,0),F.spliceRow.apply(F,bd[bm])}else{bd[bm%bv][0]=bs.row+bm,F.spliceRow.apply(F,bd[bm%bv])}}break;case"overwrite":default:br.row=bs.row,br.col=bs.col;var Z,bu={row:bl&&bs?bl.row-bs.row+1:1,col:bl&&bs?bl.col-bs.col+1:1},bg=0,bw=0,Q=!0,m=function(d){var g=void 0!==arguments[1]?arguments[1]:null,f=bd[d%bd.length];return null!==g?f[g%f.length]:f},bc=bd.length,c=bl?bl.row-bs.row+1:0;for(bv=bl?c:Math.max(bc,c),bm=0;bv>bm&&!(bl&&br.row>bl.row&&c>bc||!N.settings.allowInsertRow&&br.row>F.countRows()-1||br.row>=N.settings.maxRows);bm++){var X=bm-bg,V=m(X).length,bn=bl?bl.col-bs.col+1:0;if(bp=bl?bn:Math.max(V,bn),br.col=bs.col,Z=F.getCellMeta(br.row,br.col),"paste"!==bk&&"autofill"!==bk||!Z.skipRowOnPaste){for(bw=0,bb=0;bp>bb&&!(bl&&br.col>bl.col&&bn>V||!N.settings.allowInsertColumn&&br.col>F.countCols()-1||br.col>=N.settings.maxCols);bb++){if(Z=F.getCellMeta(br.row,br.col),"paste"!==bk&&"autofill"!==bk||!Z.skipColumnOnPaste){if(Z.readOnly){br.col++}else{var a8=bb-bw,be=m(X,a8),bi=F.getDataAtCell(br.row,br.col),a7={row:X,col:a8};if("autofill"===bk){var U=F.runHooks("beforeAutofillInsidePopulate",a7,bo,bd,bf,{},bu);U&&(be="undefined"==typeof U.value?be:U.value)}if(null!==be&&"object"==typeof be){if(null===bi||"object"!=typeof bi){Q=!1}else{var W=au(bi[0]||bi),Y=au(be[0]||be);aV(W,Y)?be=ag(be):Q=!1}}else{null!==bi&&"object"==typeof bi&&(Q=!1)}Q&&bt.push([br.row,br.col,be]),Q=!0,br.col++}}else{bw++,br.col++,bp++}}br.row++}else{bg++,br.row++,bv++}}F.setDataAtCell(bt,null,null,bk||"populateFromArray")}}},this.selection=C={inProgress:!1,selectedHeader:{cols:!1,rows:!1},setSelectedHeaders:function(d,c){F.selection.selectedHeader.rows=d,F.selection.selectedHeader.cols=c},begin:function(){F.selection.inProgress=!0},finish:function(){var c=F.getSelected();aj.hooks.run(F,"afterSelectionEnd",c[0],c[1],c[2],c[3]),aj.hooks.run(F,"afterSelectionEndByProp",c[0],F.colToProp(c[1]),c[2],F.colToProp(c[3])),F.selection.inProgress=!1},isInProgress:function(){return F.selection.inProgress},setRangeStart:function(d,c){aj.hooks.run(F,"beforeSetRangeStart",d),N.selRange=new ae(d,d,d),C.setRangeEnd(d,null,c)},setRangeStartOnly:function(c){aj.hooks.run(F,"beforeSetRangeStartOnly",c),N.selRange=new ae(c,c,c)},setRangeEnd:function(m,u,f){if(null!==N.selRange){var d,c=!1,h=!0,v=F.view.wt.wtTable.getFirstVisibleRow(),g=F.view.wt.wtTable.getFirstVisibleColumn(),p={row:null,col:null};aj.hooks.run(F,"beforeSetRangeEnd",m),F.selection.begin(),p.row=m.row<0?v:m.row,p.col=m.col<0?g:m.col,N.selRange.to=new a4(p.row,p.col),N.settings.multiSelect||(N.selRange.from=m),F.view.wt.selections.current.clear(),d=F.getCellMeta(N.selRange.highlight.row,N.selRange.highlight.col).disableVisualSelection,"string"==typeof d&&(d=[d]),(d===!1||Array.isArray(d)&&-1===d.indexOf("current"))&&F.view.wt.selections.current.add(N.selRange.highlight),F.view.wt.selections.area.clear(),(d===!1||Array.isArray(d)&&-1===d.indexOf("area"))&&C.isMultiple()&&(F.view.wt.selections.area.add(N.selRange.from),F.view.wt.selections.area.add(N.selRange.to)),(N.settings.currentRowClassName||N.settings.currentColClassName)&&(F.view.wt.selections.highlight.clear(),F.view.wt.selections.highlight.add(N.selRange.from),F.view.wt.selections.highlight.add(N.selRange.to)),aj.hooks.run(F,"afterSelection",N.selRange.from.row,N.selRange.from.col,N.selRange.to.row,N.selRange.to.col),aj.hooks.run(F,"afterSelectionByProp",N.selRange.from.row,I.colToProp(N.selRange.from.col),N.selRange.to.row,I.colToProp(N.selRange.to.col)),(0===N.selRange.from.row&&N.selRange.to.row===F.countRows()-1&&F.countRows()>1||0===N.selRange.from.col&&N.selRange.to.col===F.countCols()-1&&F.countCols()>1)&&(c=!0),(m.row<0||m.col<0)&&(h=!1),u!==!1&&!c&&h&&(N.selRange.from&&!C.isMultiple()?F.view.scrollViewport(N.selRange.from):F.view.scrollViewport(m)),C.refreshBorders(null,f)}},refreshBorders:function(d,c){c||J.destroyEditor(d),F.view.render(),C.isSelected()&&!c&&J.prepareEditor()},isMultiple:function(){var d=!(N.selRange.to.col===N.selRange.from.col&&N.selRange.to.row===N.selRange.from.row),c=aj.hooks.run(F,"afterIsMultipleSelection",d);return d?c:void 0},transformStart:function(v,P,f,d){var c,m,Q,g,w=new a4(v,P),y=0,p=0;F.runHooks("modifyTransformStart",w),c=F.countRows(),m=F.countCols(),g=F.getSettings().fixedRowsBottom,N.selRange.highlight.row+v>c-1?f&&N.settings.minSpareRows>0&&!(g&&N.selRange.highlight.row>=c-g-1)?(F.alter("insert_row",c),c=F.countRows()):N.settings.autoWrapCol&&(w.row=1-c,w.col=N.selRange.highlight.col+w.col==m-1?1-m:1):N.settings.autoWrapCol&&N.selRange.highlight.row+w.row<0&&N.selRange.highlight.col+w.col>=0&&(w.row=c-1,w.col=N.selRange.highlight.col+w.col==0?m-1:-1),N.selRange.highlight.col+w.col>m-1?f&&N.settings.minSpareCols>0?(F.alter("insert_col",m),m=F.countCols()):N.settings.autoWrapRow&&(w.row=N.selRange.highlight.row+w.row==c-1?1-c:1,w.col=1-m):N.settings.autoWrapRow&&N.selRange.highlight.col+w.col<0&&N.selRange.highlight.row+w.row>=0&&(w.row=N.selRange.highlight.row+w.row==0?c-1:-1,w.col=m-1),Q=new a4(N.selRange.highlight.row+w.row,N.selRange.highlight.col+w.col),Q.row<0?(y=-1,Q.row=0):Q.row>0&&Q.row>=c&&(y=1,Q.row=c-1),Q.col<0?(p=-1,Q.col=0):Q.col>0&&Q.col>=m&&(p=1,Q.col=m-1),F.runHooks("afterModifyTransformStart",Q,y,p),C.setRangeStart(Q,d)},transformEnd:function(m,f){var u,p,h,d=new a4(m,f),g=0,c=0;F.runHooks("modifyTransformEnd",d),u=F.countRows(),p=F.countCols(),h=new a4(N.selRange.to.row+d.row,N.selRange.to.col+d.col),h.row<0?(g=-1,h.row=0):h.row>0&&h.row>=u&&(g=1,h.row=u-1),h.col<0?(c=-1,h.col=0):h.col>0&&h.col>=p&&(c=1,h.col=p-1),F.runHooks("afterModifyTransformEnd",h,g,c),C.setRangeEnd(h,!0)},isSelected:function(){return null!==N.selRange},inInSelection:function(c){return C.isSelected()?N.selRange.includes(c):!1},deselect:function(){C.isSelected()&&(F.selection.inProgress=!1,N.selRange=null,F.view.wt.selections.current.clear(),F.view.wt.selections.area.clear(),(N.settings.currentRowClassName||N.settings.currentColClassName)&&F.view.wt.selections.highlight.clear(),J.destroyEditor(),C.refreshBorders(),aj.hooks.run(F,"afterDeselect"))},selectAll:function(){N.settings.multiSelect&&(C.setRangeStart(new a4(0,0)),C.setRangeEnd(new a4(F.countRows()-1,F.countCols()-1),!1))},empty:function(){if(C.isSelected()){var f,c,h=N.selRange.getTopLeftCorner(),g=N.selRange.getBottomRightCorner(),d=[];for(f=h.row;f<=g.row;f++){for(c=h.col;c<=g.col;c++){F.getCellMeta(f,c).readOnly||d.push([f,c,""])}}F.setDataAtCell(d)}}},this.init=function(){M.setData(N.settings.data),aj.hooks.run(F,"beforeInit"),aC()&&ap(F.rootElement,"mobile"),this.updateSettings(N.settings,!0),this.view=new ad(this),J=new am(F,N,C,I),this.forceFullRender=!0,aj.hooks.run(F,"init"),this.view.render(),"object"==typeof N.firstRun&&(aj.hooks.run(F,"afterChange",N.firstRun[0],N.firstRun[1]),N.firstRun=!1),aj.hooks.run(F,"afterInit")},this.validateCell=function(g,d,l,h){function f(p){var s=d.visualCol,n=d.visualRow,m=F.getCell(n,s,!0);m&&"TH"!=m.nodeName&&F.view.wt.wtSettings.settings.cellRenderer(n,s,m),l(p)}var c=F.getCellValidator(d);"[object RegExp]"===Object.prototype.toString.call(c)&&(c=function(i){return function(e,m){m(i.test(e))}}(c)),"function"==typeof c?(g=aj.hooks.run(F,"beforeValidate",g,d.visualRow,d.prop,h),F._registerTimeout(setTimeout(function(){c.call(d,g,function(e){e=aj.hooks.run(F,"afterValidate",e,g,d.visualRow,d.prop,h),d.valid=e,f(e),aj.hooks.run(F,"postAfterValidate",e,g,d.visualRow,d.prop,h)})},0))):F._registerTimeout(setTimeout(function(){d.valid=!0,f(d.valid)},0))},this.setDataAtCell=function(h,r,f,v){var g,o,p,m=H(h,r,f),i=[];for(g=0,o=m.length;o>g;g++){if("object"!=typeof m[g]){throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter")}if("number"!=typeof m[g][1]){throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`")}p=I.colToProp(m[g][1]),i.push([m[g][0],p,I.get(m[g][0],p),m[g][2]])}v||"object"!=typeof h||(v=r),D(i,v,function(){B(i,v)})},this.setDataAtRowProp=function(m,h,p,i){var f,d,g=H(m,h,p),o=[];for(f=0,d=g.length;d>f;f++){o.push([g[f][0],g[f][1],I.get(g[f][0],g[f][1]),g[f][2]])}i||"object"!=typeof m||(i=h),D(o,i,function(){B(o,i)})},this.listen=function(){aj.activeGuid=F.guid},this.unlisten=function(){aj.activeGuid=null},this.isListening=function(){return aj.activeGuid===F.guid},this.destroyEditor=function(c){C.refreshBorders(c)},this.populateFromArray=function(m,w,f,d,c,h,y,g,p){var v;if("object"!=typeof f||"object"!=typeof f[0]){throw new Error("populateFromArray parameter `input` must be an array of arrays")}return v="number"==typeof d?new a4(d,c):null,K.populateFromArray(new a4(m,w),f,v,h,y,g,p)},this.spliceCol=function(d,c,f){return I.spliceCol.apply(I,arguments)},this.spliceRow=function(d,c,f){return I.spliceRow.apply(I,arguments)},this.getSelected=function(){return C.isSelected()?[N.selRange.from.row,N.selRange.from.col,N.selRange.to.row,N.selRange.to.col]:void 0},this.getSelectedRange=function(){return C.isSelected()?N.selRange:void 0},this.render=function(){F.view&&(F.renderCall=!0,F.forceFullRender=!0,C.refreshBorders(null,!0))},this.loadData=function(h){function d(){N.cellSettings.length=0}if("object"==typeof h&&null!==h){h.push&&h.splice||(h=[h])}else{if(null!==h){throw new Error("loadData only accepts array of objects or array of arrays ("+typeof h+" given)")}h=[];for(var m,l=0,g=N.settings.startRows;g>l;l++){m=[];for(var c=0,f=N.settings.startCols;f>c;c++){m.push(null)}h.push(m)}}N.isPopulated=!1,k.prototype.data=h,Array.isArray(N.settings.dataSchema)||Array.isArray(h[0])?F.dataType="array":"function"==typeof N.settings.dataSchema?F.dataType="function":F.dataType="object",I&&I.destroy(),I=new aH(F,N,k),M.data=h,M.dataType=F.dataType,M.colToProp=I.colToProp.bind(I),M.propToCol=I.propToCol.bind(I),d(),K.adjustRowsAndCols(),aj.hooks.run(F,"afterLoadData",N.firstRun),N.firstRun?N.firstRun=[null,"loadData"]:(aj.hooks.run(F,"afterChange",null,"loadData"),F.render()),N.isPopulated=!0},this.getData=function(d,c,g,f){return"undefined"==typeof d?I.getAll():I.getRange(new a4(d,c),new a4(g,f),I.DESTINATION_RENDERER)},this.getCopyableText=function(d,c,g,f){return I.getCopyableText(new a4(d,c),new a4(g,f))},this.getCopyableData=function(d,c){return I.getCopyable(d,I.colToProp(c))},this.getSchema=function(){return I.getSchema()},this.updateSettings=function(w,S){var h,f;if("undefined"!=typeof w.rows){throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?')}if("undefined"!=typeof w.cols){throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?')}for(h in w){"data"!==h&&(aj.hooks.getRegistered().indexOf(h)>-1?("function"==typeof w[h]||Array.isArray(w[h]))&&F.addHook(h,w[h]):!S&&w.hasOwnProperty(h)&&(k.prototype[h]=w[h]))}if(void 0===w.data&&void 0===N.settings.data?F.loadData(null):void 0!==w.data?F.loadData(w.data):void 0!==w.columns&&I.createMap(),f=F.countCols(),void 0===w.cell&&void 0===w.cells&&void 0===w.columns||(N.cellSettings.length=0),f>0){var c,p;for(h=0;f>h;h++){N.columnSettings[h]=az(k,N.columnsSettingConflicts),c=N.columnSettings[h].prototype,k.prototype.columns&&(p=k.prototype.columns[h],p&&(af(c,p),af(c,A(p))))}}if("undefined"!=typeof w.cell){for(h in w.cell){if(w.cell.hasOwnProperty(h)){var m=w.cell[h];F.setCellMetaObject(m.row,m.col,m)}}}aj.hooks.run(F,"afterCellMetaReset"),"undefined"!=typeof w.className&&(k.prototype.className&&av(F.rootElement,k.prototype.className),w.className&&ap(F.rootElement,w.className));var P=F.rootElement.style.height;""!==P&&(P=parseInt(F.rootElement.style.height,10));var R=w.height;if("function"==typeof R&&(R=R()),S){var y=F.rootElement.getAttribute("style");y&&F.rootElement.setAttribute("data-initialstyle",F.rootElement.getAttribute("style"))}if(null===R){var s=F.rootElement.getAttribute("data-initialstyle");s&&(s.indexOf("height")>-1||s.indexOf("overflow")>-1)?F.rootElement.setAttribute("style",s):(F.rootElement.style.height="",F.rootElement.style.overflow="")}else{void 0!==R&&(F.rootElement.style.height=R+"px",F.rootElement.style.overflow="hidden")}if("undefined"!=typeof w.width){var Q=w.width;"function"==typeof Q&&(Q=Q()),F.rootElement.style.width=Q+"px"}S||(I.clearLengthCache(),aj.hooks.run(F,"afterUpdateSettings")),K.adjustRowsAndCols(),F.view&&!N.firstRun&&(F.forceFullRender=!0,C.refreshBorders(null,!0)),S||!F.view||""!==P&&""!==R&&void 0!==R||P===R||F.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var c=F.getSelected();if(k.prototype.getValue){if("function"==typeof k.prototype.getValue){return k.prototype.getValue.call(F)}if(c){return F.getData()[c[0]][k.prototype.getValue]}}else{if(c){return F.getDataAtCell(c[0],c[1])}}},this.getSettings=function(){return N.settings},this.clear=function(){C.selectAll(),C.empty()},this.alter=function(f,c,h,g,d){K.alter(f,c,h,g,d)},this.getCell=function(d,c,f){return F.view.getCellAtCoords(new a4(d,c),f)},this.getCoords=function(c){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,c)},this.colToProp=function(c){return I.colToProp(c)},this.propToCol=function(c){return I.propToCol(c)},this.getDataAtCell=function(d,c){return I.get(d,I.colToProp(c))},this.getDataAtRowProp=function(d,c){return I.get(d,c)},this.getDataAtCol=function(d){var c=[];return c.concat.apply(c,I.getRange(new a4(0,d),new a4(N.settings.data.length-1,d),I.DESTINATION_RENDERER))},this.getDataAtProp=function(d){var c,f=[];return c=I.getRange(new a4(0,I.propToCol(d)),new a4(N.settings.data.length-1,I.propToCol(d)),I.DESTINATION_RENDERER),f.concat.apply(f,c)},this.getSourceData=function(f,c,h,g){var d;return d=void 0===f?M.getData():M.getByRange(new a4(f,c),new a4(h,g))},this.getSourceDataAtCol=function(c){return M.getAtColumn(c)},this.getSourceDataAtRow=function(c){return M.getAtRow(c)},this.getSourceDataAtCell=function(d,c){return M.getAtCell(d,c)},this.getDataAtRow=function(d){var c=I.getRange(new a4(d,0),new a4(d,this.countCols()-1),I.DESTINATION_RENDERER);return c[0]},this.getDataType=function(m,f,u,p){var h=this,d=null,g=null;void 0===m&&(m=0,u=this.countRows(),f=0,p=this.countCols()),void 0===u&&(u=m),void 0===p&&(p=f);var c="mixed";return aD(Math.min(m,u),Math.max(m,u),function(i){var l=!0;return aD(Math.min(f,p),Math.max(f,p),function(e){var n=h.getCellMeta(i,e);return g=n.type,d?l=d===g:d=g,l}),c=l?g:"mixed",l}),c},this.removeCellMeta=function(d,c,g){var f=F.getCellMeta(d,c);void 0!=f[g]&&delete N.cellSettings[d][c][g]},this.setCellMetaObject=function(f,c,h){if("object"==typeof h){for(var g in h){if(h.hasOwnProperty(g)){var d=h[g];this.setCellMeta(f,c,g,d)}}}},this.setCellMeta=function(d,c,g,f){N.cellSettings[d]||(N.cellSettings[d]=[]),N.cellSettings[d][c]||(N.cellSettings[d][c]=new N.columnSettings[c]),N.cellSettings[d][c][g]=f,aj.hooks.run(F,"afterSetCellMeta",d,c,g,f)},this.getCellsMeta=function(){return aB(N.cellSettings)},this.getCellMeta=function(h,f){var m,l=I.colToProp(f),g=h,d=f;if(h=G(h),f=O(f),N.columnSettings[f]||(N.columnSettings[f]=az(k,N.columnsSettingConflicts)),N.cellSettings[h]||(N.cellSettings[h]=[]),N.cellSettings[h][f]||(N.cellSettings[h][f]=new N.columnSettings[f]),m=N.cellSettings[h][f],m.row=h,m.col=f,m.visualRow=g,m.visualCol=d,m.prop=l,m.instance=F,aj.hooks.run(F,"beforeGetCellMeta",h,f,m),af(m,A(m)),m.cells){var c=m.cells.call(m,h,f,l);c&&(af(m,c),af(m,A(c)))}return aj.hooks.run(F,"afterGetCellMeta",h,f,m),m},this.isColumnModificationAllowed=function(){return !("object"===F.dataType||F.getSettings().columns)};var j=at("renderer");this.getCellRenderer=function(d,c){var f=j.call(this,d,c);return ah(f)},this.getCellEditor=at("editor"),this.getCellValidator=at("validator"),this.validateCells=function(f){var c=new E;f&&(c.onQueueEmpty=f);for(var g=F.countRows()-1;g>=0;){for(var d=F.countCols()-1;d>=0;){c.addValidatorToQueue(),F.validateCell(F.getDataAtCell(g,d),F.getCellMeta(g,d),function(h){if("boolean"!=typeof h){throw new Error("Validation error: result is not boolean")}h===!1&&(c.valid=!1),c.removeValidatorFormQueue()},"validateCells"),d--}g--}c.checkIfQueueIsEmpty()},this.getRowHeader=function(d){var c=N.settings.rowHeaders;return void 0!==d&&(d=aj.hooks.run(F,"modifyRowHeader",d)),void 0===d?(c=[],aD(F.countRows()-1,function(f){c.push(F.getRowHeader(f))})):Array.isArray(c)&&void 0!==c[d]?c=c[d]:"function"==typeof c?c=c(d):c&&"string"!=typeof c&&"number"!=typeof c&&(c=d+1),c},this.hasRowHeaders=function(){return !!N.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==N.settings.colHeaders&&null!==N.settings.colHeaders){return !!N.settings.colHeaders}for(var d=0,c=F.countCols();c>d;d++){if(F.getColHeader(d)){return !0}}return !1},this.getColHeader=function(f){if(f=aj.hooks.run(F,"modifyColHeader",f),void 0===f){for(var c=[],h=0,g=F.countCols();g>h;h++){c.push(F.getColHeader(h))}return c}var d=f;return f=aj.hooks.run(F,"modifyCol",f),N.settings.columns&&N.settings.columns[f]&&N.settings.columns[f].title?N.settings.columns[f].title:Array.isArray(N.settings.colHeaders)&&void 0!==N.settings.colHeaders[f]?N.settings.colHeaders[f]:"function"==typeof N.settings.colHeaders?N.settings.colHeaders(f):N.settings.colHeaders&&"string"!=typeof N.settings.colHeaders&&"number"!=typeof N.settings.colHeaders?al(d):N.settings.colHeaders},this._getColWidthFromSettings=function(d){var c=F.getCellMeta(0,d),f=c.width;if(void 0!==f&&f!==N.settings.width||(f=c.colWidths),void 0!==f&&null!==f){switch(typeof f){case"object":f=f[d];break;case"function":f=f(d)}"string"==typeof f&&(f=parseInt(f,10))}return f},this.getColWidth=function(d){var c=F._getColWidthFromSettings(d);return c=aj.hooks.run(F,"modifyColWidth",c,d),void 0===c&&(c=aa.DEFAULT_WIDTH),c},this._getRowHeightFromSettings=function(d){var c=N.settings.rowHeights;if(void 0!==c&&null!==c){switch(typeof c){case"object":c=c[d];break;case"function":c=c(d)}"string"==typeof c&&(c=parseInt(c,10))}return c},this.getRowHeight=function(d){var c=F._getRowHeightFromSettings(d);return c=aj.hooks.run(F,"modifyRowHeight",c,d)},this.countSourceRows=function(){return F.getSourceData()?F.getSourceData().length:0},this.countRows=function(){return I.getLength()},this.countCols=function(){return"object"===F.dataType||"function"===F.dataType?N.settings.columns&&N.settings.columns.length?N.settings.columns.length:I.colToPropCache.length:"array"===F.dataType?N.settings.columns&&N.settings.columns.length?N.settings.columns.length:N.settings.data&&N.settings.data[0]&&N.settings.data[0].length?N.settings.data[0].length:0:void 0},this.rowOffset=function(){return F.view.wt.wtTable.getFirstRenderedRow()},this.colOffset=function(){return F.view.wt.wtTable.getFirstRenderedColumn()},this.countRenderedRows=function(){return F.view.wt.drawn?F.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return F.view.wt.drawn?F.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return F.view.wt.drawn?F.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return F.view.wt.drawn?F.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(d){for(var c,g=F.countRows()-1,f=0;g>=0;){if(c=aj.hooks.run(this,"modifyRow",g),F.isEmptyRow(c)){f++}else{if(d){break}}g--}return f},this.countEmptyCols=function(d){if(F.countRows()<1){return 0}for(var c=F.countCols()-1,f=0;c>=0;){if(F.isEmptyCol(c)){f++}else{if(d){break}}c--}return f},this.isEmptyRow=function(c){return N.settings.isEmptyRow.call(F,c)},this.isEmptyCol=function(c){return N.settings.isEmptyCol.call(F,c)},this.selectCell=function(h,d,m,l,g,c){var f;if(c="undefined"==typeof c||c===!0,"number"!=typeof h||0>h||h>=F.countRows()){return !1}if("number"!=typeof d||0>d||d>=F.countCols()){return !1}if("undefined"!=typeof m){if("number"!=typeof m||0>m||m>=F.countRows()){return !1}if("number"!=typeof l||0>l||l>=F.countCols()){return !1}}return f=new a4(h,d),N.selRange=new ae(f,f,f),c&&F.listen(),"undefined"==typeof m?C.setRangeEnd(N.selRange.from,g):C.setRangeEnd(new a4(m,l),g),F.selection.finish(),!0},this.selectCellByProp=function(f,c,h,g,d){return arguments[1]=I.propToCol(arguments[1]),"undefined"!=typeof arguments[3]&&(arguments[3]=I.propToCol(arguments[3])),F.selectCell.apply(F,arguments)},this.deselectCell=function(){C.deselect()},this.scrollViewportTo=function(d,c){if(void 0!==d&&(0>d||d>=F.countRows())){return !1}if(void 0!==c&&(0>c||c>=F.countCols())){return !1}var f=!1;return void 0!==d&&void 0!==c&&(F.view.wt.scrollVertical(d),F.view.wt.scrollHorizontal(c),f=!0),"number"==typeof d&&"number"!=typeof c&&(F.view.wt.scrollVertical(d),f=!0),"number"==typeof c&&"number"!=typeof d&&(F.view.wt.scrollHorizontal(c),f=!0),f},this.destroy=function(){F._clearTimeouts(),F.view&&F.view.destroy(),M&&M.destroy(),M=null,an(F.rootElement),q.destroy(),aj.hooks.run(F,"afterDestroy"),aj.hooks.destroy(F);for(var c in F){F.hasOwnProperty(c)&&("function"==typeof F[c]?F[c]=x:"guid"!==c&&(F[c]=null))}I&&I.destroy(),I=null,N=null,K=null,C=null,J=null,F=null,k=null},this.getActiveEditor=function(){return J.getActiveEditor()},this.getPlugin=function(c){return ac(this,c)},this.getInstance=function(){return F},this.addHook=function(d,c){aj.hooks.add(d,c,F)},this.hasHook=function(c){return aj.hooks.has(c,F)},this.addHookOnce=function(d,c){aj.hooks.once(d,c,F)},this.removeHook=function(d,c){aj.hooks.remove(d,c,F)},this.runHooks=function(h,d,m,l,g,c,f){return aj.hooks.run(F,h,d,m,l,g,c,f)},this.timeouts=[],this._registerTimeout=function(c){this.timeouts.push(c)},this._clearTimeouts=function(){for(var d=0,c=this.timeouts.length;c>d;d++){clearTimeout(this.timeouts[d])}},this.version=aj.version,aj.hooks.run(F,"construct")};var aE=function(){};aE.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1000,copyColsLimit:1000,pasteMode:"overwrite",persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(f){var c,h,g,d;for(c=0,h=this.countCols();h>c;c++){if(g=this.getDataAtCell(f,c),""!==g&&null!==g&&"undefined"!=typeof g){return"object"==typeof g?(d=this.getCellMeta(f,c),aV(this.getSchema()[d.prop],g)):!1}}return !0},isEmptyCol:function(d){var c,g,f;for(c=0,g=this.countRows();g>c;c++){if(f=this.getDataAtCell(c,d),""!==f&&null!==f&&"undefined"!=typeof f){return !1}}return !0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,autoComplete:void 0,visibleRows:10,trimDropdown:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,contextMenuCopyPaste:void 0,copyPaste:void 0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,sortIndicator:void 0,manualColumnFreeze:void 0,trimWhitespace:!0,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,format:void 0,language:void 0,selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:void 0,correctFormat:!1,defaultDate:void 0,strict:void 0,renderAllRows:void 0,preventOverflow:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortFunction:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1},aj.DefaultSettings=aE},{"3rdparty/walkontable/src/calculator/viewportColumns":3,"3rdparty/walkontable/src/cell/coords":5,"3rdparty/walkontable/src/cell/range":6,"3rdparty/walkontable/src/selection":18,browser:23,dataMap:26,dataSource:27,editorManager:28,eventManager:41,"helpers/array":42,"helpers/browser":43,"helpers/data":44,"helpers/dom/element":46,"helpers/number":51,"helpers/object":52,"helpers/setting":53,"helpers/string":54,numeral:"numeral",plugins:59,renderers:92,tableView:101}],26:[function(X,G,N){function L(d,c,g){var f=this;this.instance=d,this.priv=c,this.GridSettings=g,this.dataSource=this.instance.getSettings().data,this.cachedLength=null,this.latestSourceRowsCount=0,this.dataSource[0]?this.duckSchema=this.recursiveDuckSchema(this.dataSource[0]):this.duckSchema={},this.createMap(),this.interval=k.create(function(){return f.clearLengthCache()},"15fps")}Object.defineProperties(N,{DataMap:{get:function(){return L}},__esModule:{value:!0}});var J,Q,H,P,ab,D,Z,U,Y,W=(J=X("browser"),J&&J.__esModule&&J||{"default":J})["default"],K=(Q=X("SheetClip"),Q&&Q.__esModule&&Q||{"default":Q})["default"],V=(H=X("helpers/data"),H&&H.__esModule&&H||{"default":H}).cellMethodLookupFactory,O=(P=X("helpers/setting"),P&&P.__esModule&&P||{"default":P}).columnFactory,A=(ab=X("helpers/object"),ab&&ab.__esModule&&ab||{"default":ab}),B=A.duckSchema,z=A.deepExtend,aa=A.deepClone,I=(D=X("helpers/array"),D&&D.__esModule&&D||{"default":D}),ac=I.extendArray,q=I.to2dArray,k=(Z=X("utils/interval"),Z&&Z.__esModule&&Z||{"default":Z}).Interval,F=(U=X("helpers/number"),U&&U.__esModule&&U||{"default":U}).rangeEach,j=(Y=X("multiMap"),Y&&Y.__esModule&&Y||{"default":Y}).MultiMap;L.prototype.DESTINATION_RENDERER=1,L.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,L.prototype.recursiveDuckSchema=function(c){return B(c)},L.prototype.recursiveDuckColumns=function(f,c,h){var g,d;if("undefined"==typeof c&&(c=0,h=""),"object"==typeof f&&!Array.isArray(f)){for(d in f){f.hasOwnProperty(d)&&(null===f[d]?(g=h+d,this.colToPropCache.push(g),this.propToColCache.set(g,c),c++):c=this.recursiveDuckColumns(f[d],c,d+"."))}}return c},L.prototype.createMap=function(){var d,c,g=this.getSchema();if("undefined"==typeof g){throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`")}this.colToPropCache=[],this.propToColCache=new j;var f=this.instance.getSettings().columns;if(f){for(d=0,c=f.length;c>d;d++){"undefined"!=typeof f[d].data&&(this.colToPropCache[d]=f[d].data,this.propToColCache.set(f[d].data,d))}}else{this.recursiveDuckColumns(g)}},L.prototype.colToProp=function(c){return c=W.hooks.run(this.instance,"modifyCol",c),this.colToPropCache&&"undefined"!=typeof this.colToPropCache[c]?this.colToPropCache[c]:c},L.prototype.propToCol=function(d){var c;return c="undefined"==typeof this.propToColCache.get(d)?d:this.propToColCache.get(d),c=W.hooks.run(this.instance,"unmodifyCol",c)},L.prototype.getSchema=function(){var c=this.instance.getSettings().dataSchema;return c?"function"==typeof c?c():c:this.duckSchema},L.prototype.createRow=function(m,f,u){var p,h,d=this.instance.countCols(),g=0;f||(f=1),("number"!=typeof m||m>=this.instance.countSourceRows())&&(m=this.instance.countSourceRows()),h=m;for(var c=this.instance.getSettings().maxRows;f>g&&this.instance.countSourceRows()<c;){"array"===this.instance.dataType?this.instance.getSettings().dataSchema?p=aa(this.getSchema()):(p=[],F(d-1,function(){return p.push(null)})):"function"===this.instance.dataType?p=this.instance.getSettings().dataSchema(m):(p={},z(p,this.getSchema())),m===this.instance.countSourceRows()?this.dataSource.push(p):this.dataSource.splice(m,0,p),g++,h++}return W.hooks.run(this.instance,"afterCreateRow",m,g,u),this.instance.forceFullRender=!0,g},L.prototype.createCol=function(m,w,f){if(!this.instance.isColumnModificationAllowed()){throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.")}var d,c,h=this.instance.countSourceRows(),y=this.dataSource,g=0;w||(w=1),("number"!=typeof m||m>=this.instance.countCols())&&(m=this.instance.countCols()),c=m;for(var p=this.instance.getSettings().maxCols;w>g&&this.instance.countCols()<p;){if(d=O(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof m||m>=this.instance.countCols()){for(var v=0;h>v;v++){"undefined"==typeof y[v]&&(y[v]=[]),y[v].push(null)}this.priv.columnSettings.push(d)}else{for(var v=0;h>v;v++){y[v].splice(c,0,null)}this.priv.columnSettings.splice(c,0,d)}g++,c++}return W.hooks.run(this.instance,"afterCreateCol",m,g,f),this.instance.forceFullRender=!0,g},L.prototype.removeRow=function(g,d){d||(d=1),"number"!=typeof g&&(g=-d),g=(this.instance.countSourceRows()+g)%this.instance.countSourceRows();var l=this.physicalRowsToLogical(g,d),h=(l.slice(0).sort(function(m,i){return i-m}),W.hooks.run(this.instance,"beforeRemoveRow",g,d,l));if(h!==!1){var f,c=this.dataSource;f=c.filter(function(m,i){return -1==l.indexOf(i)}),c.length=0,Array.prototype.push.apply(c,f),W.hooks.run(this.instance,"afterRemoveRow",g,d,l),this.instance.forceFullRender=!0}},L.prototype.removeCol=function(R,af){if("object"===this.instance.dataType||this.instance.getSettings().columns){throw new Error("cannot remove column with object data source or columns option specified")}af||(af=1),"number"!=typeof R&&(R=-af),R=(this.instance.countCols()+R)%this.instance.countCols();var w=this.physicalColumnsToLogical(R,af),v=w.slice(0).sort(function(d,c){return c-d}),f=W.hooks.run(this.instance,"beforeRemoveCol",R,af,w);if(f!==!1){for(var C=!0,ag=v.length,y=this.dataSource,ad=0;ag>ad;ad++){C&&w[0]!==w[ad]-ad&&(C=!1)}if(C){for(var ae=0,T=this.instance.countSourceRows();T>ae;ae++){y[ae].splice(w[0],af)}}else{for(var E=0,S=this.instance.countSourceRows();S>E;E++){for(var m=0;ag>m;m++){y[E].splice(v[m],1)}}for(var M=0;ag>M;M++){this.priv.columnSettings.splice(w[M],1)}}W.hooks.run(this.instance,"afterRemoveCol",R,af),this.instance.forceFullRender=!0}},L.prototype.spliceCol=function(m,f,u){var p=4<=arguments.length?[].slice.call(arguments,3):[],h=this.instance.getDataAtCol(m),d=h.slice(f,f+u),g=h.slice(f+u);ac(p,g);for(var c=0;u>c;){p.push(null),c++}return q(p),this.instance.populateFromArray(f,m,p,null,null,"spliceCol"),d},L.prototype.spliceRow=function(m,f,u){var p=4<=arguments.length?[].slice.call(arguments,3):[],h=this.instance.getSourceDataAtRow(m),d=h.slice(f,f+u),g=h.slice(f+u);ac(p,g);for(var c=0;u>c;){p.push(null),c++}return this.instance.populateFromArray(m,f,[p],null,null,"spliceRow"),d},L.prototype.get=function(h,d){h=W.hooks.run(this.instance,"modifyRow",h);var m=this.dataSource[h];if(m&&m.hasOwnProperty&&m.hasOwnProperty(d)){return m[d]}if("string"==typeof d&&d.indexOf(".")>-1){var l=d.split("."),g=m;if(!g){return null}for(var c=0,f=l.length;f>c;c++){if(g=g[l[c]],"undefined"==typeof g){return null}}return g}return"function"==typeof d?d(this.dataSource.slice(h,h+1)[0]):null};var x=V("copyable",!1);L.prototype.getCopyable=function(d,c){return x.call(this.instance,d,this.propToCol(c))?this.get(d,c):""},L.prototype.set=function(m,u,f,d){m=W.hooks.run(this.instance,"modifyRow",m,d||"datamapGet");var c=this.dataSource[m];if(c&&c.hasOwnProperty&&c.hasOwnProperty(u)){c[u]=f}else{if("string"==typeof u&&u.indexOf(".")>-1){for(var h=u.split("."),v=c,g=0,p=h.length-1;p>g;g++){"undefined"==typeof v[h[g]]&&(v[h[g]]={}),v=v[h[g]]}v[h[g]]=f}else{"function"==typeof u?u(this.dataSource.slice(m,m+1)[0],f):c[u]=f}}},L.prototype.physicalRowsToLogical=function(h,d){for(var m,l=this.instance.countSourceRows(),g=(l+h)%l,c=[],f=d;l>g&&f;){m=W.hooks.run(this.instance,"modifyRow",g),c.push(m),f--,g++}return c},L.prototype.physicalColumnsToLogical=function(h,d){for(var m=this.instance.countCols(),l=(m+h)%m,g=[],c=d;m>l&&c;){var f=W.hooks.run(this.instance,"modifyCol",l);g.push(f),c--,l++}return g},L.prototype.clear=function(){for(var d=0;d<this.instance.countSourceRows();d++){for(var c=0;c<this.instance.countCols();c++){this.set(d,this.colToProp(c),"")}}},L.prototype.clearLengthCache=function(){this.cachedLength=null},L.prototype.getLength=function(){var d=this,c=this.instance.countSourceRows();if(W.hooks.has("modifyRow",this.instance)){var f=!1;this.interval.start(),c!==this.latestSourceRowsCount&&(f=!0),this.latestSourceRowsCount=c,null===this.cachedLength||f?(F(c-1,function(e){e=W.hooks.run(d.instance,"modifyRow",e),null===e&&--c}),this.cachedLength=c):c=this.cachedLength}else{this.interval.stop()}return c},L.prototype.getAll=function(){var d={row:0,col:0},c={row:Math.max(this.instance.countSourceRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return d.row-c.row!==0||this.instance.countSourceRows()?this.getRange(d,c,L.prototype.DESTINATION_RENDERER):[]},L.prototype.getRange=function(p,C,g){var f,d,m,E,h,w=[],y=g===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(d=Math.max(p.row,C.row),E=Math.max(p.col,C.col),f=Math.min(p.row,C.row);d>=f;f++){h=[];var v=W.hooks.run(this.instance,"modifyRow",f);for(m=Math.min(p.col,C.col);E>=m;m++){if(null===v){break}h.push(y.call(this,f,this.colToProp(m)))}null!==v&&w.push(h)}return w},L.prototype.getText=function(d,c){return K.stringify(this.getRange(d,c,this.DESTINATION_RENDERER))},L.prototype.getCopyableText=function(d,c){return K.stringify(this.getRange(d,c,this.DESTINATION_CLIPBOARD_GENERATOR))},L.prototype.destroy=function(){this.interval.stop(),this.interval=null,this.instance=null,this.priv=null,this.GridSettings=null,this.dataSource=null,this.cachedLength=null,this.duckSchema=null}},{SheetClip:"SheetClip",browser:23,"helpers/array":42,"helpers/data":44,"helpers/number":51,"helpers/object":52,"helpers/setting":53,multiMap:57,"utils/interval":103}],27:[function(w,B,k){Object.defineProperties(k,{DataSource:{get:function(){return v}},__esModule:{value:!0}});var j,g,p,C,m,z=((j=w("helpers/data"),j&&j.__esModule&&j||{"default":j}).cellMethodLookupFactory,(g=w("helpers/setting"),g&&g.__esModule&&g||{"default":g}).columnFactory,p=w("helpers/object"),p&&p.__esModule&&p||{"default":p}),A=(z.duckSchema,z.deepExtend,z.getProperty),y=(C=w("helpers/array"),C&&C.__esModule&&C||{"default":C}),q=(y.extendArray,y.arrayEach),x=(m=w("helpers/number"),m&&m.__esModule&&m||{"default":m}).rangeEach,v=function(d){var c=void 0!==arguments[1]?arguments[1]:[];this.hot=d,this.data=c,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}};$traceurRuntime.createClass(v,{getData:function(){return this.data},setData:function(c){this.data=c},getAtColumn:function(d){var c=this,f=[];return q(this.data,function(h){var e=c.colToProp(d);h="string"==typeof e?A(h,e):h[e],f.push(h)}),f},getAtRow:function(c){return this.data[c]},getAtCell:function(d,c){return this.data[d][this.colToProp(c)]},getByRange:function(D,f){var F=this,E=Math.min(D.row,f.row),u=Math.min(D.col,f.col),d=Math.max(D.row,f.row),h=Math.max(D.col,f.col),c=[];return x(E,d,function(l){var i,n=F.getAtRow(l);"array"===F.dataType?i=n.slice(u,h):"object"===F.dataType&&(i={},x(u,h,function(s){var o=F.colToProp(s);i[o]=n[o]})),c.push(i)}),c},destroy:function(){this.data=null,this.hot=null}},{})},{"helpers/array":42,"helpers/data":44,"helpers/number":51,"helpers/object":52,"helpers/setting":53}],28:[function(L,z,E){function D(y,U,h){function g(d){var i="function"==typeof U.settings.enterMoves?U.settings.enterMoves(event):U.settings.enterMoves;d?h.transformStart(-i.row,-i.col):h.transformStart(i.row,i.col,!0)}function c(d){d?h.transformEnd(-1,0):h.transformStart(-1,0)}function w(d){d?h.transformEnd(1,0):h.transformStart(1,0)}function V(d){d?h.transformEnd(0,1):h.transformStart(0,1)}function v(d){d?h.transformEnd(0,-1):h.transformStart(0,-1)}function R(i){var l,m;if(y.isListening()&&(N.hooks.run(y,"beforeKeyDown",i),!S&&!j(i)&&(U.lastKeyCode=i.keyCode,h.isSelected()))){if(l=(i.ctrlKey||i.metaKey)&&!i.altKey,p&&!p.isWaiting()&&!(C(i.keyCode)||J(i.keyCode)||l||f.isEditorOpened())){return void f.openEditor("",i)}switch(m=i.shiftKey?h.setRangeEnd:h.setRangeStart,i.keyCode){case K.A:!f.isEditorOpened()&&l&&(h.selectAll(),i.preventDefault(),k(i));break;case K.ARROW_UP:f.isEditorOpened()&&!p.isWaiting()&&f.closeEditorAndSaveChanges(l),c(i.shiftKey),i.preventDefault(),k(i);break;case K.ARROW_DOWN:f.isEditorOpened()&&!p.isWaiting()&&f.closeEditorAndSaveChanges(l),w(i.shiftKey),i.preventDefault(),k(i);break;case K.ARROW_RIGHT:f.isEditorOpened()&&!p.isWaiting()&&f.closeEditorAndSaveChanges(l),V(i.shiftKey),i.preventDefault(),k(i);break;case K.ARROW_LEFT:f.isEditorOpened()&&!p.isWaiting()&&f.closeEditorAndSaveChanges(l),v(i.shiftKey),i.preventDefault(),k(i);break;case K.TAB:var e="function"==typeof U.settings.tabMoves?U.settings.tabMoves(i):U.settings.tabMoves;i.shiftKey?h.transformStart(-e.row,-e.col):h.transformStart(e.row,e.col,!0),i.preventDefault(),k(i);break;case K.BACKSPACE:case K.DELETE:h.empty(i),f.prepareEditor(),i.preventDefault();break;case K.F2:f.openEditor(null,i),p&&p.enableFullEditMode(),i.preventDefault();break;case K.ENTER:f.isEditorOpened()?(p&&p.state!==N.EditorState.WAITING&&f.closeEditorAndSaveChanges(l),g(i.shiftKey)):y.getSettings().enterBeginsEditing?(f.openEditor(null,i),p&&p.enableFullEditMode()):g(i.shiftKey),i.preventDefault(),q(i);break;case K.ESCAPE:f.isEditorOpened()&&f.closeEditorAndRestoreOriginalValue(l),i.preventDefault();break;case K.HOME:m(i.ctrlKey||i.metaKey?new I(0,U.selRange.from.col):new I(U.selRange.from.row,0)),i.preventDefault(),k(i);break;case K.END:m(i.ctrlKey||i.metaKey?new I(y.countRows()-1,U.selRange.from.col):new I(U.selRange.from.row,y.countCols()-1)),i.preventDefault(),k(i);break;case K.PAGE_UP:h.transformStart(-y.countVisibleRows(),0),i.preventDefault(),k(i);break;case K.PAGE_DOWN:h.transformStart(y.countVisibleRows(),0),i.preventDefault(),k(i)}}}function T(){function d(l,i,m){"TD"==m.nodeName&&(f.openEditor(),p&&p.enableFullEditMode())}y.addHook("afterDocumentKeyDown",R),Q.addEventListener(document.documentElement,"keydown",function(e){y.runHooks("afterDocumentKeyDown",e)}),y.view.wt.update("onCellDblClick",d),y.addHook("afterDestroy",function(){S=!0})}var Q,p,f=this,S=!1;Q=O(y),this.destroyEditor=function(d){this.closeEditor(d)},this.getActiveEditor=function(){return p},this.prepareEditor=function(){var X,W,u,m,t,e,d;return p&&p.isWaiting()?void this.closeEditor(!1,!1,function(i){i&&f.prepareEditor()}):(X=U.selRange.highlight.row,W=U.selRange.highlight.col,u=y.colToProp(W),m=y.getCell(X,W),t=y.getDataAtCell(X,W),e=y.getCellMeta(X,W),d=y.getCellEditor(e),void (d?(p=N.editors.getEditor(d,y),p.prepare(X,W,u,m,t,e)):p=void 0))},this.isEditorOpened=function(){return p&&p.isOpened()},this.openEditor=function(i,d){p&&!p.cellProperties.readOnly?p.beginEditing(i,d):p&&p.cellProperties.readOnly&&d&&d.keyCode===K.ENTER&&g()},this.closeEditor=function(i,d,l){p?p.finishEditing(i,d,l):l&&l(!1)},this.closeEditorAndSaveChanges=function(d){return this.closeEditor(!1,d)},this.closeEditorAndRestoreOriginalValue=function(d){return this.closeEditor(!0,d)},T()}Object.defineProperties(E,{EditorManager:{get:function(){return D}},__esModule:{value:!0}});var B,H,A,G,P,x,N=(B=L("browser"),B&&B.__esModule&&B||{"default":B})["default"],I=(H=L("3rdparty/walkontable/src/cell/coords"),H&&H.__esModule&&H||{"default":H}).WalkontableCellCoords,M=(A=L("helpers/unicode"),A&&A.__esModule&&A||{"default":A}),K=M.KEY_CODES,C=M.isMetaKey,J=M.isCtrlKey,F=(G=L("helpers/dom/event"),G&&G.__esModule&&G||{"default":G}),k=F.stopPropagation,q=F.stopImmediatePropagation,j=F.isImmediatePropagationStopped,O=((P=L("editors"),P&&P.__esModule&&P||{"default":P}).getEditor,(x=L("eventManager"),x&&x.__esModule&&x||{"default":x}).eventManager);N.EditorManager=D},{"3rdparty/walkontable/src/cell/coords":5,browser:23,editors:29,eventManager:41,"helpers/dom/event":47,"helpers/unicode":55}],29:[function(w,B,k){function j(d){var c,f;f={},c=d,this.getConstructor=function(){return d},this.getInstance=function(h){return h.guid in f||(f[h.guid]=new c(h)),f[h.guid]}}function g(d,c){var f=new j(c);"string"==typeof d&&(x[d]=f,y.editors[q(d)+"Editor"]=c),v.set(c,f)}function p(d,c){var f;if("function"==typeof d){v.get(d)||g(null,d),f=v.get(d)}else{if("string"!=typeof d){throw Error('Only strings and functions can be passed as "editor" parameter ')}f=x[d]}if(!f){throw Error('No editor registered under name "'+d+'"')}return f.getInstance(c)}function C(d){var c;if("string"!=typeof d){throw Error('Only strings and functions can be passed as "editor" parameter ')}if(c=x[d],!c){throw Error('No editor registered under name "'+d+'"')}return c.getConstructor()}function m(c){return !!x[c]}Object.defineProperties(k,{registerEditor:{get:function(){return g}},getEditor:{get:function(){return p}},hasEditor:{get:function(){return m}},getEditorConstructor:{get:function(){return C}},__esModule:{value:!0}});var z,A,y=(z=w("browser"),z&&z.__esModule&&z||{"default":z})["default"],q=(A=w("helpers/string"),A&&A.__esModule&&A||{"default":A}).toUpperCaseFirst,x={},v=new WeakMap;y.editors=y.editors||{},y.editors.registerEditor=g,y.editors.getEditor=p},{browser:23,"helpers/string":54}],30:[function(j,p,f){function d(i){this.instance=i,this.state=g.EditorState.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.init()}Object.defineProperties(f,{BaseEditor:{get:function(){return d}},__esModule:{value:!0}});var c,h,q,g=(c=j("browser"),c&&c.__esModule&&c||{"default":c})["default"],k=(h=j("helpers/mixed"),h&&h.__esModule&&h||{"default":h}).stringify,m=(q=j("3rdparty/walkontable/src/cell/coords"),q&&q.__esModule&&q||{"default":q}).WalkontableCellCoords;g.editors=g.editors||{},g.editors.BaseEditor=d,g.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},d.prototype._fireCallbacks=function(i){this._closeCallback&&(this._closeCallback(i),this._closeCallback=null)},d.prototype.init=function(){},d.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},d.prototype.setValue=function(i){throw Error("Editor setValue() method unimplemented")},d.prototype.open=function(){throw Error("Editor open() method unimplemented")},d.prototype.close=function(){throw Error("Editor close() method unimplemented")},d.prototype.prepare=function(v,s,x,w,u,l){this.TD=w,this.row=v,this.col=s,this.prop=x,this.originalValue=u,this.cellProperties=l,this.instance.view.isMouseDown()&&document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus(),this.state=g.EditorState.VIRGIN},d.prototype.extend=function(){function l(){o.apply(this,arguments)}function i(s,r){function u(){}return u.prototype=r.prototype,s.prototype=new u,s.prototype.constructor=s,s}var o=this.constructor;return i(l,o)},d.prototype.saveValue=function(l,i){var s,r;i?(s=this.instance.getSelected(),s[0]>s[2]&&(r=s[0],s[0]=s[2],s[2]=r),s[1]>s[3]&&(r=s[1],s[1]=s[3],s[3]=r),this.instance.populateFromArray(s[0],s[1],l,s[2],s[3],"edit")):this.instance.populateFromArray(this.row,this.col,l,null,null,"edit")},d.prototype.beginEditing=function(l,i){this.state==g.EditorState.VIRGIN&&(this.instance.view.scrollViewport(new m(this.row,this.col)),this.instance.view.render(),this.state=g.EditorState.EDITING,l="string"==typeof l?l:this.originalValue,this.setValue(k(l)),this.open(i),this._opened=!0,this.focus(),this.instance.view.render())},d.prototype.finishEditing=function(x,u,z){var y,w=this;if(z){var l=this._closeCallback;this._closeCallback=function(i){l&&l(i),z(i)}}if(!this.isWaiting()){if(this.state==g.EditorState.VIRGIN){return void this.instance._registerTimeout(setTimeout(function(){w._fireCallbacks(!0)},0))}if(this.state==g.EditorState.EDITING){if(x){return this.cancelChanges(),void this.instance.view.render()}var v=this.getValue();y=this.instance.getSettings().trimWhitespace?[["string"==typeof v?String.prototype.trim.call(v||""):v]]:[[v]],this.state=g.EditorState.WAITING,this.saveValue(y,u),this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(i){w.state=g.EditorState.FINISHED,w.discardEditor(i)}):(this.state=g.EditorState.FINISHED,this.discardEditor(!0))}}},d.prototype.cancelChanges=function(){this.state=g.EditorState.FINISHED,this.discardEditor()},d.prototype.discardEditor=function(i){this.state===g.EditorState.FINISHED&&(i===!1&&this.cellProperties.allowInvalid!==!0?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=g.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=g.EditorState.VIRGIN,this._fireCallbacks(!0)))},d.prototype.enableFullEditMode=function(){this._fullEditMode=!0},d.prototype.isInFullEditMode=function(){return this._fullEditMode},d.prototype.isOpened=function(){return this._opened},d.prototype.isWaiting=function(){return this.state===g.EditorState.WAITING},d.prototype.checkEditorSection=function(){var l=this.instance.countRows(),i="";return this.row<this.instance.getSettings().fixedRowsTop?i=this.col<this.instance.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.instance.getSettings().fixedRowsBottom&&this.row>=l-this.instance.getSettings().fixedRowsBottom?i=this.col<this.instance.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.instance.getSettings().fixedColumnsLeft&&(i="left"),i}},{"3rdparty/walkontable/src/cell/coords":5,browser:23,"helpers/mixed":50}],31:[function(ab,I,Q){function P(d){W=!1;var c=this.getActiveEditor();if(aa(d.keyCode)||d.keyCode===ac.BACKSPACE||d.keyCode===ac.DELETE||d.keyCode===ac.INSERT){var f=0;if(d.keyCode===ac.C&&(d.ctrlKey||d.metaKey)){return}c.isOpened()||(f+=10),c.htEditor&&c.instance._registerTimeout(setTimeout(function(){c.queryChoices(c.TEXTAREA.value),W=!0},f))}}Object.defineProperties(Q,{AutocompleteEditor:{get:function(){return z}},__esModule:{value:!0}});var L,X,J,V,af,G,ad,Y=((L=ab("browser"),L&&L.__esModule&&L||{"default":L})["default"],X=ab("helpers/unicode"),X&&X.__esModule&&X||{"default":X}),ac=Y.KEY_CODES,aa=Y.isPrintableChar,N=(J=ab("helpers/mixed"),J&&J.__esModule&&J||{"default":J}).stringify,Z=(V=ab("helpers/array"),V&&V.__esModule&&V||{"default":V}).pivot,U=(af=ab("helpers/dom/element"),af&&af.__esModule&&af||{"default":af}),D=U.addClass,F=U.getCaretPosition,B=U.getScrollbarWidth,ae=U.getSelectionEndPosition,K=U.outerWidth,ag=U.outerHeight,x=U.offset,q=U.getTrimmingContainer,H=U.setCaretPosition,j=(G=ab("editors"),G&&G.__esModule&&G||{"default":G}).registerEditor,A=(ad=ab("handsontableEditor"),ad&&ad.__esModule&&ad||{"default":ad}).HandsontableEditor,z=A.prototype.extend();z.prototype.init=function(){A.prototype.init.apply(this,arguments),this.query=null,this.choices=[]},z.prototype.createElements=function(){A.prototype.createElements.apply(this,arguments),D(this.htContainer,"autocompleteEditor"),D(this.htContainer,-1===window.navigator.platform.indexOf("Mac")?"":"htMacScroll")};var W=!1;z.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",P),A.prototype.prepare.apply(this,arguments)},z.prototype.open=function(){this.TEXTAREA_PARENT.style.overflow="auto",A.prototype.open.apply(this,arguments),this.TEXTAREA_PARENT.style.overflow="";var d=this.htEditor.getInstance(),c=this,f=void 0===this.cellProperties.trimDropdown?!0:this.cellProperties.trimDropdown;this.TEXTAREA.style.visibility="visible",this.focus(),d.updateSettings({colWidths:f?[K(this.TEXTAREA)-2]:void 0,width:f?K(this.TEXTAREA)+B()+2:void 0,afterRenderer:function(t,v,u,p,k){var m,h,g=this.getCellMeta(v,u).filteringCaseSensitive===!0;k=N(k),k&&(m=g?k.indexOf(this.query):k.toLowerCase().indexOf(c.query.toLowerCase()),-1!=m&&(h=k.substr(m,c.query.length),t.innerHTML=k.replace(h,"<strong>"+h+"</strong>")))},autoColumnSize:!0,modifyColWidth:function(h,g){var i=this.getPlugin("autoColumnSize").widths;return i[g]&&(h=i[g]),f?h:h+15}}),this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]=B()+2+"px",W&&(W=!1),c.instance._registerTimeout(setTimeout(function(){c.queryChoices(c.TEXTAREA.value)},0))},z.prototype.close=function(){A.prototype.close.apply(this,arguments)},z.prototype.queryChoices=function(h){this.query=h;var d=this.cellProperties.source,l=this.cellProperties.filter,k=this.cellProperties.filteringCaseSensitive;if("function"==typeof d){var g=this;d.call(this.cellProperties,h,function(i){g.updateChoicesList(i)})}else{if(Array.isArray(d)){var c;if(h&&l!==!1){var f=h.toLowerCase();c=d.filter(function(e){return k?-1!=e.indexOf(h):-1!=e.toLowerCase().indexOf(f)})}else{c=d}this.updateChoicesList(c)}else{this.updateChoicesList([])}}},z.prototype.updateChoicesList=function(k){var v=F(this.TEXTAREA),f=ae(this.TEXTAREA),d=this.cellProperties.sortByRelevance,c=this.cellProperties.filter,h=null,w=null;if(d&&(h=z.sortByRelevance(this.getValue(),k,this.cellProperties.filteringCaseSensitive)),c===!1){w=h?h[0]:0}else{for(var g=[],m=0,p=k.length;p>m;m++){h?g.push(k[h[m]]):g.push(k[m])}w=0,k=g}this.choices=k,this.htEditor.loadData(Z([k])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(w),this.instance.listen(),this.TEXTAREA.focus(),H(this.TEXTAREA,v,v===f?void 0:f)},z.prototype.flipDropdownIfNeeded=function(){var k=x(this.TEXTAREA),f=ag(this.TEXTAREA),p=this.getDropdownHeight(),m=q(this.instance.view.wt.wtTable.TABLE),h={row:0,col:0};m!==window&&(h=x(m));var d=h.top+(m.scrollHeight-m.scrollTop),g=h.top+m.scrollHeight,c=k.top+f+p>d;c&&g>d?this.flipDropdown(p):this.unflipDropdown()},z.prototype.flipDropdown=function(d){var c=this.htEditor.rootElement.style;c.position="absolute",c.top=-d+"px",this.htEditor.flipped=!0},z.prototype.unflipDropdown=function(){var c=this.htEditor.rootElement.style;"absolute"===c.position&&(c.position="",c.top=""),this.htEditor.flipped=void 0},z.prototype.updateDropdownHeight=function(){var d=this.htEditor.getColWidth(0)+B()+2,c=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:c?void 0:d}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()},z.prototype.finishEditing=function(c){c||this.instance.removeHook("beforeKeyDown",P),A.prototype.finishEditing.apply(this,arguments)},z.prototype.highlightBestMatchingChoice=function(c){"number"==typeof c?this.htEditor.selectCell(c,0):this.htEditor.deselectCell()},z.sortByRelevance=function(m,y,g){var f,d,k,C,h=[],v=m.length,w=[],p=y.length;if(0===v){for(C=0;p>C;C++){w.push(C)}return w}for(C=0;p>C;C++){f=N(y[C]),d=g?f.indexOf(m):f.toLowerCase().indexOf(m.toLowerCase()),-1!=d&&(k=f.length-d-v,h.push({baseIndex:C,index:d,charsLeft:k,value:f}))}for(h.sort(function(i,c){return -1===c.index?-1:-1===i.index?1:i.index<c.index?-1:c.index<i.index?1:i.index===c.index?i.charsLeft<c.charsLeft?-1:i.charsLeft>c.charsLeft?1:0:void 0}),C=0,p=h.length;p>C;C++){w.push(h[C].baseIndex)}return w},z.prototype.getDropdownHeight=function(){var d=this.htEditor.getInstance().getRowHeight(0)||23,c=this.cellProperties.visibleRows;return this.choices.length>=c?c*d:this.choices.length*d+8},z.prototype.allowKeyEventPropagation=function(d){var c={row:this.htEditor.getSelectedRange()?this.htEditor.getSelectedRange().from.row:-1},f=!1;return d===ac.ARROW_DOWN&&c.row>0&&c.row<this.htEditor.countRows()-1&&(f=!0),d===ac.ARROW_UP&&c.row>-1&&(f=!0),f},j("autocomplete",z)},{browser:23,editors:29,handsontableEditor:35,"helpers/array":42,"helpers/dom/element":46,"helpers/mixed":50,"helpers/unicode":55}],32:[function(k,v,g){Object.defineProperties(g,{CheckboxEditor:{get:function(){return q}},__esModule:{value:!0}});var f,d,j,w=(f=k("editors"),f&&f.__esModule&&f||{"default":f}).registerEditor,h=(d=k("_baseEditor"),d&&d.__esModule&&d||{"default":d}).BaseEditor,p=(j=k("helpers/dom/element"),j&&j.__esModule&&j||{"default":j}).hasClass,q=function(){$traceurRuntime.superConstructor(m).apply(this,arguments)},m=q;$traceurRuntime.createClass(q,{beginEditing:function(i,c){if(void 0===c){var l=this.TD.querySelector('input[type="checkbox"]');p(l,"htBadValue")||l.click()}},finishEditing:function(){},init:function(){},open:function(){},close:function(){},getValue:function(){},setValue:function(){},focus:function(){}},{},h),w("checkbox",q)},{_baseEditor:30,editors:29,"helpers/dom/element":46}],33:[function(X,G,N){Object.defineProperties(N,{DateEditor:{get:function(){return j}},__esModule:{value:!0}});var L,J,Q,H,P,ab,D,Z,U,Y,W=(L=X("browser"),L&&L.__esModule&&L||{"default":L})["default"],K=(J=X("helpers/dom/element"),J&&J.__esModule&&J||{"default":J}),V=K.addClass,O=K.outerHeight,A=(Q=X("helpers/object"),Q&&Q.__esModule&&Q||{"default":Q}).deepExtend,B=(H=X("eventManager"),H&&H.__esModule&&H||{"default":H}).EventManager,z=(P=X("editors"),P&&P.__esModule&&P||{"default":P}),aa=(z.getEditor,z.registerEditor),I=(ab=X("helpers/unicode"),ab&&ab.__esModule&&ab||{"default":ab}).isMetaKey,ac=(D=X("helpers/dom/event"),D&&D.__esModule&&D||{"default":D}).stopPropagation,q=(Z=X("textEditor"),Z&&Z.__esModule&&Z||{"default":Z}).TextEditor,k=(U=X("moment"),U&&U.__esModule&&U||{"default":U})["default"],F=(Y=X("pikaday"),Y&&Y.__esModule&&Y||{"default":Y})["default"];W.editors=W.editors||{},W.editors.DateEditor=j;var j=function(c){this.$datePicker=null,this.datePicker=null,this.datePickerStyle=null,this.defaultDateFormat="DD/MM/YYYY",this.isCellEdited=!1,this.parentDestroyed=!1,$traceurRuntime.superConstructor(x).call(this,c)},x=j;$traceurRuntime.createClass(j,{init:function(){var c=this;if("function"!=typeof k){throw new Error("You need to include moment.js to your project.")}if("function"!=typeof F){throw new Error("You need to include Pikaday to your project.")}$traceurRuntime.superGet(this,x.prototype,"init").call(this),this.instance.addHook("afterDestroy",function(){c.parentDestroyed=!0,c.destroyElements()})},createElements:function(){$traceurRuntime.superGet(this,x.prototype,"createElements").call(this),this.datePicker=document.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,V(this.datePicker,"htDatepickerHolder"),document.body.appendChild(this.datePicker),this.$datePicker=new F(this.getDatePickerConfig());var c=new B(this);c.addEventListener(this.datePicker,"mousedown",function(d){return ac(d)}),this.hideDatepicker()},destroyElements:function(){this.$datePicker.destroy()},prepare:function(g,d,l,h,f,c){this._opened=!1,$traceurRuntime.superGet(this,x.prototype,"prepare").call(this,g,d,l,h,f,c)},open:function(){var c=void 0!==arguments[0]?arguments[0]:null;$traceurRuntime.superGet(this,x.prototype,"open").call(this),this.showDatepicker(c)},close:function(){var c=this;this._opened=!1,this.instance._registerTimeout(setTimeout(function(){c.instance.selection.refreshBorders()},0)),$traceurRuntime.superGet(this,x.prototype,"close").call(this)},finishEditing:function(){var d=void 0!==arguments[0]?arguments[0]:!1,c=void 0!==arguments[1]?arguments[1]:!1;if(d){var f=this.originalValue;void 0!==f&&this.setValue(f)}this.hideDatepicker(),$traceurRuntime.superGet(this,x.prototype,"finishEditing").call(this,d,c)},showDatepicker:function(h){this.$datePicker.config(this.getDatePickerConfig());var d,m=this.TD.getBoundingClientRect(),l=this.cellProperties.dateFormat||this.defaultDateFormat,g=this.$datePicker.config(),c=this.instance.view.isMouseDown(),f=h?I(h.keyCode):!1;this.datePickerStyle.top=window.pageYOffset+m.top+O(this.TD)+"px",this.datePickerStyle.left=window.pageXOffset+m.left+"px",this.$datePicker._onInputFocus=function(){},g.format=l,this.originalValue?(d=this.originalValue,k(d,l,!0).isValid()&&this.$datePicker.setMoment(k(d,l),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),f||c||this.setValue("")):this.cellProperties.defaultDate?(d=this.cellProperties.defaultDate,g.defaultDate=d,k(d,l,!0).isValid()&&this.$datePicker.setMoment(k(d,l),!0),f||c||this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block",this.$datePicker.show()},hideDatepicker:function(){this.datePickerStyle.display="none",this.$datePicker.hide()},getDatePickerConfig:function(){var f=this,c=this.TEXTAREA,h={};this.cellProperties&&this.cellProperties.datePickerConfig&&A(h,this.cellProperties.datePickerConfig);var g=h.onSelect,d=h.onClose;return h.field=c,h.trigger=c,h.container=this.datePicker,h.bound=!1,h.format=h.format||this.defaultDateFormat,h.reposition=h.reposition||!1,h.onSelect=function(e){isNaN(e.getTime())||(e=k(e).format(f.cellProperties.dateFormat||f.defaultDateFormat)),f.setValue(e),f.hideDatepicker(),g&&g()},h.onClose=function(){f.parentDestroyed||f.finishEditing(!1),d&&d()},h}},{},q),aa("date",j)},{browser:23,editors:29,eventManager:41,"helpers/dom/element":46,"helpers/dom/event":47,"helpers/object":52,"helpers/unicode":55,moment:"moment",pikaday:"pikaday",textEditor:40}],34:[function(p,x,g){Object.defineProperties(g,{DropdownEditor:{get:function(){return q}},__esModule:{value:!0}});var f,d,k,y=(f=p("browser"),f&&f.__esModule&&f||{"default":f})["default"],j=(d=p("editors"),d&&d.__esModule&&d||{"default":d}),v=(j.getEditor,j.registerEditor),w=(j.getEditorConstructor,(k=p("autocompleteEditor"),k&&k.__esModule&&k||{"default":k}).AutocompleteEditor),q=function(){$traceurRuntime.superConstructor(m).apply(this,arguments)},m=q;$traceurRuntime.createClass(q,{prepare:function(s,h,z,u,l,c){$traceurRuntime.superGet(this,m.prototype,"prepare").call(this,s,h,z,u,l,c),this.cellProperties.filter=!1,this.cellProperties.strict=!0}},{},w),y.hooks.add("beforeValidate",function(i,c,s,l){var h=this.getCellMeta(c,this.propToCol(s));h.editor===y.editors.DropdownEditor&&void 0===h.strict&&(h.filter=!1,h.strict=!0)}),v("dropdown",q)},{autocompleteEditor:31,browser:23,editors:29}],35:[function(N,z,G){Object.defineProperties(G,{HandsontableEditor:{get:function(){return Q}},__esModule:{value:!0}});var F,D,J,A,I,R,x,P=(F=N("browser"),F&&F.__esModule&&F||{"default":F})["default"],K=(D=N("helpers/unicode"),D&&D.__esModule&&D||{"default":D}).KEY_CODES,O=(J=N("helpers/object"),J&&J.__esModule&&J||{"default":J}).extend,M=(A=N("helpers/dom/element"),A&&A.__esModule&&A||{"default":A}).setCaretPosition,E=(I=N("helpers/dom/event"),I&&I.__esModule&&I||{"default":I}),L=E.stopImmediatePropagation,H=E.isImmediatePropagationStopped,k=(R=N("editors"),R&&R.__esModule&&R||{"default":R}),q=(k.getEditor,k.registerEditor),j=(x=N("textEditor"),x&&x.__esModule&&x||{"default":x}).TextEditor,Q=j.prototype.extend();Q.prototype.createElements=function(){j.prototype.createElements.apply(this,arguments);var c=document.createElement("DIV");c.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(c),this.htContainer=c,this.assignHooks()},Q.prototype.prepare=function(m,f,u,p,h,d){j.prototype.prepare.apply(this,arguments);var g=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,afterOnCellMouseDown:function(){var i=this.getValue();void 0!==i&&g.setValue(i),g.instance.destroyEditor()}};this.cellProperties.handsontable&&O(c,d.handsontable),this.htOptions=c};var B=function(g){if(!H(g)){var d,l=this.getActiveEditor(),h=l.htEditor.getInstance();if(g.keyCode==K.ARROW_DOWN){if(h.getSelected()||h.flipped){if(h.getSelected()){if(h.flipped){d=h.getSelected()[0]+1}else{if(!h.flipped){var f=h.getSelected()[0],c=h.countRows()-1;d=Math.min(c,f+1)}}}}else{d=0}}else{if(g.keyCode==K.ARROW_UP){if(!h.getSelected()&&h.flipped){d=h.countRows()-1}else{if(h.getSelected()){if(h.flipped){var f=h.getSelected()[0];d=Math.max(0,f-1)}else{var f=h.getSelected()[0];d=f-1}}}}}void 0!==d&&(0>d||h.flipped&&d>h.countRows()-1?h.deselectCell():h.selectCell(d,0),h.getData().length&&(g.preventDefault(),L(g),l.instance.listen(),l.TEXTAREA.focus()))}};Q.prototype.open=function(){this.instance.addHook("beforeKeyDown",B),j.prototype.open.apply(this,arguments),this.htEditor&&this.htEditor.destroy(),this.htEditor=new P(this.htContainer,this.htOptions),this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible"),M(this.TEXTAREA,0,this.TEXTAREA.value.length)},Q.prototype.close=function(){this.instance.removeHook("beforeKeyDown",B),this.instance.listen(),j.prototype.close.apply(this,arguments)},Q.prototype.focus=function(){this.instance.listen(),j.prototype.focus.apply(this,arguments)},Q.prototype.beginEditing=function(d){var c=this.instance.getSettings().onBeginEditing;c&&c()===!1||j.prototype.beginEditing.apply(this,arguments)},Q.prototype.finishEditing=function(d,c){if(this.htEditor&&this.htEditor.isListening()&&this.instance.listen(),this.htEditor&&this.htEditor.getSelected()){var f=this.htEditor.getInstance().getValue();void 0!==f&&this.setValue(f)}return j.prototype.finishEditing.apply(this,arguments)},Q.prototype.assignHooks=function(){var c=this;this.instance.addHook("afterDestroy",function(){c.htEditor&&c.htEditor.destroy()})},q("handsontable",Q)},{browser:23,editors:29,"helpers/dom/element":46,"helpers/dom/event":47,"helpers/object":52,"helpers/unicode":55,textEditor:40}],36:[function(af,L,X){Object.defineProperties(X,{MobileTextEditor:{get:function(){return aa}},__esModule:{value:!0}});var W,U,ab,P,Z,aj,J,ah=((W=af("browser"),W&&W.__esModule&&W||{"default":W})["default"],(U=af("helpers/unicode"),U&&U.__esModule&&U||{"default":U}).KEY_CODES),ac=(ab=af("helpers/dom/event"),ab&&ab.__esModule&&ab||{"default":ab}),ag=ac.stopImmediatePropagation,ae=ac.isImmediatePropagationStopped,V=(P=af("helpers/dom/element"),P&&P.__esModule&&P||{"default":P}),ad=V.addClass,Y=V.getScrollLeft,G=V.getScrollTop,I=V.hasClass,B=V.isChildOf,ai=V.offset,Q=V.outerHeight,ak=V.outerWidth,x=V.removeClass,q=V.setCaretPosition,K=(Z=af("editors"),Z&&Z.__esModule&&Z||{"default":Z}),j=(K.getEditor,K.registerEditor),A=(aj=af("_baseEditor"),aj&&aj.__esModule&&aj||{"default":aj}).BaseEditor,z=(J=af("eventManager"),J&&J.__esModule&&J||{"default":J}).eventManager,aa=A.prototype.extend(),F={},N=function(){this.controls={},this.controls.leftButton=document.createElement("DIV"),this.controls.leftButton.className="leftButton",this.controls.rightButton=document.createElement("DIV"),this.controls.rightButton.className="rightButton",this.controls.upButton=document.createElement("DIV"),this.controls.upButton.className="upButton",this.controls.downButton=document.createElement("DIV"),this.controls.downButton.className="downButton";for(var c in this.controls){this.controls.hasOwnProperty(c)&&this.positionControls.appendChild(this.controls[c])}};aa.prototype.valueChanged=function(){return this.initValue!=this.getValue()},aa.prototype.init=function(){var c=this;this.eventManager=z(this.instance),this.createElements(),this.bindEvents(),this.instance.addHook("afterDestroy",function(){c.destroy()})},aa.prototype.getValue=function(){return this.TEXTAREA.value},aa.prototype.setValue=function(c){this.initValue=c,this.TEXTAREA.value=c},aa.prototype.createElements=function(){this.editorContainer=document.createElement("DIV"),this.editorContainer.className="htMobileEditorContainer",this.cellPointer=document.createElement("DIV"),this.cellPointer.className="cellPointer",this.moveHandle=document.createElement("DIV"),this.moveHandle.className="moveHandle",this.inputPane=document.createElement("DIV"),this.inputPane.className="inputs",this.positionControls=document.createElement("DIV"),this.positionControls.className="positionControls",this.TEXTAREA=document.createElement("TEXTAREA"),ad(this.TEXTAREA,"handsontableInput"),this.inputPane.appendChild(this.TEXTAREA),this.editorContainer.appendChild(this.cellPointer),this.editorContainer.appendChild(this.moveHandle),this.editorContainer.appendChild(this.inputPane),this.editorContainer.appendChild(this.positionControls),N.call(this),document.body.appendChild(this.editorContainer)},aa.prototype.onBeforeKeyDown=function(d){var c=this,f=c.getActiveEditor();if(d.target===f.TEXTAREA&&!ae(d)){switch(d.keyCode){case ah.ENTER:f.close(),d.preventDefault();break;case ah.BACKSPACE:ag(d)}}},aa.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown),ad(this.editorContainer,"active"),x(this.cellPointer,"hidden"),this.updateEditorPosition()},aa.prototype.focus=function(){this.TEXTAREA.focus(),q(this.TEXTAREA,this.TEXTAREA.value.length)},aa.prototype.close=function(){this.TEXTAREA.blur(),this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown),x(this.editorContainer,"active")},aa.prototype.scrollToView=function(){var c=this.instance.getSelectedRange().highlight;this.instance.view.scrollViewport(c)},aa.prototype.hideCellPointer=function(){I(this.cellPointer,"hidden")||ad(this.cellPointer,"hidden")},aa.prototype.updateEditorPosition=function(k,p){if(k&&p){k=parseInt(k,10),p=parseInt(p,10),this.editorContainer.style.top=p+"px",this.editorContainer.style.left=k+"px"}else{var f=this.instance.getSelected(),d=this.instance.getCell(f[0],f[1]);if(F.cellPointer||(F.cellPointer={height:Q(this.cellPointer),width:ak(this.cellPointer)}),F.editorContainer||(F.editorContainer={width:ak(this.editorContainer)}),void 0!==d){var c=this.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer==window?0:Y(this.instance.view.wt.wtOverlays.leftOverlay.holder),h=this.instance.view.wt.wtOverlays.topOverlay.trimmingContainer==window?0:G(this.instance.view.wt.wtOverlays.topOverlay.holder),u=ai(d),g=ak(d),m={x:c,y:h};this.editorContainer.style.top=parseInt(u.top+Q(d)-m.y+F.cellPointer.height,10)+"px",this.editorContainer.style.left=parseInt(window.innerWidth/2-F.editorContainer.width/2,10)+"px",u.left+g/2>parseInt(this.editorContainer.style.left,10)+F.editorContainer.width?this.editorContainer.style.left=window.innerWidth-F.editorContainer.width+"px":u.left+g/2<parseInt(this.editorContainer.style.left,10)+20&&(this.editorContainer.style.left="0px"),this.cellPointer.style.left=parseInt(u.left-F.cellPointer.width/2-ai(this.editorContainer).left+g/2-m.x,10)+"px"}}},aa.prototype.updateEditorData=function(){var d=this.instance.getSelected(),c=this.instance.getDataAtCell(d[0],d[1]);this.row=d[0],this.col=d[1],this.setValue(c),this.updateEditorPosition()},aa.prototype.prepareAndSave=function(){var c;return this.valueChanged()?(c=this.instance.getSettings().trimWhitespace?[[String.prototype.trim.call(this.getValue())]]:[[this.getValue()]],void this.saveValue(c)):!0},aa.prototype.bindEvents=function(){var c=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(d){c.prepareAndSave(),c.instance.selection.transformStart(0,-1,null,!0),c.updateEditorData(),d.preventDefault()}),this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(d){c.prepareAndSave(),c.instance.selection.transformStart(0,1,null,!0),c.updateEditorData(),d.preventDefault()}),this.eventManager.addEventListener(this.controls.upButton,"touchend",function(d){c.prepareAndSave(),c.instance.selection.transformStart(-1,0,null,!0),c.updateEditorData(),d.preventDefault()}),this.eventManager.addEventListener(this.controls.downButton,"touchend",function(d){c.prepareAndSave(),c.instance.selection.transformStart(1,0,null,!0),c.updateEditorData(),d.preventDefault()}),this.eventManager.addEventListener(this.moveHandle,"touchstart",function(d){if(1==d.touches.length){var g=d.touches[0],f={x:c.editorContainer.offsetLeft,y:c.editorContainer.offsetTop},e={x:g.pageX-f.x,y:g.pageY-f.y};c.eventManager.addEventListener(this,"touchmove",function(h){var i=h.touches[0];c.updateEditorPosition(i.pageX-e.x,i.pageY-e.y),c.hideCellPointer(),h.preventDefault()})}}),this.eventManager.addEventListener(document.body,"touchend",function(d){B(d.target,c.editorContainer)||B(d.target,c.instance.rootElement)||c.close()}),this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.leftOverlay.holder,"scroll",function(d){c.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer!=window&&c.hideCellPointer()}),this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.topOverlay.holder,"scroll",function(d){c.instance.view.wt.wtOverlays.topOverlay.trimmingContainer!=window&&c.hideCellPointer()})},aa.prototype.destroy=function(){this.eventManager.clear(),this.editorContainer.parentNode.removeChild(this.editorContainer)},j("mobile",aa)},{_baseEditor:30,browser:23,editors:29,eventManager:41,"helpers/dom/element":46,"helpers/dom/event":47,"helpers/unicode":55}],37:[function(k,v,g){Object.defineProperties(g,{NumericEditor:{get:function(){return q}},__esModule:{value:!0}});var f,d,j,w=(f=k("numeral"),f&&f.__esModule&&f||{"default":f})["default"],h=(d=k("editors"),d&&d.__esModule&&d||{"default":d}).registerEditor,p=(j=k("textEditor"),j&&j.__esModule&&j||{"default":j}).TextEditor,q=function(){$traceurRuntime.superConstructor(m).apply(this,arguments)},m=q;$traceurRuntime.createClass(q,{beginEditing:function(i){if("undefined"==typeof i&&this.originalValue){"undefined"!=typeof this.cellProperties.language&&w.language(this.cellProperties.language);var c=w.languageData().delimiters.decimal;i=(""+this.originalValue).replace(".",c)}$traceurRuntime.superGet(this,m.prototype,"beginEditing").call(this,i)}},{},p),h("numeric",q)},{editors:29,numeral:"numeral",textEditor:40}],38:[function(q,z,j){Object.defineProperties(j,{PasswordEditor:{get:function(){return p}},__esModule:{value:!0}});var g,f,m,A,k=((g=q("browser"),g&&g.__esModule&&g||{"default":g})["default"],(f=q("helpers/dom/element"),f&&f.__esModule&&f||{"default":f}).empty),x=(m=q("editors"),m&&m.__esModule&&m||{"default":m}),y=(x.getEditor,x.registerEditor),w=(A=q("textEditor"),A&&A.__esModule&&A||{"default":A}).TextEditor,p=function(){$traceurRuntime.superConstructor(v).apply(this,arguments)},v=p;$traceurRuntime.createClass(p,{createElements:function(){$traceurRuntime.superGet(this,v.prototype,"createElements").call(this),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,k(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}},{},w),y("password",p)},{browser:23,editors:29,"helpers/dom/element":46,textEditor:40}],39:[function(X,G,N){Object.defineProperties(N,{SelectEditor:{get:function(){return j}},__esModule:{value:!0}});var L,J,Q,H,P,ab,D=(L=X("browser"),L&&L.__esModule&&L||{"default":L})["default"],Z=(J=X("helpers/dom/element"),J&&J.__esModule&&J||{"default":J}),U=Z.addClass,Y=Z.empty,W=Z.fastInnerHTML,K=Z.getComputedStyle,V=Z.getCssTransform,O=Z.getScrollableElement,A=Z.offset,B=Z.outerHeight,z=Z.outerWidth,aa=Z.resetCssTransform,I=(Q=X("helpers/dom/event"),Q&&Q.__esModule&&Q||{"default":Q}).stopImmediatePropagation,ac=(H=X("helpers/unicode"),H&&H.__esModule&&H||{"default":H}).KEY_CODES,q=(P=X("editors"),P&&P.__esModule&&P||{"default":P}),k=(q.getEditor,q.registerEditor),F=(ab=X("_baseEditor"),ab&&ab.__esModule&&ab||{"default":ab}).BaseEditor,j=F.prototype.extend();j.prototype.init=function(){this.select=document.createElement("SELECT"),U(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement.appendChild(this.select),this.registerHooks()},j.prototype.registerHooks=function(){var c=this;this.instance.addHook("afterScrollHorizontally",function(){return c.refreshDimensions()}),this.instance.addHook("afterScrollVertically",function(){return c.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){return c.refreshDimensions()}),this.instance.addHook("afterRowResize",function(){return c.refreshDimensions()})},j.prototype.prepare=function(){F.prototype.prepare.apply(this,arguments);var d,c=this.cellProperties.selectOptions;d="function"==typeof c?this.prepareOptions(c(this.row,this.col,this.prop)):this.prepareOptions(c),Y(this.select);for(var g in d){if(d.hasOwnProperty(g)){var f=document.createElement("OPTION");f.value=g,W(f,d[g]),this.select.appendChild(f)}}},j.prototype.prepareOptions=function(d){var c={};if(Array.isArray(d)){for(var g=0,f=d.length;f>g;g++){c[d[g]]=d[g]}}else{"object"==typeof d&&(c=d)}return c},j.prototype.getValue=function(){return this.select.value},j.prototype.setValue=function(c){this.select.value=c};var x=function(f){var c=this,h=c.getActiveEditor();switch(f.keyCode){case ac.ARROW_UP:var g=h.select.selectedIndex-1;g>=0&&(h.select[g].selected=!0),I(f),f.preventDefault();break;case ac.ARROW_DOWN:var d=h.select.selectedIndex+1;d<=h.select.length-1&&(h.select[d].selected=!0),I(f),f.preventDefault()}};j.prototype.open=function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.instance.addHook("beforeKeyDown",x)},j.prototype.close=function(){this._opened=!1,this.select.style.display="none",this.instance.removeHook("beforeKeyDown",x)},j.prototype.focus=function(){this.select.focus()},j.prototype.refreshDimensions=function(){if(this.state===D.EditorState.EDITING){if(this.TD=this.getEditedCell(),!this.TD){return void this.close()}var w,M=z(this.TD)+1,m=B(this.TD)+1,g=A(this.TD),f=A(this.instance.rootElement),u=O(this.TD),R=g.top-f.top-1-(u.scrollTop||0),p=g.left-f.left-1-(u.scrollLeft||0),E=this.checkEditorSection(),C=this.instance.getSettings();C.rowHeaders?1:0,C.colHeaders?1:0;switch(E){case"top":w=V(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":w=V(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":w=V(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":w=V(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":w=V(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}0===this.instance.getSelected()[0]&&(R+=1),0===this.instance.getSelected()[1]&&(p+=1);var v=this.select.style;w&&-1!=w?v[w[0]]=w[1]:aa(this.select);var y=K(this.TD);parseInt(y.borderTopWidth,10)>0&&(m-=1),parseInt(y.borderLeftWidth,10)>0&&(M-=1),v.height=m+"px",v.minWidth=M+"px",v.top=R+"px",v.left=p+"px",v.margin="0px"}},j.prototype.getEditedCell=function(){var d,c=this.checkEditorSection();switch(c){case"top":d=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=101;break;case"corner":d=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=103;break;case"left":d=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=102;break;default:d=this.instance.getCell(this.row,this.col),this.select.style.zIndex=""}return -1!=d&&-2!=d?d:void 0},k("select",j)},{_baseEditor:30,browser:23,editors:29,"helpers/dom/element":46,"helpers/dom/event":47,"helpers/unicode":55}],40:[function(ap,ac,ah){Object.defineProperties(ah,{TextEditor:{get:function(){return G}},__esModule:{value:!0}});var ag,ae,al,ad,aj,au,ab,ar,am=(ag=ap("browser"),ag&&ag.__esModule&&ag||{"default":ag})["default"],aq=(ae=ap("helpers/dom/element"),ae&&ae.__esModule&&ae||{"default":ae}),ao=aq.addClass,af=aq.getCaretPosition,an=aq.getComputedStyle,ai=aq.getCssTransform,Z=aq.getScrollableElement,aa=aq.getScrollbarWidth,X=aq.innerWidth,at=aq.offset,V=aq.resetCssTransform,av=aq.setCaretPosition,z=aq.hasVerticalScrollbar,q=aq.hasHorizontalScrollbar,Q=(al=ap("autoResize"),al&&al.__esModule&&al||{"default":al})["default"],j=(ad=ap("_baseEditor"),ad&&ad.__esModule&&ad||{"default":ad}).BaseEditor,I=(aj=ap("eventManager"),aj&&aj.__esModule&&aj||{"default":aj}).eventManager,F=(au=ap("editors"),au&&au.__esModule&&au||{"default":au}),ak=(F.getEditor,F.registerEditor),K=(ab=ap("helpers/unicode"),ab&&ab.__esModule&&ab||{"default":ab}).KEY_CODES,U=(ar=ap("helpers/dom/event"),ar&&ar.__esModule&&ar||{"default":ar}),W=U.stopPropagation,Y=U.stopImmediatePropagation,B=U.isImmediatePropagationStopped,G=j.prototype.extend();G.prototype.init=function(){var c=this;this.createElements(),this.eventManager=I(this),this.bindEvents(),this.autoResize=Q(),this.instance.addHook("afterDestroy",function(){c.destroy()})},G.prototype.getValue=function(){return this.TEXTAREA.value},G.prototype.setValue=function(c){this.TEXTAREA.value=c};var J=function(k){var p,f=this,d=f.getActiveEditor();if(p=(k.ctrlKey||k.metaKey)&&!k.altKey,k.target===d.TEXTAREA&&!B(k)){if(17===k.keyCode||224===k.keyCode||91===k.keyCode||93===k.keyCode){return void Y(k)}switch(k.keyCode){case K.ARROW_RIGHT:d.isInFullEditMode()&&(!d.isWaiting()&&!d.allowKeyEventPropagation||!d.isWaiting()&&d.allowKeyEventPropagation&&!d.allowKeyEventPropagation(k.keyCode))&&Y(k);break;case K.ARROW_LEFT:d.isInFullEditMode()&&(!d.isWaiting()&&!d.allowKeyEventPropagation||!d.isWaiting()&&d.allowKeyEventPropagation&&!d.allowKeyEventPropagation(k.keyCode))&&Y(k);break;case K.ARROW_UP:case K.ARROW_DOWN:d.isInFullEditMode()&&(!d.isWaiting()&&!d.allowKeyEventPropagation||!d.isWaiting()&&d.allowKeyEventPropagation&&!d.allowKeyEventPropagation(k.keyCode))&&Y(k);break;case K.ENTER:var c=d.instance.getSelected(),h=!(c[0]===c[2]&&c[1]===c[3]);if(p&&!h||k.altKey){if(d.isOpened()){var u=af(d.TEXTAREA),g=d.getValue(),m=g.slice(0,u)+"\n"+g.slice(u);d.setValue(m),av(d.TEXTAREA,u+1)}else{d.beginEditing(d.originalValue+"\n")}Y(k)}k.preventDefault();break;case K.A:case K.X:case K.C:case K.V:p&&Y(k);break;case K.BACKSPACE:case K.DELETE:case K.HOME:case K.END:Y(k)}-1===[K.ARROW_UP,K.ARROW_RIGHT,K.ARROW_DOWN,K.ARROW_LEFT].indexOf(k.keyCode)&&d.autoResize.resize(String.fromCharCode(k.keyCode))}};G.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",J)},G.prototype.close=function(c){this.textareaParentStyle.display="none",this.autoResize.unObserve(),document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",J)},G.prototype.focus=function(){this.TEXTAREA.focus(),av(this.TEXTAREA,this.TEXTAREA.value.length)},G.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA"),ao(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),ao(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var c=this;this.instance._registerTimeout(setTimeout(function(){c.refreshDimensions()},0))},G.prototype.getEditedCell=function(){var d,c=this.checkEditorSection();switch(c){case"top":d=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=101;break;case"top-left-corner":d=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"bottom-left-corner":d=this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"left":d=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;case"bottom":d=this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;default:d=this.instance.getCell(this.row,this.col),this.textareaParentStyle.zIndex=""}return -1!=d&&-2!=d?d:void 0},G.prototype.refreshDimensions=function(){if(this.state===am.EditorState.EDITING){if(this.TD=this.getEditedCell(),!this.TD){return void this.close(!0)}var aF,N=at(this.TD),aA=at(this.instance.rootElement),az=Z(this.TD),aw=this.instance.countRows(),aD=N.top-aA.top-1-(az.scrollTop||0),S=N.left-aA.left-1-(az.scrollLeft||0),aB=this.instance.getSettings(),aI=(this.instance.hasRowHeaders(),this.instance.hasColHeaders()),C=this.checkEditorSection(),aH=this.TD.style.backgroundColor;switch(C){case"top":aF=ai(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":aF=ai(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":aF=ai(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":aF=ai(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":aF=ai(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}(aI&&0===this.instance.getSelected()[0]||aB.fixedRowsBottom&&this.instance.getSelected()[0]===aw-aB.fixedRowsBottom)&&(aD+=1),0===this.instance.getSelected()[1]&&(S+=1),aF&&-1!=aF?this.textareaParentStyle[aF[0]]=aF[1]:V(this.TEXTAREA_PARENT),this.textareaParentStyle.top=aD+"px",this.textareaParentStyle.left=S+"px";var aG=this.instance.view.wt.wtViewport.rowsRenderCalculator.startPosition,aE=this.instance.view.wt.wtViewport.columnsRenderCalculator.startPosition,ay=this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition(),aJ=this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition(),L=aa(),g=this.TD.offsetTop+aG-aJ,v=this.TD.offsetLeft+aE-ay,m=X(this.TD)-8,aC=z(az)?L:0,y=q(az)?L:0,R=this.instance.view.maximumVisibleElementWidth(v)-9-aC,ax=this.TD.scrollHeight+1,w=Math.max(this.instance.view.maximumVisibleElementHeight(g)-y,23),h=an(this.TD);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor="",this.TEXTAREA.style.backgroundColor=aH?aH:an(this.TEXTAREA).backgroundColor,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(ax,w),maxHeight:w,minWidth:Math.min(m,R),maxWidth:R},!0),this.textareaParentStyle.display="block"}},G.prototype.bindEvents=function(){var c=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(d){W(d)}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(d){W(d)}),this.instance.addHook("afterScrollHorizontally",function(){c.refreshDimensions()}),this.instance.addHook("afterScrollVertically",function(){c.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){c.refreshDimensions(),c.focus()}),this.instance.addHook("afterRowResize",function(){c.refreshDimensions(),c.focus()}),this.instance.addHook("afterDestroy",function(){c.eventManager.destroy()})},G.prototype.destroy=function(){this.eventManager.destroy()},ak("text",G)},{_baseEditor:30,autoResize:"autoResize",browser:23,editors:29,eventManager:41,"helpers/dom/element":46,"helpers/dom/event":47,"helpers/unicode":55}],41:[function(A,F,q){function m(p,H){var f,d,c,h,I,g,u="HOT-TABLE";if(H.isTargetWebComponent=!1,H.realTarget=H.target,g=H.stopImmediatePropagation,H.stopImmediatePropagation=function(){g.apply(this),k(this)},!E.eventManager.isHotTableEnv){return H}for(H=x(H),I=H.path?H.path.length:0;I--;){if(H.path[I].nodeName===u){f=!0}else{if(f&&H.path[I].shadowRoot){h=H.path[I];break}}0!==I||h||(h=H.path[I])}return h||(h=H.target),H.isTargetWebComponent=!0,z()?H.realTarget=H.srcElement||H.toElement:(p instanceof E.Core||p instanceof Walkontable)&&(p instanceof E.Core?d=p.view?p.view.wt.wtTable.TABLE:null:p instanceof Walkontable&&(d=p.wtTable.TABLE.parentNode.parentNode),c=B(H.target,[u],d),c?H.realTarget=d.querySelector(u)||H.target:H.realTarget=H.target),Object.defineProperty(H,"target",{get:function(){return x(h)},enumerable:!0,configurable:!0}),H}function j(c){return new y(c)}Object.defineProperties(q,{EventManager:{get:function(){return y}},eventManager:{get:function(){return j}},__esModule:{value:!0}});var w,G,v,D,E=(w=A("browser"),w&&w.__esModule&&w||{"default":w})["default"],C=(G=A("helpers/dom/element"),G&&G.__esModule&&G||{"default":G}),x=C.polymerWrap,B=C.closest,z=(v=A("helpers/feature"),v&&v.__esModule&&v||{"default":v}).isWebComponentSupportedNatively,k=(D=A("helpers/dom/event"),D&&D.__esModule&&D||{"default":D}).stopImmediatePropagation,y=function(){var c=void 0!==arguments[0]?arguments[0]:null;this.context=c||this,this.context.eventListeners||(this.context.eventListeners=[])};$traceurRuntime.createClass(y,{addEventListener:function(h,d,l){function g(i){i=m(f,i),l.call(this,i)}var c=this,f=this.context;return this.context.eventListeners.push({element:h,event:d,callback:l,callbackProxy:g}),window.addEventListener?h.addEventListener(d,g,!1):h.attachEvent("on"+d,g),E.countEventManagerListeners++,function(){c.removeEventListener(h,d,l)}},removeEventListener:function(f,c,h){for(var g,d=this.context.eventListeners.length;d--;){if(g=this.context.eventListeners[d],g.event==c&&g.element==f){if(h&&h!=g.callback){continue}this.context.eventListeners.splice(d,1),g.element.removeEventListener?g.element.removeEventListener(g.event,g.callbackProxy,!1):g.element.detachEvent("on"+g.event,g.callbackProxy),E.countEventManagerListeners--}}},clearEvents:function(){if(this.context){for(var d=this.context.eventListeners.length;d--;){var c=this.context.eventListeners[d];c&&this.removeEventListener(c.element,c.event,c.callback)}}},clear:function(){this.clearEvents()},destroy:function(){this.clearEvents(),this.context=null},fireEvent:function(d,c){var g,f={bubbles:!0,cancelable:"mousemove"!==c,view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};document.createEvent?(g=document.createEvent("MouseEvents"),g.initMouseEvent(c,f.bubbles,f.cancelable,f.view,f.detail,f.screenX,f.screenY,f.clientX,f.clientY,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey,f.button,f.relatedTarget||document.body.parentNode)):g=document.createEventObject(),d.dispatchEvent?d.dispatchEvent(g):d.fireEvent("on"+c,g)}},{}),E.countEventManagerListeners=0,E.eventManager=j},{browser:23,"helpers/dom/element":46,"helpers/dom/event":47,"helpers/feature":48}],42:[function(A,F,q){function m(d){for(var c=0,f=d.length;f>c;){d[c]=[d[c]],c++}}function j(d,c){for(var g=0,f=c.length;f>g;){d.push(c[g]),g++}}function w(g){var d=[];if(!g||0===g.length||!g[0]||0===g[0].length){return d}for(var l=g.length,h=g[0].length,f=0;l>f;f++){for(var c=0;h>c;c++){d[c]||(d[c]=[]),d[c][f]=g[f][c]}}return d}function G(g,d,l,h){var f=-1,c=g.length;for(h&&c&&(l=g[++f]);++f<c;){l=d(l,g[f],f,g)}return l}function v(h,d){for(var p=-1,l=h.length,g=-1,c=[];++p<l;){var f=h[p];d(f,p,h)&&(c[++g]=f)}return c}function D(h,d){for(var p=-1,l=h.length,g=-1,c=[];++p<l;){var f=h[p];c[++g]=d(f,p,h)}return c}function E(d,c){for(var g=-1,f=d.length;++g<f&&c(d[g],g,d)!==!1;){}return d}function C(c){return G(c,function(f,d){return f+d},0)}function x(c){return G(c,function(f,d){return f>d?f:d},Array.isArray(c)?c[0]:void 0)}function B(c){return G(c,function(f,d){return d>f?f:d},Array.isArray(c)?c[0]:void 0)}function z(c){return c.length?C(c)/c.length:0}function k(c){return G(c,function(f,d){return f.concat(Array.isArray(d)?k(d):d)},[])}function y(d){var c=[];return E(d,function(f){-1===c.indexOf(f)&&c.push(f)}),c}Object.defineProperties(q,{to2dArray:{get:function(){return m}},extendArray:{get:function(){return j}},pivot:{get:function(){return w}},arrayReduce:{get:function(){return G}},arrayFilter:{get:function(){return v}},arrayMap:{get:function(){return D}},arrayEach:{get:function(){return E}},arraySum:{get:function(){return C}},arrayMax:{get:function(){return x}},arrayMin:{get:function(){return B}},arrayAvg:{get:function(){return z}},arrayFlatten:{get:function(){return k}},arrayUnique:{get:function(){return y}},__esModule:{value:!0}})},{}],43:[function(p,x,g){function f(){return v}function d(){return w}function k(){return q}function y(){return m}function j(c){return c||(c=navigator.userAgent),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(c)}Object.defineProperties(g,{isIE8:{get:function(){return f}},isIE9:{get:function(){return d}},isSafari:{get:function(){return k}},isChrome:{get:function(){return y}},isMobileBrowser:{get:function(){return j}},__esModule:{value:!0}});var v=!document.createTextNode("test").textContent,w=!!document.documentMode,q=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor),m=/Chrome/.test(navigator.userAgent)&&/Google/.test(navigator.vendor)},{}],44:[function(q,z,j){function g(d){for(var c,i=d+1,h="";i>0;){c=(i-1)%26,h=String.fromCharCode(65+c)+h,i=parseInt((i-c)/26,10)}return h}function f(o,d){o="number"==typeof o?o:100,d="number"==typeof d?d:4;var u,l,c=[];for(u=0;o>u;u++){var h=[];for(l=0;d>l;l++){h.push(g(l)+(u+1))}c.push(h)}return c}function m(o,d){o="number"==typeof o?o:100,d="number"==typeof d?d:4;var u,l,c=[];for(u=0;o>u;u++){var h={};for(l=0;d>l;l++){h["prop"+l]=g(l)+(u+1)}c.push(h)}return c}function A(l,d){for(var u,s=[],h=0;l>h;h++){u=[];for(var c=0;d>c;c++){u.push("")}s.push(u)}return s}function k(u){var d,C,B,l,c=[],h=0;for(d=0,C=u.length;C>d;d++){for(B=0,l=u[d].length;l>B;B++){B==h&&(c.push([]),h++),c[B].push(u[d][B])}}return c}function x(d,c){function h(l){var i=p.cellTypes[l];if("undefined"==typeof i){throw new Error('You declared cell type "'+l+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes')}return i}return c="undefined"==typeof c?!0:c,function(n,l){return function e(s){if(s){if(s.hasOwnProperty(d)&&void 0!==s[d]){return s[d]}if(s.hasOwnProperty("type")&&s.type){var i;if("string"!=typeof s.type){throw new Error("Cell type must be a string ")}if(i=h(s.type),i.hasOwnProperty(d)){return i[d]}if(c){return}}return e(v(s))}}("number"==typeof n?this.getCellMeta(n,l):n)}}Object.defineProperties(j,{spreadsheetColumnLabel:{get:function(){return g}},createSpreadsheetData:{get:function(){return f}},createSpreadsheetObjectData:{get:function(){return m}},createEmptySpreadsheetData:{get:function(){return A}},translateRowsToColumns:{get:function(){return k}},cellMethodLookupFactory:{get:function(){return x}},__esModule:{value:!0}});var y,w,p=(y=q("browser"),y&&y.__esModule&&y||{"default":y})["default"],v=(w=q("object"),w&&w.__esModule&&w||{"default":w}).getPrototypeOf},{browser:23,object:52}],45:[function(d,c,g){function f(i){var h=new Date(i);return isNaN(new Date(i+"T00:00").getDate())?h:new Date(h.getTime()+60000*h.getTimezoneOffset())}Object.defineProperties(g,{getNormalizedDate:{get:function(){return f}},__esModule:{value:!0}})},{}],46:[function(a6,aR,aX){function aW(d,c,f){for(;null!=d&&d!==f;){if(d.nodeType===Node.ELEMENT_NODE&&(c.indexOf(d.nodeName)>-1||c.indexOf(d)>-1)){return d}d=d.host&&d.nodeType===Node.DOCUMENT_FRAGMENT_NODE?d.host:d.parentNode}return null}function aT(d,c){var g=d.parentNode,f=[];for("string"==typeof c?f=Array.prototype.slice.call(document.querySelectorAll(c),0):f.push(c);null!=g;){if(f.indexOf(g)>-1){return !0}g=g.parentNode}return !1}function a2(f){function c(i){return i.nodeType===Node.ELEMENT_NODE&&i.nodeName===g.toUpperCase()}var h,g="hot-table",d=!1;for(h=aS(f);null!=h;){if(c(h)){d=!0;break}if(h.host&&h.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(d=c(h.host)){break}h=h.host}h=h.parentNode}return d}function aS(c){return"undefined"!=typeof Polymer&&"function"==typeof wrap?wrap(c):c}function aZ(c){return"undefined"!=typeof Polymer&&"function"==typeof unwrap?unwrap(c):c}function bb(d){var c=0;if(d.previousSibling){for(;d=d.previousSibling;){++c}}return c}function aQ(d,c){var f=document.querySelector(".ht_clone_"+d);return f?f.contains(c):null}function a8(d){var c=0,f=[];if(!d||!d.length){return f}for(;d[c];){f.push(d[c]),c++}return f}function a3(d,c){return at(d,c)}function a7(d,c){return aU(d,c)}function a5(d,c){return ab(d,c)}function aV(d,c){if(3===d.nodeType){c.removeChild(d)}else{if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(d.nodeName)>-1){for(var g=d.childNodes,f=g.length-1;f>=0;f--){aV(g[f],d)}}}}function a4(d){for(var c;c=d.lastChild;){d.removeChild(c)}}function aY(d,c){aI.test(c)?d.innerHTML=c:aO(d,c)}function aO(d,c){var f=d.firstChild;f&&3===f.nodeType&&null===f.nextSibling?aA?f.textContent=c:f.data=c:(a4(d),d.appendChild(document.createTextNode(c)))}function aP(d){for(var c=d;aZ(c)!==document.documentElement;){if(null===c){return !1}if(c.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(c.host){if(c.host.impl){return aP(c.host.impl)}if(c.host){return aP(c.host)}throw new Error("Lost in Web Components world")}return !1}if("none"===c.style.display){return !1}c=c.parentNode}return !0}function aL(g){var d,j,h,f,c;if(f=document.documentElement,aa()&&g.firstChild&&"CAPTION"===g.firstChild.nodeName){return c=g.getBoundingClientRect(),{top:c.top+(window.pageYOffset||f.scrollTop)-(f.clientTop||0),left:c.left+(window.pageXOffset||f.scrollLeft)-(f.clientLeft||0)}}for(d=g.offsetLeft,j=g.offsetTop,h=g;(g=g.offsetParent)&&g!==document.body;){d+=g.offsetLeft,j+=g.offsetTop,h=g}return h&&"fixed"===h.style.position&&(d+=window.pageXOffset||f.scrollLeft,j+=window.pageYOffset||f.scrollTop),{left:d,top:j}}function a9(){var c=window.scrollY;return void 0===c&&(c=document.documentElement.scrollTop),c}function aC(){var c=window.scrollX;return void 0===c&&(c=document.documentElement.scrollLeft),c}function bc(c){return c===window?a9():c.scrollTop}function al(c){return c===window?aC():c.scrollLeft}function ak(j){for(var p,f,d,c=j.parentNode,h=["auto","scroll"],q="",g="",k="",m="";c&&c.style&&document.body!==c;){if(p=c.style.overflow,f=c.style.overflowX,d=c.style.overflowY,"scroll"==p||"scroll"==f||"scroll"==d){return c}if(window.getComputedStyle&&(q=window.getComputedStyle(c),g=q.getPropertyValue("overflow"),k=q.getPropertyValue("overflow-y"),m=q.getPropertyValue("overflow-x"),"scroll"===g||"scroll"===m||"scroll"===k)){return c}if(c.clientHeight<=c.scrollHeight&&(-1!==h.indexOf(d)||-1!==h.indexOf(p)||-1!==h.indexOf(g)||-1!==h.indexOf(k))){return c}if(c.clientWidth<=c.scrollWidth&&(-1!==h.indexOf(f)||-1!==h.indexOf(p)||-1!==h.indexOf(g)||-1!==h.indexOf(m))){return c}c=c.parentNode}return window}function az(d){for(var c=d.parentNode;c&&c.style&&document.body!==c;){if("visible"!==c.style.overflow&&""!==c.style.overflow){return c}if(window.getComputedStyle){var f=window.getComputedStyle(c);if("visible"!==f.getPropertyValue("overflow")&&""!==f.getPropertyValue("overflow")){return c}}c=c.parentNode}return window}function aj(d,c){if(d){if(d!==window){var g,f=d.style[c];return""!==f&&void 0!==f?f:(g=aq(d),""!==g[c]&&void 0!==g[c]?g[c]:void 0)}if("width"===c){return window.innerWidth+"px"}if("height"===c){return window.innerHeight+"px"}}}function aq(c){return c.currentStyle||document.defaultView.getComputedStyle(c)}function ao(c){return c.offsetWidth}function a0(c){return aa()&&c.firstChild&&"CAPTION"===c.firstChild.nodeName?c.offsetHeight+c.firstChild.offsetHeight:c.offsetHeight}function aw(c){return c.clientHeight||c.innerHeight}function aB(c){return c.clientWidth||c.innerWidth}function aE(d,c,f){window.addEventListener?d.addEventListener(c,f,!1):d.attachEvent("on"+c,f)}function aN(d,c,f){window.removeEventListener?d.removeEventListener(c,f,!1):d.detachEvent("on"+c,f)}function an(d){if(d.selectionStart){return d.selectionStart}if(document.selection){d.focus();var c=document.selection.createRange();if(null==c){return 0}var g=d.createTextRange(),f=g.duplicate();return g.moveToBookmark(c.getBookmark()),f.setEndPoint("EndToStart",g),f.text.length}return 0}function ap(d){if(d.selectionEnd){return d.selectionEnd}if(document.selection){var c=document.selection.createRange();if(null==c){return 0}var f=d.createTextRange();return f.text.indexOf(c.text)+c.text.length}}function ar(){var c="";return window.getSelection?c=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(c=document.selection.createRange().text),c}function ag(h,d,k){if(void 0===k&&(k=d),h.setSelectionRange){h.focus();try{h.setSelectionRange(d,k)}catch(j){var g=h.parentNode,c=g.style.display;g.style.display="block",h.setSelectionRange(d,k),g.style.display=c}}else{if(h.createTextRange){var f=h.createTextRange();f.collapse(!0),f.moveEnd("character",k),f.moveStart("character",d),f.select()}}}function av(){var d=document.createElement("p");d.style.width="100%",d.style.height="200px";var c=document.createElement("div");c.style.position="absolute",c.style.top="0px",c.style.left="0px",c.style.visibility="hidden",c.style.width="200px",c.style.height="150px",c.style.overflow="hidden",c.appendChild(d),(document.body||document.documentElement).appendChild(c);var g=d.offsetWidth;c.style.overflow="scroll";var f=d.offsetWidth;return g==f&&(f=c.clientWidth),(document.body||document.documentElement).removeChild(c),g-f}function a1(){return void 0===aF&&(aF=av()),aF}function ah(c){return c.offsetWidth!==c.clientWidth}function ay(c){return c.offsetHeight!==c.clientHeight}function aD(d,c,f){am()||ba()?(d.style.top=f,d.style.left=c):af()?d.style["-webkit-transform"]="translate3d("+c+","+f+",0)":d.style.transform="translate3d("+c+","+f+",0)"}function aK(d){var c;return d.style.transform&&""!==(c=d.style.transform)?["transform",c]:d.style["-webkit-transform"]&&""!==(c=d.style["-webkit-transform"])?["-webkit-transform",c]:-1}function ac(c){c.style.transform&&""!==c.style.transform?c.style.transform="":c.style["-webkit-transform"]&&""!==c.style["-webkit-transform"]&&(c.style["-webkit-transform"]="")}function ai(d){var c=["INPUT","SELECT","TEXTAREA"];return d&&(c.indexOf(d.nodeName)>-1||"true"===d.contentEditable)}function ax(c){return ai(c)&&-1==c.className.indexOf("handsontableInput")&&-1==c.className.indexOf("copyPaste")}Object.defineProperties(aX,{closest:{get:function(){return aW}},isChildOf:{get:function(){return aT}},isChildOfWebComponentTable:{get:function(){return a2}},polymerWrap:{get:function(){return aS}},polymerUnwrap:{get:function(){return aZ}},index:{get:function(){return bb}},overlayContainsElement:{get:function(){return aQ}},hasClass:{get:function(){return a3}},addClass:{get:function(){return a7}},removeClass:{get:function(){return a5}},removeTextNodes:{get:function(){return aV}},empty:{get:function(){return a4}},HTML_CHARACTERS:{get:function(){return aI}},fastInnerHTML:{get:function(){return aY}},fastInnerText:{get:function(){return aO}},isVisible:{get:function(){return aP}},offset:{get:function(){return aL}},getWindowScrollTop:{get:function(){return a9}},getWindowScrollLeft:{get:function(){return aC}},getScrollTop:{get:function(){return bc}},getScrollLeft:{get:function(){return al}},getScrollableElement:{get:function(){return ak}},getTrimmingContainer:{get:function(){return az}},getStyle:{get:function(){return aj}},getComputedStyle:{get:function(){return aq}},outerWidth:{get:function(){return ao}},outerHeight:{get:function(){return a0}},innerHeight:{get:function(){return aw}},innerWidth:{get:function(){return aB}},addEvent:{get:function(){return aE}},removeEvent:{get:function(){return aN}},getCaretPosition:{get:function(){return an}},getSelectionEndPosition:{get:function(){return ap}},getSelectionText:{get:function(){return ar}},setCaretPosition:{get:function(){return ag}},getScrollbarWidth:{get:function(){return a1}},hasVerticalScrollbar:{get:function(){return ah}},hasHorizontalScrollbar:{get:function(){return ay}},setOverlayPosition:{get:function(){return aD}},getCssTransform:{get:function(){return aK}},resetCssTransform:{get:function(){return ac}},isInput:{get:function(){return ai}},isOutsideInput:{get:function(){return ax}},__esModule:{value:!0}});var aG,ad,at,aU,ab,au=(aG=a6("../browser"),aG&&aG.__esModule&&aG||{"default":aG}),am=au.isIE8,ba=au.isIE9,af=au.isSafari,aa=(ad=a6("../feature"),ad&&ad.__esModule&&ad||{"default":ad}).hasCaptionProblem,aJ=!!document.documentElement.classList;if(aJ){var aM=function(){var c=document.createElement("div");return c.classList.add("test","test2"),c.classList.contains("test2")}();at=function(d,c){return""===c?!1:d.classList.contains(c)},aU=function(d,c){var f=0;if("string"==typeof c&&(c=c.split(" ")),c=a8(c),aM){d.classList.add.apply(d.classList,c)}else{for(;c&&c[f];){d.classList.add(c[f]),f++}}},ab=function(d,c){var f=0;if("string"==typeof c&&(c=c.split(" ")),c=a8(c),aM){d.classList.remove.apply(d.classList,c)}else{for(;c&&c[f];){d.classList.remove(c[f]),f++}}}}else{var aH=function(c){return new RegExp("(\\s|^)"+c+"(\\s|$)")};at=function(d,c){return !!d.className.match(aH(c))},aU=function(d,c){var g=0,f=d.className;if("string"==typeof c&&(c=c.split(" ")),""===f){f=c.join(" ")}else{for(;c&&c[g];){aH(c[g]).test(f)||(f+=" "+c[g]),g++}}d.className=f},ab=function(d,c){var g=0,f=d.className;for("string"==typeof c&&(c=c.split(" "));c&&c[g];){f=f.replace(aH(c[g])," ").trim(),g++}d.className!==f&&(d.className=f)}}var aF,aI=/(<(.*)>|&(.*);)/,aA=!!document.createTextNode("test").textContent},{"../browser":43,"../feature":48}],47:[function(p,x,g){function f(c){c.isImmediatePropagationEnabled=!1,c.cancelBubble=!0}function d(c){return c.isImmediatePropagationEnabled===!1}function k(c){"function"==typeof c.stopPropagation?c.stopPropagation():c.cancelBubble=!0}function y(c){return c.pageX?c.pageX:c.clientX+m()}function j(c){return c.pageY?c.pageY:c.clientY+q()}Object.defineProperties(g,{stopImmediatePropagation:{get:function(){return f}},isImmediatePropagationStopped:{get:function(){return d}},stopPropagation:{get:function(){return k}},pageX:{get:function(){return y}},pageY:{get:function(){return j}},__esModule:{value:!0}});var v,w=(v=p("element"),v&&v.__esModule&&v||{"default":v}),q=w.getWindowScrollTop,m=w.getWindowScrollLeft},{element:46}],48:[function(C,H,v){function q(c){return D.call(window,c)}function j(c){B.call(window,c)}function y(){return"ontouchstart" in window}function I(){var c=document.createElement("div");return !(!c.createShadowRoot||!c.createShadowRoot.toString().match(/\[native code\]/))}function x(){var d=document.createElement("TABLE");d.style.borderSpacing=0,d.style.borderWidth=0,d.style.padding=0;var c=document.createElement("TBODY");d.appendChild(c),c.appendChild(document.createElement("TR")),c.firstChild.appendChild(document.createElement("TD")),c.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var f=document.createElement("CAPTION");f.innerHTML="c<br>c<br>c<br>c",f.style.padding=0,f.style.margin=0,d.insertBefore(f,c),document.body.appendChild(d),A=d.offsetHeight<2*d.lastChild.offsetHeight,document.body.removeChild(d)}function F(){return void 0===A&&x(),A}function G(d){var c=void 0!==arguments[1]?arguments[1]:{};return w?w:w="object"==typeof Intl?new Intl.Collator(d,c).compare:"function"==typeof String.prototype.localeCompare?function(g,f){return(g+"").localeCompare(f)}:function(g,f){return g===f?0:g>f?-1:1}}Object.defineProperties(v,{requestAnimationFrame:{get:function(){return q}},cancelAnimationFrame:{get:function(){return j}},isTouchSupported:{get:function(){return y}},isWebComponentSupportedNatively:{get:function(){return I}},hasCaptionProblem:{get:function(){return F}},getComparisonFunction:{get:function(){return G}},__esModule:{value:!0}});for(var E=0,z=["ms","moz","webkit","o"],D=window.requestAnimationFrame,B=window.cancelAnimationFrame,k=0;k<z.length&&!D;++k){D=window[z[k]+"RequestAnimationFrame"],B=window[z[k]+"CancelAnimationFrame"]||window[z[k]+"CancelRequestAnimationFrame"]}D||(D=function(d){var c=(new Date).getTime(),g=Math.max(0,16-(c-E)),f=window.setTimeout(function(){d(c+g)},g);return E=c+g,f}),B||(B=function(c){clearTimeout(c)});var A,w},{}],49:[function(q,z,j){function g(d,c){return function(){return d.apply(c,arguments)}}function f(l){function d(){var o=this,r=arguments,i=Date.now(),e=!1;h.lastCallThrottled=!0,s||(s=i,e=!0);var n=u-(i-s);return e?(h.lastCallThrottled=!1,l.apply(this,r)):(c&&clearTimeout(c),c=setTimeout(function(){h.lastCallThrottled=!1,l.apply(o,r),s=0,c=void 0},n)),h}var u=void 0!==arguments[1]?arguments[1]:200,s=0,h={lastCallThrottled:!0},c=null;return d}function m(u){function h(){c=d}function C(){return c?(c--,u.apply(this,arguments)):r.apply(this,arguments)}var B=void 0!==arguments[1]?arguments[1]:200,d=void 0!==arguments[2]?arguments[2]:10,r=f(u,B),c=d;return C.clearHits=h,C}function A(h){function c(){var n=this,e=arguments;return d&&clearTimeout(d),d=setTimeout(function(){l=h.apply(n,e)},i),l}var l,i=void 0!==arguments[1]?arguments[1]:200,d=null;return c}function k(){for(var h=[],c=0;c<arguments.length;c++){h[c]=arguments[c]}var l=h,i=l[0],d=Array.prototype.slice.call(l,1);return function(){return v(d,function(o,n){return n(o)},i.apply(this,arguments))}}function x(d){for(var c=[],h=1;h<arguments.length;h++){c[h-1]=arguments[h]}return function(){for(var i=[],e=0;e<arguments.length;e++){i[e]=arguments[e]}return d.apply(this,c.concat(i))}}function y(d){function c(e){return function(){for(var u=[],o=0;o<arguments.length;o++){u[o]=arguments[o]}var t,n=e.concat(u);return t=n.length>=h?d.apply(this,n):c(n)}}var h=d.length;return c([])}function w(d){function c(e){return function(){for(var u=[],o=0;o<arguments.length;o++){u[o]=arguments[o]}var t,n=e.concat(u.reverse());return t=n.length>=h?d.apply(this,n):c(n)}}var h=d.length;return c([])}Object.defineProperties(j,{proxy:{get:function(){return g}},throttle:{get:function(){return f}},throttleAfterHits:{get:function(){return m}},debounce:{get:function(){return A}},pipe:{get:function(){return k}},partial:{get:function(){return x}},curry:{get:function(){return y}},curryRight:{get:function(){return w}},__esModule:{value:!0}});var p,v=(p=q("array"),p&&p.__esModule&&p||{"default":p}).arrayReduce},{array:42}],50:[function(d,c,g){function f(h){switch(typeof h){case"string":case"number":return h+"";case"object":return null===h?"":h.toString();case"undefined":return"";default:return h.toString()}}Object.defineProperties(g,{stringify:{get:function(){return f}},__esModule:{value:!0}})},{}],51:[function(h,d,k){function j(l){var i=typeof l;return"number"==i?!isNaN(l)&&isFinite(l):"string"==i?l.length?1==l.length?/\d/.test(l):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(l):!1:"object"==i?!(!l||"number"!=typeof l.valueOf()||l instanceof Date):!1}function g(l,i,p){var m=-1;for("function"==typeof i?(p=i,i=l):m=l-1;++m<=i&&p(m)!==!1;){}}function c(l,i,p){var m=l+1;for("function"==typeof i&&(p=i,i=0);--m>=i&&p(m)!==!1;){}}function f(l,i){return i=parseInt(i.toString().replace("%",""),10),i=parseInt(l*i/100)}Object.defineProperties(k,{isNumeric:{get:function(){return j}},rangeEach:{get:function(){return g}},rangeEachReverse:{get:function(){return c}},valueAccordingPercent:{get:function(){return f}},__esModule:{value:!0}})},{}],52:[function(H,q,A){function z(d){var c;return Array.isArray(d)?c=[]:(c={},y(d,function(f,g){f&&"object"==typeof f&&!Array.isArray(f)?c[g]=z(f):Array.isArray(f)?f.length&&"object"==typeof f[0]&&!Array.isArray(f[0])?c[g]=[z(f[0])]:c[g]=[]:c[g]=null})),c}function x(d,c){return c.prototype.constructor=c,d.prototype=new c,d.prototype.constructor=d,d}function D(d,c){return y(c,function(e,f){d[f]=e}),d}function v(d,c){y(c,function(f,e){c[e]&&"object"==typeof c[e]?(d[e]||(Array.isArray(c[e])?d[e]=[]:"[object Date]"===Object.prototype.toString.call(c[e])?d[e]=c[e]:d[e]={}),v(d[e],c[e])):d[e]=c[e]})}function C(c){return"object"==typeof c?JSON.parse(JSON.stringify(c)):c}function K(d){var c={};return y(d,function(f,g){c[g]=f}),c}function k(d){for(var c=[],f=1;f<arguments.length;f++){c[f-1]=arguments[f]}return d.MIXINS||(d.MIXINS=[]),j(c,function(e){d.MIXINS.push(e.MIXIN_NAME),y(e,function(g,l){if(void 0!==d.prototype[l]){throw new Error("Mixin conflict. Property '"+l+"' already exist and cannot be overwritten.")}if("function"==typeof g){d.prototype[l]=g}else{var i=function(o,m){o="_"+o;var p=function(n){return(Array.isArray(n)||E(n))&&(n=C(n)),n};return function(){return void 0===this[o]&&(this[o]=p(m)),this[o]}},h=function(m){return m="_"+m,function(n){this[m]=n}};Object.defineProperty(d.prototype,l,{get:i(l,g),set:h(l),configurable:!0})}})}),d}function J(d,c){return JSON.stringify(d)===JSON.stringify(c)}function E(c){return"[object Object]"==Object.prototype.toString.call(c)}function I(d){var c;if("object"==typeof d.__proto__){c=d.__proto__}else{var g,f=d.constructor;"function"==typeof d.constructor&&(g=f,delete d.constructor&&(f=d.constructor,d.constructor=g)),c=f?f.prototype:null}return c}function G(d,c,g,f){f.value=g,f.writable=f.writable!==!1,f.enumerable=f.enumerable!==!1,f.configurable=f.configurable!==!1,Object.defineProperty(d,c,f)}function y(d,c){for(var f in d){if((!d.hasOwnProperty||d.hasOwnProperty&&d.hasOwnProperty(f))&&c(d[f],f,d)===!1){break}}return d}function F(d,c){var g=c.split("."),f=d;return y(g,function(h){return f=f[h],void 0===f?(f=void 0,!1):void 0}),f}Object.defineProperties(A,{duckSchema:{get:function(){return z}},inherit:{get:function(){return x}},extend:{get:function(){return D}},deepExtend:{get:function(){return v}},deepClone:{get:function(){return C}},clone:{get:function(){return K}},mixin:{get:function(){return k}},isObjectEquals:{get:function(){return J}},isObject:{get:function(){return E}},getPrototypeOf:{get:function(){return I}},defineGetter:{get:function(){return G}},objectEach:{get:function(){return y}},getProperty:{get:function(){return F}},__esModule:{value:!0}});var B,j=(B=H("array"),B&&B.__esModule&&B||{"default":B}).arrayEach},{array:42}],53:[function(g,d,j){function h(l,i){function p(){}c(p,l);for(var m=0,k=i.length;k>m;m++){p.prototype[i[m]]=void 0}return p}Object.defineProperties(j,{columnFactory:{get:function(){return h}},__esModule:{value:!0}});var f,c=(f=g("object"),f&&f.__esModule&&f||{"default":f}).inherit},{object:52}],54:[function(y,D,m){function k(c){return c[0].toUpperCase()+c.substr(1)}function g(d,c){var f=!0;return j(c.length-1,function(e){return d.charAt(e)!==c.charAt(e)?(f=!1,!1):void 0}),f}function v(f,c){var i=!0,h=c.length-1,d=f.length-1;return j(h,function(n){var o=d-n,e=h-n;return f.charAt(o)!==c.charAt(e)?(i=!1,!1):void 0}),i}function E(){for(var f=[],c=0;c<arguments.length;c++){f[c]=arguments[c]}for(var i=[],h=f.length;h--;){var d=x(f[h]).toLowerCase();-1===i.indexOf(d)&&i.push(d)}return 1===i.length}function q(){function c(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return c()+c()+c()+c()}function B(c){return/^([0-9][0-9]?\%$)|(^100\%$)/.test(c)}function C(d){var c=void 0!==arguments[1]?arguments[1]:{};return(d+"").replace(/(?:\\)?\[([^\[\]]+)]/g,function(f,h){return"\\"===f.charAt(0)?f.substr(1,f.length-1):void 0===c[h]?"":c[h]})}function A(l,d){var u=void 0!==arguments[2]?arguments[2]:" ";if(l+="",l.length>=d){return l}u=String(u);var p=u.length;p||(u=" ");var h=d-l.length,c=Math.ceil(h/u.length),f="";return j(c,function(i){f+=u}),f=f.slice(0,h),f+l}Object.defineProperties(m,{toUpperCaseFirst:{get:function(){return k}},startsWith:{get:function(){return g}},endsWith:{get:function(){return v}},equalsIgnoreCase:{get:function(){return E}},randomString:{get:function(){return q}},isPercentValue:{get:function(){return B}},substitute:{get:function(){return C}},padStart:{get:function(){return A}},__esModule:{value:!0}});var w,z,x=(w=y("mixed"),w&&w.__esModule&&w||{"default":w}).stringify,j=(z=y("number"),z&&z.__esModule&&z||{"default":z}).rangeEach},{mixed:50,number:51}],55:[function(j,p,f){function d(i){return 32==i||i>=48&&57>=i||i>=96&&111>=i||i>=186&&192>=i||i>=219&&222>=i||i>=226||i>=65&&90>=i}function c(l){var i=[m.ARROW_DOWN,m.ARROW_UP,m.ARROW_LEFT,m.ARROW_RIGHT,m.HOME,m.END,m.DELETE,m.BACKSPACE,m.F1,m.F2,m.F3,m.F4,m.F5,m.F6,m.F7,m.F8,m.F9,m.F10,m.F11,m.F12,m.TAB,m.PAGE_DOWN,m.PAGE_UP,m.ENTER,m.ESCAPE,m.SHIFT,m.CAPS_LOCK,m.ALT];return -1!==i.indexOf(l)}function h(i){return -1!==[m.CONTROL_LEFT,224,m.COMMAND_LEFT,m.COMMAND_RIGHT].indexOf(i)}function q(l,i){var s=i.split("|"),r=!1;return k(s,function(e){return l===m[e]?(r=!0,!1):void 0}),r}Object.defineProperties(f,{KEY_CODES:{get:function(){return m}},isPrintableChar:{get:function(){return d}},isMetaKey:{get:function(){return c}},isCtrlKey:{get:function(){return h}},isKey:{get:function(){return q}},__esModule:{value:!0}});var g,k=(g=j("array"),g&&g.__esModule&&g||{"default":g}).arrayEach,m={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86}},{array:42}],56:[function(k,v,g){Object.defineProperties(g,{localHooks:{get:function(){return m}},__esModule:{value:!0}});var f,d,j,w=(f=k("browser"),f&&f.__esModule&&f||{"default":f})["default"],h=(d=k("helpers/array"),d&&d.__esModule&&d||{"default":d}).arrayEach,p=(j=k("helpers/object"),j&&j.__esModule&&j||{"default":j}).defineGetter,q="localHooks",m={_localHooks:Object.create(null),addLocalHook:function(i,c){this._localHooks[i]||(this._localHooks[i]=[]),this._localHooks[i].push(c)},runLocalHooks:function(i){for(var c=[],r=1;r<arguments.length;r++){c[r-1]=arguments[r]}var l=this;this._localHooks[i]&&h(this._localHooks[i],function(n){return n.apply(l,c)})},clearLocalHooks:function(){this._localHooks={}}};p(m,"MIXIN_NAME",q,{writable:!1,enumerable:!1}),w.utils.localHooks=m},{browser:23,"helpers/array":42,"helpers/object":52}],57:[function(d,c,g){function f(){function i(l){return null!==l&&!k(l)&&("string"==typeof l||"number"==typeof l)}function h(l){return null!==l&&("object"==typeof l||"function"==typeof l)}function k(l){return l!==l}var j={arrayMap:[],weakMap:new WeakMap};return{get:function(e){return i(e)?j.arrayMap[e]:h(e)?j.weakMap.get(e):void 0},set:function(l,e){if(i(l)){j.arrayMap[l]=e}else{if(!h(l)){throw new Error("Invalid key type")}j.weakMap.set(l,e)}},"delete":function(e){i(e)?delete j.arrayMap[e]:h(e)&&j.weakMap["delete"](e)}}}Object.defineProperties(g,{MultiMap:{get:function(){return f}},__esModule:{value:!0}}),window.MultiMap=f},{}],58:[function(j,m,f){Object.defineProperties(f,{Hooks:{get:function(){return k}},__esModule:{value:!0}});var d,c,h=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","afterContextMenuHide","afterContextMenuShow","afterCopyLimit","afterCreateCol","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellMouseDown","afterOnCellMouseOver","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterUpdateSettings","afterValidate","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseOver","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","construct","init","modifyCol","unmodifyCol","modifyColHeader","modifyColWidth","modifyRow","modifyRowHeader","modifyRowHeight","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","afterAutofillApplyValues","modifyCopyableRange","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight"],p=(d=j("helpers/array"),d&&d.__esModule&&d||{"default":d}).arrayEach,g=(c=j("helpers/object"),c&&c.__esModule&&c||{"default":c}).objectEach,k=function(){this.globalBucket=this.createEmptyBucket()};$traceurRuntime.createClass(k,{createEmptyBucket:function(){var i=Object.create(null);return p(h,function(e){return i[e]=[]}),i},getBucket:function(){var i=void 0!==arguments[0]?arguments[0]:null;return i?(i.pluginHookBucket||(i.pluginHookBucket=this.createEmptyBucket()),i.pluginHookBucket):this.globalBucket},add:function(q,i){var u=void 0!==arguments[2]?arguments[2]:null,s=this;if(Array.isArray(i)){p(i,function(e){return s.add(q,e,u)})}else{var l=this.getBucket(u);"undefined"==typeof l[q]&&(this.register(q),l[q]=[]),i.skip=!1,-1===l[q].indexOf(i)&&l[q].push(i)}return this},once:function(l,i){var r=void 0!==arguments[2]?arguments[2]:null,q=this;Array.isArray(i)?p(i,function(e){return q.once(l,e,r)}):(i.runOnce=!0,this.add(l,i,r))},remove:function(l,i){var r=void 0!==arguments[2]?arguments[2]:null,q=this.getBucket(r);return"undefined"!=typeof q[l]&&q[l].indexOf(i)>=0?(i.skip=!0,!0):!1},has:function(l){var i=void 0!==arguments[1]?arguments[1]:null,o=this.getBucket(i);return !(void 0===o[l]||!o[l].length)},run:function(D,I,x,w,q,z,J,y){var G=this.globalBucket[I],H=-1,F=G?G.length:0;if(F){for(;++H<F;){if(G[H]&&!G[H].skip){var A=G[H].call(D,x,w,q,z,J,y);void 0!==A&&(x=A),G[H]&&G[H].runOnce&&this.remove(I,G[H])}}}var E=this.getBucket(D)[I],C=-1,v=E?E.length:0;if(v){for(;++C<v;){if(E[C]&&!E[C].skip){var B=E[C].call(D,x,w,q,z,J,y);void 0!==B&&(x=B),E[C]&&E[C].runOnce&&this.remove(I,E[C],D)}}}return x},destroy:function(){var i=void 0!==arguments[0]?arguments[0]:null;g(this.getBucket(i),function(o,l,q){return q[l].length=0})},register:function(i){this.isRegistered(i)||h.push(i)},deregister:function(i){this.isRegistered(i)&&h.splice(h.indexOf(i),1)},isRegistered:function(i){return h.indexOf(i)>=0},getRegistered:function(){return h}},{})},{"helpers/array":42,"helpers/object":52}],59:[function(w,B,k){function j(d,c){d=x(d),y.plugins[d]=c,y.hooks.add("construct",function(){var e;v.has(this)||v.set(this,{}),e=v.get(this),e[d]||(e[d]=new c(this))}),y.hooks.add("afterDestroy",function(){if(v.has(this)){var f=v.get(this);q(f,function(h){return h.destroy()}),v["delete"](this)}})}function g(d,c){if("string"!=typeof c){throw Error('Only strings can be passed as "plugin" parameter')}var f=x(c);if(v.has(d)&&v.get(d)[f]){return v.get(d)[f]}}function p(c){return v.has(c)?Object.keys(v.get(c)):[]}function C(d,c){var f=null;return v.has(d)&&q(v.get(d),function(h,i){h===c&&(f=i)}),f}Object.defineProperties(k,{registerPlugin:{get:function(){return j}},getPlugin:{get:function(){return g}},getRegistredPluginNames:{get:function(){return p}},getPluginName:{get:function(){return C}},__esModule:{value:!0}});var m,z,A,y=(m=w("browser"),m&&m.__esModule&&m||{"default":m})["default"],q=(z=w("helpers/object"),z&&z.__esModule&&z||{"default":z}).objectEach,x=(A=w("helpers/string"),A&&A.__esModule&&A||{"default":A}).toUpperCaseFirst,v=new WeakMap},{browser:23,"helpers/object":52,"helpers/string":54}],60:[function(J,x,C){Object.defineProperties(C,{"default":{get:function(){return k}},__esModule:{value:!0}});var B,z,F,y,E=(B=J("browser"),B&&B.__esModule&&B||{"default":B})["default"],M=(z=J("helpers/object"),z&&z.__esModule&&z||{"default":z}),q=M.defineGetter,L=M.objectEach,G=(F=J("helpers/array"),F&&F.__esModule&&F||{"default":F}).arrayEach,K=(y=J("plugins"),y&&y.__esModule&&y||{"default":y}),I=K.getRegistredPluginNames,A=K.getPluginName,H=new WeakMap,D=null,j=function(d){var c=this;q(this,"hot",d,{writable:!1}),H.set(this,{hooks:{}}),D=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return c.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(){return c.onUpdateSettings()}),this.hot.addHook("beforeInit",function(){return c.init()})};$traceurRuntime.createClass(j,{init:function(){this.pluginName=A(this.hot,this),this.isEnabled&&this.isEnabled()&&this.enablePlugin(),D||(D=I(this.hot)),D.indexOf(this.pluginName)>=0&&D.splice(D.indexOf(this.pluginName),1),D.length||this.hot.runHooks("afterPluginsInitialized"),this.initialized=!0},enablePlugin:function(){this.enabled=!0},disablePlugin:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1},addHook:function(d,c){var f=H.get(this).hooks[d]=H.get(this).hooks[d]||[];this.hot.addHook(d,c),f.push(c),H.get(this).hooks[d]=f},removeHooks:function(d){var c=this;G(H.get(this).hooks[d]||[],function(e){c.hot.removeHook(d,e)})},clearHooks:function(){var d=this,c=H.get(this).hooks;L(c,function(e,f){return d.removeHooks(f)}),c.length=0},callOnPluginsReady:function(c){this.isPluginsReady?c():this.pluginsInitializedCallbacks.push(c)},onAfterPluginsInitialized:function(){G(this.pluginsInitializedCallbacks,function(c){return c()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0},onUpdateSettings:function(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())},updatePlugin:function(){},destroy:function(){var c=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),L(this,function(d,e){"hot"!==e&&(c[e]=null)}),delete this.hot}},{});var k=j;E.plugins.BasePlugin=j},{browser:23,"helpers/array":42,"helpers/object":52,plugins:59}],61:[function(aj,Q,ab){Object.defineProperties(ab,{AutoColumnSize:{get:function(){return Y}},__esModule:{value:!0}});var aa,X,af,V,ad,an,N,al,ag,ak,ai,Z=(aa=aj("_base"),aa&&aa.__esModule&&aa||{"default":aa})["default"],ah=(X=aj("helpers/array"),X&&X.__esModule&&X||{"default":X}),ac=ah.arrayEach,K=ah.arrayFilter,L=(af=aj("helpers/feature"),af&&af.__esModule&&af||{"default":af}),G=L.cancelAnimationFrame,am=L.requestAnimationFrame,W=(V=aj("helpers/dom/element"),V&&V.__esModule&&V||{"default":V}).isVisible,ao=(ad=aj("utils/ghostTable"),ad&&ad.__esModule&&ad||{"default":ad}).GhostTable,z=(an=aj("helpers/object"),an&&an.__esModule&&an||{"default":an}),q=z.isObject,P=(z.objectEach,N=aj("helpers/number"),N&&N.__esModule&&N||{"default":N}),j=P.valueAccordingPercent,F=P.rangeEach,B=(al=aj("plugins"),al&&al.__esModule&&al||{"default":al}).registerPlugin,ae=(ag=aj("utils/samplesGenerator"),ag&&ag.__esModule&&ag||{"default":ag}).SamplesGenerator,J=(ak=aj("helpers/string"),ak&&ak.__esModule&&ak||{"default":ak}).isPercentValue,U=(ai=aj("3rdparty/walkontable/src/calculator/viewportColumns"),ai&&ai.__esModule&&ai||{"default":ai}).WalkontableViewportColumnsCalculator,Y=function(d){var c=this;$traceurRuntime.superConstructor(I).call(this,d),this.widths=[],this.ghostTable=new ao(this.hot),this.samplesGenerator=new ae(function(f,g){return c.hot.getDataAtCell(f,g)}),this.firstCalculation=!0,this.inProgress=!1,this.addHook("beforeColumnResize",function(f,h,g){return c.onBeforeColumnResize(f,h,g)})},I=Y;$traceurRuntime.createClass(Y,{isEnabled:function(){return this.hot.getSettings().autoColumnSize!==!1&&!this.hot.getSettings().colWidths},enablePlugin:function(){var d=this;if(!this.enabled){var c=this.hot.getSettings().autoColumnSize,f=c&&c.hasOwnProperty("samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0;f&&!isNaN(f)&&(this.samplesGenerator.customSampleCount=parseInt(f,10)),c&&null!=c.useHeaders&&this.ghostTable.setSetting("useHeaders",c.useHeaders),this.addHook("afterLoadData",function(){return d.onAfterLoadData()}),this.addHook("beforeChange",function(e){return d.onBeforeChange(e)}),this.addHook("beforeRender",function(e){return d.onBeforeRender(e)}),this.addHook("modifyColWidth",function(e,g){return d.getColumnWidth(g,e)}),$traceurRuntime.superGet(this,I.prototype,"enablePlugin").call(this)}},disablePlugin:function(){$traceurRuntime.superGet(this,I.prototype,"disablePlugin").call(this)},calculateColumnsWidth:function(){var d=void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},c=void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},g=void 0!==arguments[2]?arguments[2]:!1,f=this;"number"==typeof d&&(d={from:d,to:d}),"number"==typeof c&&(c={from:c,to:c}),F(d.from,d.to,function(i){if(g||void 0===f.widths[i]&&!f.hot._getColWidthFromSettings(i)){var h=f.samplesGenerator.generateColumnSamples(i,c);h.forEach(function(l,k){return f.ghostTable.addColumn(k,l)})}}),this.ghostTable.columns.length&&(this.ghostTable.getWidths(function(i,h){return f.widths[i]=h}),this.ghostTable.clean())},calculateAllColumnsWidth:function(){var g=void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},d=this,k=0,h=this.hot.countCols()-1,f=null;this.inProgress=!0;var c=function(){return d.hot?(d.calculateColumnsWidth({from:k,to:Math.min(k+I.CALCULATION_STEP,h)},g),k=k+I.CALCULATION_STEP+1,void (h>k?f=am(c):(G(f),d.inProgress=!1,d.hot.view.wt.wtOverlays.adjustElementsSize(!0),d.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&d.hot.view.wt.wtOverlays.leftOverlay.clone.draw()))):(G(f),void (d.inProgress=!1))};this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateColumnsWidth({from:0,to:this.getSyncCalculationLimit()},g),this.firstCalculation=!1,k=this.getSyncCalculationLimit()+1),h>k?c():this.inProgress=!1},recalculateAllColumnsWidth:function(){this.hot.view&&W(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllColumnsWidth())},getSyncCalculationLimit:function(){var d=I.SYNC_CALCULATION_LIMIT,c=this.hot.countCols()-1;return q(this.hot.getSettings().autoColumnSize)&&(d=this.hot.getSettings().autoColumnSize.syncLimit,J(d)?d=j(c,d):d>>=0),Math.min(d,c)},getColumnWidth:function(d){var c=arguments[1],g=void 0!==arguments[2]?arguments[2]:!0,f=c;return void 0===f&&(f=this.widths[d],g&&"number"==typeof f&&(f=Math.max(f,U.DEFAULT_WIDTH))),f},getFirstVisibleColumn:function(){var c=this.hot.view.wt;return c.wtViewport.columnsVisibleCalculator?c.wtTable.getFirstVisibleColumn():c.wtViewport.columnsRenderCalculator?c.wtTable.getFirstRenderedColumn():-1},getLastVisibleColumn:function(){var c=this.hot.view.wt;return c.wtViewport.columnsVisibleCalculator?c.wtTable.getLastVisibleColumn():c.wtViewport.columnsRenderCalculator?c.wtTable.getLastRenderedColumn():-1},clearCache:function(){this.widths.length=0},isNeedRecalculate:function(){return !!K(this.widths,function(c){return void 0===c}).length},onBeforeRender:function(){var d=this.hot.renderCall,c=this.hot.countRows();c&&(this.calculateColumnsWidth({from:this.getFirstVisibleColumn(),to:this.getLastVisibleColumn()},void 0,d),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth())},onAfterLoadData:function(){var c=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){c.hot&&c.recalculateAllColumnsWidth()},0)},onBeforeChange:function(d){var c=this;ac(d,function(f){return c.widths[c.hot.propToCol(f[1])]=void 0})},onBeforeColumnResize:function(d,c,f){return f&&(this.calculateColumnsWidth(d,void 0,!0),c=this.getColumnWidth(d,void 0,!1)),c},destroy:function(){this.ghostTable.clean(),$traceurRuntime.superGet(this,I.prototype,"destroy").call(this)}},{get CALCULATION_STEP(){return 50},get SYNC_CALCULATION_LIMIT(){return 50}},Z),B("autoColumnSize",Y)},{"3rdparty/walkontable/src/calculator/viewportColumns":3,_base:60,"helpers/array":42,"helpers/dom/element":46,"helpers/feature":48,"helpers/number":51,"helpers/object":52,"helpers/string":54,plugins:59,"utils/ghostTable":102,"utils/samplesGenerator":104}],62:[function(ad,K,V){Object.defineProperties(V,{AutoRowSize:{get:function(){return Y}},__esModule:{value:!0}});var U,P,Z,L,X,ah,I,af,aa,ae,ac=(U=ad("_base"),U&&U.__esModule&&U||{"default":U})["default"],Q=(P=ad("helpers/array"),P&&P.__esModule&&P||{"default":P}),ab=(Q.arrayEach,Q.arrayFilter),W=(Z=ad("helpers/feature"),Z&&Z.__esModule&&Z||{"default":Z}),F=W.cancelAnimationFrame,G=W.requestAnimationFrame,B=(L=ad("helpers/dom/element"),L&&L.__esModule&&L||{"default":L}).isVisible,ag=(X=ad("utils/ghostTable"),X&&X.__esModule&&X||{"default":X}).GhostTable,N=(ah=ad("helpers/object"),ah&&ah.__esModule&&ah||{"default":ah}),ai=N.isObject,x=(N.objectEach,I=ad("helpers/number"),I&&I.__esModule&&I||{"default":I}),q=x.valueAccordingPercent,J=x.rangeEach,j=(af=ad("plugins"),af&&af.__esModule&&af||{"default":af}).registerPlugin,A=(aa=ad("utils/samplesGenerator"),aa&&aa.__esModule&&aa||{"default":aa}).SamplesGenerator,z=(ae=ad("helpers/string"),ae&&ae.__esModule&&ae||{"default":ae}).isPercentValue,Y=function(d){var c=this;$traceurRuntime.superConstructor(D).call(this,d),this.heights=[],this.ghostTable=new ag(this.hot),this.samplesGenerator=new A(function(f,g){return f>=0?c.hot.getDataAtCell(f,g):-1===f?c.hot.getColHeader(g):null}),this.firstCalculation=!0,this.inProgress=!1,this.addHook("beforeRowResize",function(f,h,g){return c.onBeforeRowResize(f,h,g)})},D=Y;$traceurRuntime.createClass(Y,{isEnabled:function(){return this.hot.getSettings().autoRowSize===!0||ai(this.hot.getSettings().autoRowSize)},enablePlugin:function(){var d=this;if(!this.enabled){var c=this.hot.getSettings().autoRowSize,f=c&&c.hasOwnProperty("samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0;f&&!isNaN(f)&&(this.samplesGenerator.customSampleCount=parseInt(f,10)),this.addHook("afterLoadData",function(){return d.onAfterLoadData()}),this.addHook("beforeChange",function(e){return d.onBeforeChange(e)}),this.addHook("beforeColumnMove",function(){return d.recalculateAllRowsHeight()}),this.addHook("beforeColumnResize",function(){return d.recalculateAllRowsHeight()}),this.addHook("beforeColumnSort",function(){return d.clearCache()}),this.addHook("beforeRender",function(e){return d.onBeforeRender(e)}),this.addHook("beforeRowMove",function(e,g){return d.onBeforeRowMove(e,g)}),this.addHook("modifyRowHeight",function(e,g){return d.getRowHeight(g,e)}),this.addHook("modifyColumnHeaderHeight",function(){return d.getColumnHeaderHeight()}),$traceurRuntime.superGet(this,D.prototype,"enablePlugin").call(this)}},disablePlugin:function(){$traceurRuntime.superGet(this,D.prototype,"disablePlugin").call(this)},calculateRowsHeight:function(){var f=void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},c=void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},h=void 0!==arguments[2]?arguments[2]:!1,g=this;if("number"==typeof f&&(f={from:f,to:f}),"number"==typeof c&&(c={from:c,to:c}),null!==this.hot.getColHeader(0)){var d=this.samplesGenerator.generateRowSamples(-1,c);this.ghostTable.addColumnHeadersRow(d.get(-1))}J(f.from,f.to,function(k){if(h||void 0===g.heights[k]){var i=g.samplesGenerator.generateRowSamples(k,c);i.forEach(function(m,l){return g.ghostTable.addRow(l,m)})}}),this.ghostTable.rows.length&&(this.ghostTable.getHeights(function(k,i){return g.heights[k]=i}),this.ghostTable.clean())},calculateAllRowsHeight:function(){var g=void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},d=this,k=0,h=this.hot.countRows()-1,f=null;this.inProgress=!0;var c=function(){return d.hot?(d.calculateRowsHeight({from:k,to:Math.min(k+D.CALCULATION_STEP,h)},g),k=k+D.CALCULATION_STEP+1,void (h>k?f=G(c):(F(f),d.inProgress=!1,d.hot.view.wt.wtOverlays.adjustElementsSize(!0),d.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&d.hot.view.wt.wtOverlays.leftOverlay.clone.draw()))):(F(f),void (d.inProgress=!1))};this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateRowsHeight({from:0,to:this.getSyncCalculationLimit()},g),this.firstCalculation=!1,k=this.getSyncCalculationLimit()+1),h>k?c():this.inProgress=!1},recalculateAllRowsHeight:function(){B(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())},getSyncCalculationLimit:function(){var d=D.SYNC_CALCULATION_LIMIT,c=this.hot.countRows()-1;return ai(this.hot.getSettings().autoRowSize)&&(d=this.hot.getSettings().autoRowSize.syncLimit,z(d)?d=q(c,d):d>>=0),Math.min(d,c)},getRowHeight:function(d){var c=arguments[1],f=c;return void 0!==this.heights[d]&&this.heights[d]>(c||0)&&(f=this.heights[d]),f},getColumnHeaderHeight:function(){return this.heights[-1]},getFirstVisibleRow:function(){var c=this.hot.view.wt;return c.wtViewport.rowsVisibleCalculator?c.wtTable.getFirstVisibleRow():c.wtViewport.rowsRenderCalculator?c.wtTable.getFirstRenderedRow():-1},getLastVisibleRow:function(){var c=this.hot.view.wt;return c.wtViewport.rowsVisibleCalculator?c.wtTable.getLastVisibleRow():c.wtViewport.rowsRenderCalculator?c.wtTable.getLastRenderedRow():-1},clearCache:function(){this.heights.length=0,this.heights[-1]=void 0},clearCacheByRange:function(d){var c=this;"number"==typeof d&&(d={from:d,to:d}),J(Math.min(d.from,d.to),Math.max(d.from,d.to),function(f){return c.heights[f]=void 0})},isNeedRecalculate:function(){return !!ab(this.heights,function(c){return void 0===c}).length},onBeforeRender:function(){var d=this.hot.renderCall;this.calculateRowsHeight({from:this.getFirstVisibleRow(),to:this.getLastVisibleRow()},void 0,d);var c=this.hot.getSettings().fixedRowsBottom;if(c){var f=this.hot.countRows()-1;this.calculateRowsHeight({from:f-c,to:f})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()},onBeforeRowMove:function(d,c){this.clearCacheByRange({from:d,to:c}),this.calculateAllRowsHeight()},onBeforeRowResize:function(d,c,f){return f&&(this.calculateRowsHeight(d,void 0,!0),c=this.getRowHeight(d)),c},onAfterLoadData:function(){var c=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){c.hot&&c.recalculateAllRowsHeight()},0)},onBeforeChange:function(d){var c=null;1===d.length?c=d[0][0]:d.length>1&&(c={from:d[0][0],to:d[d.length-1][0]}),null!==c&&this.clearCacheByRange(c)},destroy:function(){this.ghostTable.clean(),$traceurRuntime.superGet(this,D.prototype,"destroy").call(this)}},{get CALCULATION_STEP(){return 50},get SYNC_CALCULATION_LIMIT(){return 500}},ac),j("autoRowSize",Y)},{_base:60,"helpers/array":42,"helpers/dom/element":46,"helpers/feature":48,"helpers/number":51,"helpers/object":52,"helpers/string":54,plugins:59,"utils/ghostTable":102,"utils/samplesGenerator":104}],63:[function(J,x,C){function B(R,W,w,v){var g,O,X,N,U,V=w.length,T=w?w[0].length:0,P=[],S=[];if(g=W.row-R.row,O=W.col-R.col,-1!==["down","up"].indexOf(v)){for(var Q=0;O>=Q;Q++){X=parseInt(w[0][Q],10),N=parseInt(w[V-1][Q],10),U=("down"===v?N-X:X-N)/(V-1)||0,S.push(U)}P.push(S)}if(-1!==["right","left"].indexOf(v)){for(var m=0;g>=m;m++){X=parseInt(w[m][0],10),N=parseInt(w[m][T-1],10),U=("right"===v?N-X:X-N)/(T-1)||0,S=[],S.push(U),P.push(S)}}return P}function z(m){function f(e){return m.autofill?void (m.autofill.handle&&m.autofill.handle.isDragged&&(m.autofill.handle.isDragged>1&&m.autofill.apply(),m.autofill.handle.isDragged=0,c=!1)):!0}function u(l){var i,o;return g.instance.autofill?(i=I(g.instance.table).top-(window.pageYOffset||document.documentElement.scrollTop)+A(g.instance.table),o=I(g.instance.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+H(g.instance.table),g.addingStarted===!1&&g.instance.autofill.handle.isDragged>0&&l.clientY>i&&l.clientX<=o?(g.instance.mouseDragOutside=!0,g.addingStarted=!0):g.instance.mouseDragOutside=!1,void (g.instance.mouseDragOutside&&k("autoInsertRow")&&setTimeout(function(){g.addingStarted=!1,g.instance.alter("insert_row")},200))):!1}var p,h,d,g=this,c=!1;this.instance=m,this.addingStarted=!1,d=D(m),d.addEventListener(document,"mouseup",f),d.addEventListener(document,"mousemove",u),p=this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown,this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown=function(e){m.autofill.handle.isDragged=1,c=!0,p(e)},h=this.instance.view.wt.wtSettings.settings.onCellMouseOver,this.instance.view.wt.wtSettings.settings.onCellMouseOver=function(l,s,r,e){m.autofill&&c&&!m.view.isMouseDown()&&m.autofill.handle&&m.autofill.handle.isDragged&&(m.autofill.handle.isDragged++,m.autofill.showBorder(s),m.autofill.checkIfNewRowNeeded()),h(l,s,r,e)},this.instance.view.wt.wtSettings.settings.onCellCornerDblClick=function(){m.autofill.selectAdjacent()}}function F(c){return function(d){var e;return"direction"===d?e="string"==typeof c?c:"object"==typeof c&&void 0!==c[d]?c[d]:!0:"autoInsertRow"===d?e="object"==typeof c&&void 0!==c[d]?c[d]:!0:"fillHandle"===d&&(e=!!c),e}}Object.defineProperties(C,{Autofill:{get:function(){return z}},__esModule:{value:!0}});var y,E,M,q,L,G=(y=J("browser"),y&&y.__esModule&&y||{"default":y})["default"],K=(E=J("helpers/dom/element"),E&&E.__esModule&&E||{"default":E}),I=K.offset,A=K.outerHeight,H=K.outerWidth,D=(M=J("eventManager"),M&&M.__esModule&&M||{"default":M}).eventManager,j=((q=J("plugins"),q&&q.__esModule&&q||{"default":q}).registerPlugin,(L=J("3rdparty/walkontable/src/cell/coords"),L&&L.__esModule&&L||{"default":L}).WalkontableCellCoords);z.prototype.init=function(){this.handle={}},z.prototype.disable=function(){this.handle.disabled=!0},z.prototype.selectAdjacent=function(){var f,c,h,g,d;f=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),c=this.instance.getData();f:for(h=f[2]+1;h<this.instance.countRows();h++){for(d=f[1];d<=f[3];d++){if(c[h][d]){break f}}(c[h][f[1]-1]||c[h][f[3]+1])&&(g=h)}g&&(this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(new j(f[0],f[1])),this.instance.view.wt.selections.fill.add(new j(g,f[3])),this.apply())},z.prototype.apply=function(){var o,g,p,m,f,h,d,c;this.handle.isDragged=0,this.instance.view.wt.selections.fill.isEmpty()||(o=this.instance.view.wt.selections.fill.getCorners(),this.instance.view.wt.selections.fill.clear(),g=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),G.hooks.run(this.instance,"afterAutofillApplyValues",g,o),o[0]===g[0]&&o[1]<g[1]?(h="left",p=new j(o[0],o[1]),m=new j(o[2],g[1]-1)):o[0]===g[0]&&o[3]>g[3]?(h="right",p=new j(o[0],g[3]+1),m=new j(o[2],o[3])):o[0]<g[0]&&o[1]===g[1]?(h="up",p=new j(o[0],o[1]),m=new j(g[0]-1,o[3])):o[2]>g[2]&&o[1]===g[1]&&(h="down",p=new j(g[2]+1,o[1]),m=new j(o[2],o[3])),p&&p.row>-1&&p.col>-1?(c={from:this.instance.getSelectedRange().from,to:this.instance.getSelectedRange().to},f=this.instance.getData(c.from.row,c.from.col,c.to.row,c.to.col),d=B(p,m,f,h),G.hooks.run(this.instance,"beforeAutofill",p,m,f),this.instance.populateFromArray(p.row,p.col,f,m.row,m.col,"autofill",null,h,d),this.instance.selection.setRangeStart(new j(o[0],o[1])),this.instance.selection.setRangeEnd(new j(o[2],o[3]))):this.instance.selection.refreshBorders())},z.prototype.showBorder=function(d){var c=this.instance.getSelectedRange().getTopLeftCorner(),f=this.instance.getSelectedRange().getBottomRightCorner();if("horizontal"!==k("direction")&&(f.row<d.row||c.row>d.row)){d=new j(d.row,f.col)}else{if("vertical"===k("direction")){return}d=new j(f.row,d.col)}this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().from),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().to),this.instance.view.wt.selections.fill.add(d),this.instance.view.render()},z.prototype.checkIfNewRowNeeded=function(){var d,c,g=this.instance.countRows(),f=this;this.instance.view.wt.selections.fill.cellRange&&this.addingStarted===!1&&k("autoInsertRow")&&(c=this.instance.getSelected(),d=this.instance.view.wt.selections.fill.getCorners(),c[2]<g-1&&d[2]===g-1&&(this.addingStarted=!0,this.instance._registerTimeout(setTimeout(function(){f.instance.alter("insert_row"),f.addingStarted=!1},200))))},G.hooks.add("afterInit",function(){var c=new z(this);k=F(this.getSettings().fillHandle),void 0!==k("fillHandle")&&(c.handle&&k("fillHandle")===!1?c.disable():c.handle||k("fillHandle")===!1||(this.autofill=c,this.autofill.init()))});var k;G.Autofill=z},{"3rdparty/walkontable/src/cell/coords":5,browser:23,eventManager:41,"helpers/dom/element":46,plugins:59}],64:[function(O,A,H){Object.defineProperties(H,{ColumnSorting:{get:function(){return U}},__esModule:{value:!0}});var G,E,K,B,J,T,z=(G=O("browser"),G&&G.__esModule&&G||{"default":G})["default"],Q=(E=O("helpers/dom/element"),E&&E.__esModule&&E||{"default":E}),L=Q.addClass,P=Q.closest,N=Q.hasClass,F=Q.index,M=Q.removeClass,I=(K=O("helpers/array"),K&&K.__esModule&&K||{"default":K}),q=(I.arrayEach,I.arrayMap),x=I.arrayReduce,k=(B=O("eventManager"),B&&B.__esModule&&B||{"default":B}).eventManager,S=(J=O("_base"),J&&J.__esModule&&J||{"default":J})["default"],D=(T=O("plugins"),T&&T.__esModule&&T||{"default":T}).registerPlugin;z.hooks.register("beforeColumnSort"),z.hooks.register("afterColumnSort");var U=function(c){$traceurRuntime.superConstructor(j).call(this,c),this.sortIndicators=[],this.lastSortedColumn=null},j=U;$traceurRuntime.createClass(U,{isEnabled:function(){return !!this.hot.getSettings().columnSorting},enablePlugin:function(){var d=this;if(!this.enabled){var c=this;this.hot.sortIndex=[],this.hot.sort=function(){var f=Array.prototype.slice.call(arguments);return c.sortByColumn.apply(c,f)},"undefined"==typeof this.hot.getSettings().observeChanges&&this.enableObserveChangesPlugin(),this.bindColumnSortingAfterClick(),this.addHook("afterTrimRow",function(e){return d.sort()}),this.addHook("afterUntrimRow",function(e){return d.sort()}),this.addHook("modifyRow",function(e){return d.translateRow(e)}),this.addHook("afterUpdateSettings",function(){return d.onAfterUpdateSettings()}),this.addHook("afterGetColHeader",function(e,f){return d.getColHeader(e,f)}),this.addHook("afterCreateRow",function(){c.afterCreateRow.apply(c,arguments)}),this.addHook("afterRemoveRow",function(){c.afterRemoveRow.apply(c,arguments)}),this.addHook("afterInit",function(){return d.sortBySettings()}),this.addHook("afterLoadData",function(){d.hot.sortIndex=[],d.hot.view&&d.sortBySettings()}),this.hot.view&&this.sortBySettings(),$traceurRuntime.superGet(this,j.prototype,"enablePlugin").call(this)}},disablePlugin:function(){this.hot.sort=void 0,$traceurRuntime.superGet(this,j.prototype,"disablePlugin").call(this)},onAfterUpdateSettings:function(){this.sortBySettings()},sortBySettings:function(){var d,c,g=this.hot.getSettings().columnSorting,f=this.loadSortingState();"undefined"==typeof f?(d=g.column,c=g.sortOrder):(d=f.sortColumn,c=f.sortOrder),"number"==typeof d&&(this.lastSortedColumn=d,this.sortByColumn(d,c))},setSortingColumn:function(d,c){return"undefined"==typeof d?(this.hot.sortColumn=void 0,void (this.hot.sortOrder=void 0)):(this.hot.sortColumn===d&&"undefined"==typeof c?this.hot.sortOrder===!1?this.hot.sortOrder=void 0:this.hot.sortOrder=!this.hot.sortOrder:this.hot.sortOrder="undefined"==typeof c?!0:c,void (this.hot.sortColumn=d))},sortByColumn:function(d,c){if(this.setSortingColumn(d,c),"undefined"!=typeof this.hot.sortColumn){var f=z.hooks.run(this.hot,"beforeColumnSort",this.hot.sortColumn,this.hot.sortOrder);f!==!1&&this.sort(),this.updateOrderClass(),this.updateSortIndicator(),this.hot.render(),this.saveSortingState(),z.hooks.run(this.hot,"afterColumnSort",this.hot.sortColumn,this.hot.sortOrder)}},saveSortingState:function(){var c={};"undefined"!=typeof this.hot.sortColumn&&(c.sortColumn=this.hot.sortColumn),"undefined"!=typeof this.hot.sortOrder&&(c.sortOrder=this.hot.sortOrder),(c.hasOwnProperty("sortColumn")||c.hasOwnProperty("sortOrder"))&&z.hooks.run(this.hot,"persistentStateSave","columnSorting",c)},loadSortingState:function(){var c={};return z.hooks.run(this.hot,"persistentStateLoad","columnSorting",c),c.value},updateOrderClass:function(){var c;this.hot.sortOrder===!0?c="ascending":this.hot.sortOrder===!1&&(c="descending"),this.sortOrderClass=c},bindColumnSortingAfterClick:function(){function f(){var l=d.hot.view.TBODY.querySelector("tr"),i=1;return l&&(i=l.querySelectorAll("th").length),i}function c(e){var i=P(e,"TH");return d.hot.view.wt.wtTable.getFirstRenderedColumn()+F(i)-f()}var h=this;if(!this.bindedSortEvent){var g=k(this.hot),d=this;this.bindedSortEvent=!0,g.addEventListener(this.hot.rootElement,"click",function(i){if(N(i.target,"columnSorting")){var l=c(i.target);l!==h.lastSortedColumn&&(h.hot.sortOrder=!0),h.lastSortedColumn=l,h.sortByColumn(l)}})}},enableObserveChangesPlugin:function(){var c=this;this.hot._registerTimeout(setTimeout(function(){c.hot.updateSettings({observeChanges:!0})},0))},defaultSort:function(c){return function(d,e){return"string"==typeof d[1]&&(d[1]=d[1].toLowerCase()),"string"==typeof e[1]&&(e[1]=e[1].toLowerCase()),d[1]===e[1]?0:null===d[1]||""===d[1]?1:null===e[1]||""===e[1]?-1:isNaN(d[1])&&!isNaN(e[1])?c?1:-1:!isNaN(d[1])&&isNaN(e[1])?c?-1:1:d[1]<e[1]?c?-1:1:d[1]>e[1]?c?1:-1:0}},dateSort:function(c){return function(d,g){if(d[1]===g[1]){return 0}if(null===d[1]||""===d[1]){return 1}if(null===g[1]||""===g[1]){return -1}var f=new Date(d[1]),e=new Date(g[1]);return e>f?c?-1:1:f>e?c?1:-1:0}},numericSort:function(c){return function(d,g){var f=parseFloat(d[1]),e=parseFloat(g[1]);return f===e||isNaN(f)&&isNaN(e)?0:isNaN(f)?1:isNaN(e)?-1:e>f?c?-1:1:f>e?c?1:-1:0}},sort:function(){if("undefined"==typeof this.hot.sortOrder){return void (this.hot.sortIndex.length=0)}var f,c;this.hot.sortingEnabled=!1,this.hot.sortIndex.length=0;for(var h=0,g=this.hot.countRows()-this.hot.getSettings().minSpareRows;g>h;h++){this.hot.sortIndex.push([h,this.hot.getDataAtCell(h,this.hot.sortColumn)])}if(f=this.hot.getCellMeta(0,this.hot.sortColumn),f.sortFunction){c=f.sortFunction}else{switch(f.type){case"date":c=this.dateSort;break;case"numeric":c=this.numericSort;break;default:c=this.defaultSort}}this.hot.sortIndex.sort(c(this.hot.sortOrder));for(var d=this.hot.sortIndex.length;d<this.hot.countRows();d++){this.hot.sortIndex.push([d,this.hot.getDataAtCell(d,this.hot.sortColumn)])}this.hot.sortingEnabled=!0},updateSortIndicator:function(){if("undefined"!=typeof this.hot.sortOrder){var c=this.hot.getCellMeta(0,this.hot.sortColumn);this.sortIndicators[this.hot.sortColumn]=c.sortIndicator}},translateRow:function(c){return this.hot.sortingEnabled&&"undefined"!=typeof this.hot.sortOrder&&this.hot.sortIndex&&this.hot.sortIndex.length&&this.hot.sortIndex[c]?this.hot.sortIndex[c][0]:c},untranslateRow:function(d){if(this.hot.sortingEnabled&&this.hot.sortIndex&&this.hot.sortIndex.length){for(var c=0;c<this.hot.sortIndex.length;c++){if(this.hot.sortIndex[c][0]==d){return c}}}},getColHeader:function(f,c){var h=c.querySelector(".colHeader"),g=(c.getAttribute("colspan"),c.parentNode.parentNode.childNodes),d=Array.prototype.indexOf.call(g,c.parentNode);d-=g.length,h&&(this.hot.getSettings().columnSorting&&f>=0&&-1===d&&L(h,"columnSorting"),M(h,"descending"),M(h,"ascending"),this.sortIndicators[f]&&f===this.hot.sortColumn&&("ascending"===this.sortOrderClass?L(h,"ascending"):"descending"===this.sortOrderClass&&L(h,"descending")))},isSorted:function(){return"undefined"!=typeof this.hot.sortColumn},afterCreateRow:function(d,c){if(this.isSorted()){for(var f=0;f<this.hot.sortIndex.length;f++){this.hot.sortIndex[f][0]>=d&&(this.hot.sortIndex[f][0]+=c)}for(var f=0;c>f;f++){this.hot.sortIndex.splice(d+f,0,[d+f,this.hot.getSourceData()[d+f][this.hot.sortColumn+this.hot.colOffset()]])}this.saveSortingState()}},afterRemoveRow:function(d,c){function g(h){return x(f,function(e,i){return h>i&&e++,e},0)}if(this.isSorted()){var f=this.hot.sortIndex.splice(d,c);f=q(f,function(h){return h[0]}),this.hot.sortIndex=q(this.hot.sortIndex,function(i,h){var l=g(i[0]);return l&&(i[0]-=l),i}),this.saveSortingState()}}},{},S),D("columnSorting",U)},{_base:60,browser:23,eventManager:41,"helpers/array":42,"helpers/dom/element":46,plugins:59}],65:[function(h,d,k){Object.defineProperties(k,{CommentEditor:{get:function(){return c}},__esModule:{value:!0}});var j,g=(j=h("helpers/dom/element"),j&&j.__esModule&&j||{"default":j}).addClass,c=function(){this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.editorStyle.position="absolute",this.editorStyle.zIndex=100,this.hide()},f=c;$traceurRuntime.createClass(c,{setPosition:function(l,i){this.editorStyle.left=l+"px",this.editorStyle.top=i+"px"},show:function(){this.editorStyle.display="block"},hide:function(){this.editorStyle.display="none"},isVisible:function(){return"block"===this.editorStyle.display},setValue:function(){var i=void 0!==arguments[0]?arguments[0]:"";i=i||"",this.getInputElement().value=i},getValue:function(){return this.getInputElement().value},isFocused:function(){return document.activeElement===this.getInputElement()},focus:function(){this.getInputElement().focus()},createEditor:function(){var l,i,m=document.querySelector("."+f.CLASS_EDITOR_CONTAINER);return m||(m=document.createElement("div"),g(m,f.CLASS_EDITOR_CONTAINER),document.body.appendChild(m)),l=document.createElement("div"),g(l,f.CLASS_EDITOR),i=document.createElement("textarea"),g(i,f.CLASS_INPUT),l.appendChild(i),m.appendChild(l),l},getInputElement:function(){return this.editor.querySelector("."+f.CLASS_INPUT)},destroy:function(){this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null}},{get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"},get CLASS_EDITOR(){return"htComments"},get CLASS_INPUT(){return"htCommentTextArea"},get CLASS_CELL(){return"htCommentCell"}})},{"helpers/dom/element":46}],66:[function(T,D,K){Object.defineProperties(K,{Comments:{get:function(){return j}},__esModule:{value:!0}});var J,H,N,F,M,X,A,V=(J=T("browser"),J&&J.__esModule&&J||{"default":J})["default"],O=(H=T("helpers/dom/element"),H&&H.__esModule&&H||{"default":H}),U=O.addClass,Q=O.closest,I=O.getWindowScrollLeft,P=O.getWindowScrollTop,L=O.hasClass,x=O.offset,z=(N=T("eventManager"),N&&N.__esModule&&N||{"default":N}).EventManager,q=(F=T("3rdparty/walkontable/src/cell/coords"),F&&F.__esModule&&F||{"default":F}).WalkontableCellCoords,W=(M=T("plugins"),M&&M.__esModule&&M||{"default":M}),G=W.registerPlugin,Y=(W.getPlugin,(X=T("_base"),X&&X.__esModule&&X||{"default":X})["default"]),k=(A=T("commentEditor"),A&&A.__esModule&&A||{"default":A}).CommentEditor,j=function(c){$traceurRuntime.superConstructor(B).call(this,c),this.editor=null,this.eventManager=null,this.range={},this.mouseDown=!1,this.contextMenuEvent=!1,this.timer=null},B=j;$traceurRuntime.createClass(j,{isEnabled:function(){return this.hot.getSettings().comments},enablePlugin:function(){var c=this;this.enabled||(this.editor||(this.editor=new k),this.eventManager||(this.eventManager=new z(this)),this.addHook("afterContextMenuDefaultOptions",function(d){return c.addToContextMenu(d)}),this.addHook("afterRenderer",function(e,l,h,g,d,f){return c.onAfterRenderer(e,f)}),this.addHook("afterScrollHorizontally",function(){return c.refreshEditorPosition()}),this.addHook("afterScrollVertically",function(){return c.refreshEditorPosition()}),this.addHook("afterColumnResize",function(){return c.refreshEditorPosition()}),this.addHook("afterRowResize",function(){return c.refreshEditorPosition()}),this.registerListeners(),$traceurRuntime.superGet(this,B.prototype,"enablePlugin").call(this))},disablePlugin:function(){$traceurRuntime.superGet(this,B.prototype,"disablePlugin").call(this)},registerListeners:function(){var c=this;this.eventManager.addEventListener(document,"mouseover",function(d){return c.onMouseOver(d)}),this.eventManager.addEventListener(document,"mousedown",function(d){return c.onMouseDown(d)}),this.eventManager.addEventListener(document,"mousemove",function(d){return c.onMouseMove(d)}),this.eventManager.addEventListener(document,"mouseup",function(d){return c.onMouseUp(d)}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(d){return c.onEditorBlur(d)})},setRange:function(c){this.range=c},clearRange:function(){this.range={}},targetIsCellWithComment:function(c){return !(!L(c.target,"htCommentCell")||!Q(c.target,[this.hot.rootElement]))},targetIsCommentTextArea:function(c){return this.editor.getInputElement()===c.target},saveComment:function(){if(!this.range.from){throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())')}var d=this.editor.getValue(),c=this.range.from.row,f=this.range.from.col;this.hot.setCellMeta(c,f,"comment",d),this.hot.render()},saveCommentAtCell:function(d,c){this.setRange({from:new q(d,c)}),this.saveComment()},removeComment:function(){if(!this.range.from){throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())')}this.hot.removeCellMeta(this.range.from.row,this.range.from.col,"comment"),this.hot.render(),this.hide()},removeCommentAtCell:function(d,c){this.setRange({from:new q(d,c)}),this.removeComment()},show:function(){if(!this.range.from){throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())')}var c=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditorPosition(!0),this.editor.setValue(c.comment||""),this.editor.show(),!0},showAtCell:function(d,c){return this.setRange({from:new q(d,c)}),this.show()},hide:function(){this.editor.hide()},refreshEditorPosition:function(){var w=void 0!==arguments[0]?arguments[0]:!1;if(w||this.range.from&&this.editor.isVisible()){var R=this.hot.view.wt.wtTable.getCell(this.range.from),g=x(R),f=this.hot.getColWidth(this.range.from.col),d=g.top,p=g.left,S=0,m=0;this.hot.view.wt.wtViewport.hasVerticalScroll()&&(d-=this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition(),S=20),this.hot.view.wt.wtViewport.hasHorizontalScroll()&&(p-=this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition(),m=20);var C=p+f,E=d,y=this.hot.view.wt.wtTable.holder.getBoundingClientRect(),v={left:y.left+I()+m,right:y.right+I()-15,top:y.top+P()+S,bottom:y.bottom+P()};C<=v.left||C>v.right||E<=v.top||E>v.bottom?this.hide():this.editor.setPosition(C,E)}},onMouseDown:function(c){this.mouseDown=!0,this.hot.view&&this.hot.view.wt&&(this.contextMenuEvent||this.targetIsCommentTextArea(c)||this.targetIsCellWithComment(c)||this.hide(),this.contextMenuEvent=!1)},onMouseOver:function(d){if(!this.mouseDown&&!this.editor.isFocused()){if(this.targetIsCellWithComment(d)){var c=this.hot.view.wt.wtTable.getCoords(d.target),f={from:new q(c.row,c.col)};this.setRange(f),this.show()}else{this.targetIsCommentTextArea(d)||this.editor.isFocused()||this.hide()}}},onMouseMove:function(d){var c=this;this.targetIsCommentTextArea(d)&&(this.mouseDown=!0,clearTimeout(this.timer),this.timer=setTimeout(function(){c.mouseDown=!1},200))},onMouseUp:function(c){this.mouseDown=!1},onAfterRenderer:function(d,c){c.comment&&U(d,c.commentedCellClassName)},onEditorBlur:function(c){this.saveComment()},checkSelectionCommentsConsistency:function(){var d=this.hot.getSelectedRange();if(!d){return !1}var c=!1,f=d.from;return this.hot.getCellMeta(f.row,f.col).comment&&(c=!0),c},onContextMenuAddComment:function(){var d=this,c=this.hot.getSelectedRange();this.contextMenuEvent=!0,this.setRange({from:c.from}),this.show(),setTimeout(function(){d.hot&&(d.hot.deselectCell(),d.editor.focus())},10)},onContextMenuRemoveComment:function(d,c){this.contextMenuEvent=!0,this.removeCommentAtCell(c.start.row,c.start.col)},addToContextMenu:function(d){var c=this;d.items.push(V.plugins.ContextMenu.SEPARATOR,{key:"commentsAddEdit",name:function(){return c.checkSelectionCommentsConsistency()?"Edit Comment":"Add Comment"},callback:function(){return c.onContextMenuAddComment()},disabled:function(){return !this.getSelected()}},{key:"commentsRemove",name:function(){return"Delete Comment"},callback:function(f,g){return c.onContextMenuRemoveComment(f,g)},disabled:function(){return !c.checkSelectionCommentsConsistency()}})},destroy:function(){this.editor&&this.editor.destroy(),$traceurRuntime.superGet(this,B.prototype,"destroy").call(this)}},{},Y),G("comments",j)},{"3rdparty/walkontable/src/cell/coords":5,_base:60,browser:23,commentEditor:65,eventManager:41,"helpers/dom/element":46,plugins:59}],67:[function(h,d,k){function j(l,i){var m;return c(i,function(e){var n=e.key?e.key.split(":"):null;return Array.isArray(n)&&n[1]===l?(m=e,!1):void 0}),m}Object.defineProperties(k,{CommandExecutor:{get:function(){return f}},__esModule:{value:!0}});var g,c=(g=h("helpers/array"),g&&g.__esModule&&g||{"default":g}).arrayEach,f=function(i){this.hot=i,this.commands={},this.commonCallback=null};$traceurRuntime.createClass(f,{registerCommand:function(l,i){this.commands[l]=i},setCommonCallback:function(i){this.commonCallback=i},execute:function(w){for(var p=[],x=1;x<arguments.length;x++){p[x-1]=arguments[x]}var v=this,q=w.split(":");w=q[0];var m=2===q.length?q[1]:null,i=this.commands[w];if(!i){throw new Error("Menu command '"+w+"' not exists.")}if(m&&i.submenu&&(i=j(m,i.submenu.items)),i.disabled!==!0&&("function"!=typeof i.disabled||i.disabled.call(this.hot)!==!0)&&!i.hasOwnProperty("submenu")){var o=[];"function"==typeof i.callback&&o.push(i.callback),"function"==typeof this.commonCallback&&o.push(this.commonCallback),p.unshift(q.join(":")),c(o,function(l){return l.apply(v.hot,p)})}}},{})},{"helpers/array":42}],68:[function(aE,ap,av){Object.defineProperties(av,{ContextMenu:{get:function(){return ah}},__esModule:{value:!0}});var au,ar,aA,aq,ax,aI,ao,aG,aB,aF,aI,aD,at=(au=aE("browser"),au&&au.__esModule&&au||{"default":au})["default"],aC=(ar=aE("_base"),ar&&ar.__esModule&&ar||{"default":ar})["default"],aw=(aA=aE("helpers/array"),aA&&aA.__esModule&&aA||{"default":aA}).arrayEach,am=(aq=aE("commandExecutor"),aq&&aq.__esModule&&aq||{"default":aq}).CommandExecutor,an=(ax=aE("eventManager"),ax&&ax.__esModule&&ax||{"default":ax}).EventManager,ak=(aI=aE("helpers/dom/element"),aI&&aI.__esModule&&aI||{"default":aI}).hasClass,aH=(ao=aE("itemsFactory"),ao&&ao.__esModule&&ao||{"default":ao}).ItemsFactory,ag=(aG=aE("menu"),aG&&aG.__esModule&&aG||{"default":aG}).Menu,aJ=(aB=aE("plugins"),aB&&aB.__esModule&&aB||{"default":aB}).registerPlugin,Q=(aF=aE("helpers/dom/event"),aF&&aF.__esModule&&aF||{"default":aF}),K=Q.stopPropagation,ae=Q.pageX,J=Q.pageY,Z=(aI=aE("helpers/dom/element"),aI&&aI.__esModule&&aI||{"default":aI}),X=Z.getWindowScrollLeft,ay=Z.getWindowScrollTop,ac=(aD=aE("predefinedItems"),aD&&aD.__esModule&&aD||{"default":aD}),af=ac.ROW_ABOVE,ai=ac.ROW_BELOW,al=ac.COLUMN_LEFT,U=ac.COLUMN_RIGHT,Y=ac.REMOVE_ROW,aa=ac.REMOVE_COLUMN,q=ac.UNDO,ab=ac.REDO,az=ac.READ_ONLY,G=ac.ALIGNMENT,ad=ac.SEPARATOR,ah=function(c){$traceurRuntime.superConstructor(aj).call(this,c),this.eventManager=new an(this),this.commandExecutor=new am(this.hot),this.itemsFactory=null,this.menu=null},aj=ah;$traceurRuntime.createClass(ah,{isEnabled:function(){return this.hot.getSettings().contextMenu},enablePlugin:function(){var d=this;if(!this.enabled){this.itemsFactory=new aH(this.hot,aj.DEFAULT_ITEMS);var c=this.hot.getSettings().contextMenu,f={items:this.itemsFactory.getItems(c)};this.registerEvents(),"function"==typeof c.callback&&this.commandExecutor.setCommonCallback(c.callback),$traceurRuntime.superGet(this,aj.prototype,"enablePlugin").call(this),this.callOnPluginsReady(function(){d.hot.runHooks("afterContextMenuDefaultOptions",f),d.itemsFactory.setPredefinedItems(f.items);var e=d.itemsFactory.getItems(c);d.menu=new ag(d.hot,{className:"htContextMenu",keepInViewport:!0}),d.menu.setMenuItems(e),d.menu.addLocalHook("afterOpen",function(){return d.onMenuAfterOpen()}),d.menu.addLocalHook("afterClose",function(){return d.onMenuAfterClose()}),d.menu.addLocalHook("executeCommand",function(){for(var g=[],h=0;h<arguments.length;h++){g[h]=arguments[h]}return d.executeCommand.apply(d,g)}),aw(e,function(g){return d.commandExecutor.registerCommand(g.key,g)})})}},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,aj.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),$traceurRuntime.superGet(this,aj.prototype,"disablePlugin").call(this)},registerEvents:function(){var c=this;this.eventManager.addEventListener(this.hot.rootElement,"contextmenu",function(d){return c.onContextMenu(d)})},open:function(c){this.menu&&(this.menu.open(),this.menu.setPosition({top:parseInt(J(c),10)-ay(),left:parseInt(ae(c),10)-X()}),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv,at.eventManager.isHotTableEnv=this.hot.isHotTableEnv)},close:function(){this.menu&&this.menu.close()},executeCommand:function(){for(var d=[],c=0;c<arguments.length;c++){d[c]=arguments[c]}this.commandExecutor.execute.apply(this.commandExecutor,d)},onContextMenu:function(h){function d(i){return"TD"===i.nodeName||"TD"===i.parentNode.nodeName}var k=this.hot.getSettings(),j=k.rowHeaders,g=k.colHeaders,c=h.realTarget;if(this.close(),h.preventDefault(),K(h),j||g){if(j&&g){var f=c.parentNode.querySelectorAll(".cornerHeader").length>0;if(f){return}}}else{if(!(d(c)||ak(c,"current")&&ak(c,"wtBorder"))){return}}this.open(h)},onMenuAfterOpen:function(){this.hot.runHooks("afterContextMenuShow",this)},onMenuAfterClose:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)},destroy:function(){this.close(),this.menu&&this.menu.destroy(),$traceurRuntime.superGet(this,aj.prototype,"destroy").call(this)}},{get DEFAULT_ITEMS(){return[af,ai,ad,al,U,ad,Y,aa,ad,q,ab,ad,az,ad,G]}},aC),ah.SEPARATOR={name:ad},at.hooks.register("afterContextMenuDefaultOptions"),at.hooks.register("afterContextMenuShow"),at.hooks.register("afterContextMenuHide"),at.hooks.register("afterContextMenuExecute"),aJ("contextMenu",ah)},{_base:60,browser:23,commandExecutor:67,eventManager:41,"helpers/array":42,"helpers/dom/element":46,"helpers/dom/event":47,itemsFactory:70,menu:71,plugins:59,predefinedItems:72}],69:[function(w,B,k){Object.defineProperties(k,{Cursor:{get:function(){return v}},__esModule:{value:!0}});var j,g,p,C=(j=w("browser"),j&&j.__esModule&&j||{"default":j})["default"],m=(g=w("helpers/dom/element"),g&&g.__esModule&&g||{"default":g}),z=m.getWindowScrollLeft,A=m.getWindowScrollTop,y=(p=w("helpers/dom/event"),p&&p.__esModule&&p||{"default":p}),q=y.pageX,x=y.pageY,v=function(E){var G,h,f,d,D,H,u=A(),F=z();this.type=this.getSourceType(E),"literal"===this.type?(G=parseInt(E.top,10),f=parseInt(E.left,10),D=E.height||0,H=E.width||0,h=G,d=f,G+=u,f+=F):"event"===this.type&&(G=parseInt(x(E),10),f=parseInt(q(E),10),D=E.target.clientHeight,H=E.target.clientWidth,h=G-u,d=f-F),this.top=G,this.topRelative=h,this.left=f,this.leftRelative=d,this.scrollTop=u,this.scrollLeft=F,this.cellHeight=D,this.cellWidth=H};$traceurRuntime.createClass(v,{getSourceType:function(d){var c="literal";return d instanceof Event&&(c="event"),c},fitsAbove:function(c){return this.topRelative>=c.offsetHeight},fitsBelow:function(d){var c=void 0!==arguments[1]?arguments[1]:window.innerHeight;return this.topRelative+d.offsetHeight<=c},fitsOnRight:function(d){var c=void 0!==arguments[1]?arguments[1]:window.innerWidth;return this.leftRelative+this.cellWidth+d.offsetWidth<=c},fitsOnLeft:function(c){return this.leftRelative>=c.offsetWidth}},{}),C.plugins.utils=C.plugins.utils||{},C.plugins.utils.Cursor=v},{browser:23,"helpers/dom/element":46,"helpers/dom/event":47}],70:[function(C,H,v){function q(){var d=void 0!==arguments[0]?arguments[0]:null,c=void 0!==arguments[1]?arguments[1]:[],g=void 0!==arguments[2]?arguments[2]:{},f=[];return d&&d.items?d=d.items:Array.isArray(d)||(d=c),G(d)?F(d,function(l,h){var i=g["string"==typeof l?l:h];i||(i=l),G(l)?E(i,l):"string"==typeof i&&(i={name:i}),void 0===i.key&&(i.key=h),f.push(i)}):z(d,function(l,h){var i=g[l];!i&&k.indexOf(l)>=0||(i||(i={name:l,key:h+""}),G(l)&&E(i,l),void 0===i.key&&(i.key=h),f.push(i))}),f}Object.defineProperties(v,{ItemsFactory:{get:function(){return w}},__esModule:{value:!0}});var j,y,I,x=(j=C("helpers/object"),j&&j.__esModule&&j||{"default":j}),F=x.objectEach,G=x.isObject,E=x.extend,z=(y=C("helpers/array"),y&&y.__esModule&&y||{"default":y}).arrayEach,D=(I=C("predefinedItems"),I&&I.__esModule&&I||{"default":I}),B=D.SEPARATOR,k=D.ITEMS,A=D.predefinedItems,w=function(d){var c=void 0!==arguments[1]?arguments[1]:null;this.hot=d,this.predefinedItems=A(),this.defaultOrderPattern=c};$traceurRuntime.createClass(w,{setPredefinedItems:function(d){var c=this,f={};this.defaultOrderPattern.length=0,F(d,function(h,i){var g="";h.name===B?(f[B]=h,g=B):isNaN(parseInt(i,10))?(h.key=void 0===h.key?i:h.key,f[i]=h,g=h.key):(f[h.key]=h,g=h.key),c.defaultOrderPattern.push(g)}),this.predefinedItems=f},getItems:function(){var c=void 0!==arguments[0]?arguments[0]:null;return q(c,this.defaultOrderPattern,this.predefinedItems)}},{})},{"helpers/array":42,"helpers/object":52,predefinedItems:72}],71:[function(aG,ar,ax){Object.defineProperties(ax,{Menu:{get:function(){return al}},__esModule:{value:!0}});var aw,au,aC,at,az,aK,aq,aI,aD,aH,aF,av,aE=(aw=aG("browser"),aw&&aw.__esModule&&aw||{"default":aw})["default"],ay=(au=aG("helpers/dom/element"),au&&au.__esModule&&au||{"default":au}),ao=ay.addClass,ap=ay.empty,am=ay.fastInnerHTML,aJ=ay.getScrollbarWidth,ai=ay.isChildOf,aL=ay.removeClass,U=(aC=aG("helpers/array"),aC&&aC.__esModule&&aC||{"default":aC}),Q=U.arrayEach,ag=U.arrayFilter,K=U.arrayReduce,ab=(at=aG("cursor"),at&&at.__esModule&&at||{"default":at}).Cursor,Z=(az=aG("eventManager"),az&&az.__esModule&&az||{"default":az}).EventManager,aA=(aK=aG("helpers/object"),aK&&aK.__esModule&&aK||{"default":aK}).mixin,ae=(aq=aG("helpers/function"),aq&&aq.__esModule&&aq||{"default":aq}).debounce,ah=(aI=aG("utils"),aI&&aI.__esModule&&aI||{"default":aI}),ak=ah.filterSeparators,an=ah.hasSubMenu,X=ah.isDisabled,aa=ah.isItemHidden,ac=ah.isSeparator,G=ah.isSelectionDisabled,ad=ah.normalizeSelection,aB=(aD=aG("helpers/unicode"),aD&&aD.__esModule&&aD||{"default":aD}).KEY_CODES,J=(aH=aG("mixins/localHooks"),aH&&aH.__esModule&&aH||{"default":aH}).localHooks,af=(aF=aG("predefinedItems"),aF&&aF.__esModule&&aF||{"default":aF}).SEPARATOR,aj=(av=aG("helpers/dom/event"),av&&av.__esModule&&av||{"default":av}).stopImmediatePropagation,al=function(d,c){this.hot=d,this.options=c||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1},this.eventManager=new Z(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()},q=al;$traceurRuntime.createClass(al,{registerEvents:function(){var c=this;this.eventManager.addEventListener(document.documentElement,"mousedown",function(d){return c.onDocumentMouseDown(d)})},setMenuItems:function(c){this.menuItems=c},setOffset:function(d){var c=void 0!==arguments[1]?arguments[1]:0;this.offset[d]=c},isSubMenu:function(){return null!==this.parentMenu},open:function(){var d=this;this.container.removeAttribute("style"),this.container.style.display="block";var c=ae(function(e){return d.openSubMenu(e)},300),g=ag(this.menuItems,function(e){return aa(e,d.hot)});g=ak(g,af);var f={data:g,colHeaders:!1,colWidths:[200],autoRowSize:!1,readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:function(h,m,l,k,e,j){return d.menuItemRenderer(h,m,l,k,e,j)}}],renderAllRows:!0,fragmentSelection:"cell",disableVisualSelection:"area",beforeKeyDown:function(e){return d.onBeforeKeyDown(e)},afterOnCellMouseOver:function(i,h,e){d.isAllSubMenusClosed()?c(h.row):d.openSubMenu(h.row)}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new aE.Core(this.container,f),this.hotMenu.addHook("afterInit",function(){return d.onAfterInit()}),this.hotMenu.init(),this.hotMenu.listen(),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")},close:function(){var c=void 0!==arguments[0]?arguments[0]:!1;this.isOpened()&&(c&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose")))},openSubMenu:function(d){if(!this.hotMenu){return !1}var c=this.hotMenu.getCell(d,0);if(this.closeAllSubMenus(),!c||!an(c)){return !1}var g=this.hotMenu.getSourceDataAtRow(d),f=new q(this.hot,{parent:this,name:g.name,className:this.options.className,keepInViewport:!0});return f.setMenuItems(g.submenu.items),f.open(),f.setPosition(c.getBoundingClientRect()),this.hotSubMenus[g.key]=f,f},closeSubMenu:function(d){var c=this.hotMenu.getSourceDataAtRow(d),f=this.hotSubMenus[c.key];f&&(f.destroy(),delete this.hotSubMenus[c.key])},closeAllSubMenus:function(){var c=this;Q(this.hotMenu.getData(),function(d,e){return c.closeSubMenu(e)})},isAllSubMenusClosed:function(){return 0===Object.keys(this.hotSubMenus).length},destroy:function(){this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy()},isOpened:function(){return null!==this.hotMenu},executeCommand:function(d){if(this.isOpened()&&this.hotMenu.getSelected()){var c=this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelected()[0]);if(this.runLocalHooks("select",c,d),c.isCommand!==!1&&c.name!==af){var g=this.hot.getSelectedRange(),f=g?ad(g):{};this.runLocalHooks("executeCommand",c.key,f,d),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",c.key,f,d),c.disabled===!0||"function"==typeof c.disabled&&c.disabled.call(this.hot)===!0||c.submenu||this.close(!0)}}},setPosition:function(d){var c=new ab(d);this.options.keepInViewport?(c.fitsBelow(this.container)?this.setPositionBelowCursor(c):c.fitsAbove(this.container)?this.setPositionAboveCursor(c):this.setPositionBelowCursor(c),c.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(c):this.setPositionOnLeftOfCursor(c)):(this.setPositionBelowCursor(c),this.setPositionOnRightOfCursor(c))},setPositionAboveCursor:function(d){var c=this.offset.above+d.top-this.container.offsetHeight;this.isSubMenu()&&(c=d.top+d.cellHeight-this.container.offsetHeight+3),this.container.style.top=c+"px"},setPositionBelowCursor:function(d){var c=this.offset.below+d.top;this.isSubMenu()&&(c=d.top-1),this.container.style.top=c+"px"},setPositionOnRightOfCursor:function(d){var c;c=this.isSubMenu()?1+d.left+d.cellWidth:this.offset.right+1+d.left,this.container.style.left=c+"px"},setPositionOnLeftOfCursor:function(d){var c=this.offset.left+d.left-this.container.offsetWidth+aJ()+4;this.container.style.left=c+"px"},selectFirstCell:function(){var c=this.hotMenu.getCell(0,0);ac(c)||X(c)||G(c)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)},selectLastCell:function(){var d=this.hotMenu.countRows()-1,c=this.hotMenu.getCell(d,0);ac(c)||X(c)||G(c)?this.selectPrevCell(d,0):this.hotMenu.selectCell(d,0)},selectNextCell:function(d,c){var g=d+1,f=g<this.hotMenu.countRows()?this.hotMenu.getCell(g,c):null;f&&(ac(f)||X(f)||G(f)?this.selectNextCell(g,c):this.hotMenu.selectCell(g,c))},selectPrevCell:function(d,c){var g=d-1,f=g>=0?this.hotMenu.getCell(g,c):null;f&&(ac(f)||X(f)||G(f)?this.selectPrevCell(g,c):this.hotMenu.selectCell(g,c))},menuItemRenderer:function(v,A,j,g,f,m){var B=this,k=v.getSourceDataAtRow(j),y=document.createElement("div"),z=function(c){return c.hasOwnProperty("submenu")},x=function(c){return new RegExp(af,"i").test(c.name)},p=function(c){return c.disabled===!0||"function"==typeof c.disabled&&c.disabled.call(B.hot)===!0},w=function(c){return c.disableSelection};"function"==typeof m&&(m=m.call(this.hot)),ap(A),ao(y,"htItemWrapper"),A.appendChild(y),x(k)?ao(A,"htSeparator"):"function"==typeof k.renderer?(ao(A,"htCustomMenuRenderer"),A.appendChild(k.renderer(v,y,j,g,f,m))):am(y,m),p(k)?(ao(A,"htDisabled"),this.eventManager.addEventListener(A,"mouseenter",function(){return v.deselectCell()})):w(k)?(ao(A,"htSelectionDisabled"),this.eventManager.addEventListener(A,"mouseenter",function(){return v.deselectCell()})):z(k)?(ao(A,"htSubmenu"),w(k)?this.eventManager.addEventListener(A,"mouseenter",function(){return v.deselectCell()}):this.eventManager.addEventListener(A,"mouseenter",function(){return v.selectCell(j,g,void 0,void 0,void 0,!1)})):(aL(A,"htSubmenu"),aL(A,"htDisabled"),w(k)?this.eventManager.addEventListener(A,"mouseenter",function(){return v.deselectCell()}):this.eventManager.addEventListener(A,"mouseenter",function(){return v.selectCell(j,g,void 0,void 0,void 0,!1)}))},createContainer:function(){var d=void 0!==arguments[0]?arguments[0]:null;d&&(d=d.replace(/ /g,"_"),d=this.options.className+"Sub_"+d);var c;return c=d?document.querySelector("."+this.options.className+"."+d):document.querySelector("."+this.options.className),c||(c=document.createElement("div"),ao(c,"htMenu "+this.options.className),d&&ao(c,d),document.getElementsByTagName("body")[0].appendChild(c)),c},blockMainTableCallbacks:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)},releaseMainTableCallbacks:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)},onBeforeKeyDown:function(d){var c=this.hotMenu.getSelected(),g=!1;switch(d.keyCode){case aB.ESCAPE:this.close(),g=!0;break;case aB.ENTER:c&&(this.hotMenu.getSourceDataAtRow(c[0]).submenu?g=!0:(this.executeCommand(d),this.close(!0)));break;case aB.ARROW_DOWN:c?this.selectNextCell(c[0],c[1]):this.selectFirstCell(),g=!0;break;case aB.ARROW_UP:c?this.selectPrevCell(c[0],c[1]):this.selectLastCell(),g=!0;break;case aB.ARROW_RIGHT:if(c){var f=this.openSubMenu(c[0]);f&&f.selectFirstCell()}g=!0;break;case aB.ARROW_LEFT:c&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),g=!0)}g&&(d.preventDefault(),aj(d))},onAfterInit:function(){var f=this.hotMenu.getSettings().data,c=this.hotMenu.view.wt.wtTable.hider.style,h=this.hotMenu.view.wt.wtTable.holder.style,g=parseInt(c.width,10),d=K(f,function(j,i){return j+(i.name===af?1:26)},0);h.width=g+22+"px",h.height=d+4+"px"},onDocumentMouseDown:function(c){this.isOpened()&&(this.container&&ai(c.target,this.container)&&this.executeCommand(c),this.options.standalone&&this.hotMenu&&!ai(c.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ai(c.target,".htMenu")&&ai(c.target,document)&&this.close(!0))}},{}),aA(al,J)},{browser:23,cursor:69,eventManager:41,"helpers/array":42,"helpers/dom/element":46,"helpers/dom/event":47,"helpers/function":49,"helpers/object":52,"helpers/unicode":55,"mixins/localHooks":56,predefinedItems:72,utils:73}],72:[function(af,L,X){function W(){var c={};return ah(N,function(d,e){return c[e]=ac(d)}),c}function U(d,c){-1===F.indexOf(d)&&(N[d]=c)}var ab;Object.defineProperties(X,{ROW_ABOVE:{get:function(){return I}},ROW_BELOW:{get:function(){return B}},COLUMN_LEFT:{get:function(){return ai}},COLUMN_RIGHT:{get:function(){return Q}},CLEAR_COLUMN:{get:function(){return ak}},REMOVE_ROW:{get:function(){return x}},REMOVE_COLUMN:{get:function(){return q}},UNDO:{get:function(){return K}},REDO:{get:function(){return j}},READ_ONLY:{get:function(){return A}},ALIGNMENT:{get:function(){return z}},SEPARATOR:{get:function(){return aa}},ITEMS:{get:function(){return F}},predefinedItems:{get:function(){return W}},addItem:{get:function(){return U}},__esModule:{value:!0}});var P,Z,aj,J=(P=af("helpers/object"),P&&P.__esModule&&P||{"default":P}),ah=J.objectEach,ac=J.clone,ag=((Z=af("helpers/number"),Z&&Z.__esModule&&Z||{"default":Z}).rangeEach,aj=af("utils"),aj&&aj.__esModule&&aj||{"default":aj}),ae=ag.align,V=ag.getAlignmentClasses,ad=ag.getValidSelection,Y=ag.checkSelectionConsistency,G=ag.markLabelAsSelected,I="row_above",B="row_below",ai="col_left",Q="col_right",ak="clear_column",x="remove_row",q="remove_col",K="undo",j="redo",A="make_read_only",z="alignment",aa="---------",F=[I,B,ai,Q,ak,x,q,K,j,A,z,aa],N=(ab={},Object.defineProperty(ab,aa,{value:{name:aa},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(ab,I,{value:{key:I,name:"Insert row above",callback:function(d,c){this.alter("insert_row",c.start.row)},disabled:function(){var d=ad(this);if(!d||this.countRows()>=this.getSettings().maxRows){return !0}var c=this.countRows(),f=[0,d[1],c-1,d[1]];return f.join(",")===d.join(",")&&c>1},hidden:function(){return !this.getSettings().allowInsertRow}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(ab,B,{value:{key:B,name:"Insert row below",callback:function(d,c){this.alter("insert_row",c.end.row+1)},disabled:function(){var d=ad(this);if(!d||this.countRows()>=this.getSettings().maxRows){return !0}var c=this.countRows(),f=[0,d[1],c-1,d[1]];return f.join(",")===d.join(",")&&c>1},hidden:function(){return !this.getSettings().allowInsertRow}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(ab,ai,{value:{key:ai,name:"Insert column on the left",callback:function(d,c){this.alter("insert_col",c.start.col)},disabled:function(){var d=ad(this);if(!d){return !0}if(!this.isColumnModificationAllowed()){return !0}var c=[d[0],0,d[0],this.countCols()-1],g=c.join(",")==d.join(","),f=1==this.countCols();return d[1]<0||this.countCols()>=this.getSettings().maxCols||!f&&g},hidden:function(){return !this.getSettings().allowInsertColumn}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(ab,Q,{value:{key:Q,name:"Insert column on the right",callback:function(d,c){this.alter("insert_col",c.end.col+1)},disabled:function(){var d=ad(this);if(!d){return !0}if(!this.isColumnModificationAllowed()){return !0}var c=[d[0],0,d[0],this.countCols()-1],g=c.join(",")==d.join(","),f=1==this.countCols();return d[1]<0||this.countCols()>=this.getSettings().maxCols||!f&&g},hidden:function(){return !this.getSettings().allowInsertColumn}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(ab,ak,{value:{key:ak,name:"Clear column",callback:function(d,c){var f=c.start.col;this.countRows()&&this.populateFromArray(0,f,[[null]],Math.max(c.start.row,c.end.row),f)},disabled:function(){var d=ad(this);if(!d){return !0}var c=[d[0],0,d[0],this.countCols()-1],f=c.join(",")==d.join(",");return d[1]<0||this.countCols()>=this.getSettings().maxCols||f}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(ab,x,{value:{key:x,name:"Remove row",callback:function(d,c){var f=c.end.row-c.start.row+1;this.alter("remove_row",c.start.row,f)},disabled:function(){var d=ad(this);if(!d||this.selection.selectedHeader.cols){return !0}var c=[0,d[1],this.countRows()-1,d[1]];return c.join(",")===d.join(",")},hidden:function(){return !this.getSettings().allowRemoveRow}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(ab,q,{value:{key:q,name:"Remove column",callback:function(d,c){var f=c.end.col-c.start.col+1;this.alter("remove_col",c.start.col,f)},disabled:function(){var d=ad(this);if(!d||this.selection.selectedHeader.rows){return !0}if(!this.isColumnModificationAllowed()){return !0}var c=[d[0],0,d[0],this.countCols()-1],f=c.join(",")==d.join(",");return d[1]<0||f},hidden:function(){return !this.getSettings().allowRemoveColumn}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(ab,K,{value:{key:K,name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(ab,j,{value:{key:j,name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(ab,A,{value:{key:A,name:function(){var d=this,c="Read only",f=Y(this.getSelectedRange(),function(e,g){return d.getCellMeta(e,g).readOnly});return f&&(c=G(c)),c},callback:function(){var d=this,c=this.getSelectedRange(),f=Y(c,function(e,g){return d.getCellMeta(e,g).readOnly});c.forAll(function(e,g){d.getCellMeta(e,g).readOnly=!f}),this.render()},disabled:function(){return !this.getSelectedRange()}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(ab,z,{value:{key:z,name:"Alignment",disabled:function(){return !this.getSelectedRange()},submenu:{items:[{key:z+":left",name:function(){var d=this,c="Left",f=Y(this.getSelectedRange(),function(e,h){var g=d.getCellMeta(e,h).className;return g&&-1!==g.indexOf("htLeft")?!0:void 0});return f&&(c=G(c)),c},callback:function(){var f=this,c=this.getSelectedRange(),h=V(c,function(e,i){return f.getCellMeta(e,i).className}),g="horizontal",d="htLeft";this.runHooks("beforeCellAlignment",h,c,g,d),ae(c,g,d,function(e,i){return f.getCellMeta(e,i)}),this.render()},disabled:!1},{key:z+":center",name:function(){var d=this,c="Center",f=Y(this.getSelectedRange(),function(e,h){var g=d.getCellMeta(e,h).className;return g&&-1!==g.indexOf("htCenter")?!0:void 0});return f&&(c=G(c)),c},callback:function(){var f=this,c=this.getSelectedRange(),h=V(c,function(e,i){return f.getCellMeta(e,i).className}),g="horizontal",d="htCenter";this.runHooks("beforeCellAlignment",h,c,g,d),ae(c,g,d,function(e,i){return f.getCellMeta(e,i)}),this.render()},disabled:!1},{key:z+":right",name:function(){var d=this,c="Right",f=Y(this.getSelectedRange(),function(e,h){var g=d.getCellMeta(e,h).className;return g&&-1!==g.indexOf("htRight")?!0:void 0});return f&&(c=G(c)),c},callback:function(){var f=this,c=this.getSelectedRange(),h=V(c,function(e,i){return f.getCellMeta(e,i).className}),g="horizontal",d="htRight";this.runHooks("beforeCellAlignment",h,c,g,d),ae(c,g,d,function(e,i){return f.getCellMeta(e,i)}),this.render()},disabled:!1},{key:z+":justify",name:function(){var d=this,c="Justify",f=Y(this.getSelectedRange(),function(e,h){var g=d.getCellMeta(e,h).className;return g&&-1!==g.indexOf("htJustify")?!0:void 0});return f&&(c=G(c)),c},callback:function(){var f=this,c=this.getSelectedRange(),h=V(c,function(e,i){return f.getCellMeta(e,i).className}),g="horizontal",d="htJustify";this.runHooks("beforeCellAlignment",h,c,g,d),ae(c,g,d,function(e,i){return f.getCellMeta(e,i)}),this.render()},disabled:!1},{name:aa},{key:z+":top",name:function(){var d=this,c="Top",f=Y(this.getSelectedRange(),function(e,h){var g=d.getCellMeta(e,h).className;return g&&-1!==g.indexOf("htTop")?!0:void 0});return f&&(c=G(c)),c},callback:function(){var f=this,c=this.getSelectedRange(),h=V(c,function(e,i){return f.getCellMeta(e,i).className}),g="vertical",d="htTop";this.runHooks("beforeCellAlignment",h,c,g,d),ae(c,g,d,function(e,i){return f.getCellMeta(e,i)}),this.render()},disabled:!1},{key:z+":middle",name:function(){var d=this,c="Middle",f=Y(this.getSelectedRange(),function(e,h){var g=d.getCellMeta(e,h).className;return g&&-1!==g.indexOf("htMiddle")?!0:void 0});return f&&(c=G(c)),c},callback:function(){var f=this,c=this.getSelectedRange(),h=V(c,function(e,i){return f.getCellMeta(e,i).className}),g="vertical",d="htMiddle";this.runHooks("beforeCellAlignment",h,c,g,d),ae(c,g,d,function(e,i){return f.getCellMeta(e,i)}),this.render()},disabled:!1},{key:z+":bottom",name:function(){var d=this,c="Bottom",f=Y(this.getSelectedRange(),function(e,h){var g=d.getCellMeta(e,h).className;return g&&-1!==g.indexOf("htBottom")?!0:void 0});return f&&(c=G(c)),c},callback:function(){var f=this,c=this.getSelectedRange(),h=V(c,function(e,i){return f.getCellMeta(e,i).className}),g="vertical",d="htBottom";this.runHooks("beforeCellAlignment",h,c,g,d),ae(c,g,d,function(e,i){return f.getCellMeta(e,i)}),this.render()},disabled:!1}]}},configurable:!0,enumerable:!0,writable:!0}),ab)},{"helpers/number":51,"helpers/object":52,utils:73}],73:[function(V,F,L){function K(c){return{start:c.getTopLeftCorner(),end:c.getBottomRightCorner()}}function I(c){return D(c,"htSeparator")}function O(c){return D(c,"htSubmenu")}function G(c){return D(c,"htDisabled")}function N(c){return D(c,"htSelectionDisabled")}function Z(d){var c=d.getSelected();return c?c[0]<0?null:c:null}function B(d,c){return -1!=d.indexOf(c)?d:(d=d.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),d+=" "+c)}function X(d,c){return -1!=d.indexOf(c)?d:(d=d.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),d+=" "+c)}function P(f,c){for(var h={},g=f.from.row;g<=f.to.row;g++){for(var d=f.from.col;d<=f.to.col;d++){h[g]||(h[g]=[]),h[g][d]=c(g,d)}}return h}function W(g,d,l,h){if(g.from.row==g.to.row&&g.from.col==g.to.col){U(g.from.row,g.from.col,d,l,h)}else{for(var f=g.from.row;f<=g.to.row;f++){for(var c=g.from.col;c<=g.to.col;c++){U(f,c,d,l,h)}}}}function U(h,d,m,l,g){var c=g(h,d),f=l;c.className&&(f="vertical"===m?B(c.className,l):X(c.className,l)),c.className=f}function J(d,c){var f=!1;return d&&d.forAll(function(g,h){return c(g,h)?(f=!0,!1):void 0}),f}function Q(c){return'<span class="selected">'+String.fromCharCode(10003)+"</span>"+c}function M(d,c){return !d.hidden||!("function"==typeof d.hidden&&d.hidden.call(c))}function z(d,c){for(var g=d.slice(0),f=0;f<g.length&&g[f].name===c;){g.shift()}return g}function A(d,c){var f=d.slice(0);return f.reverse(),f=z(f,c),f.reverse(),f}function x(d){var c=[];return k(d,function(f,g){g>0?c[c.length-1].name!==f.name&&c.push(f):c.push(f)}),c}function Y(d){var c=void 0!==arguments[1]?arguments[1]:j,f=d.slice(0);return f=z(f,c),f=A(f,c),f=x(f)}Object.defineProperties(L,{normalizeSelection:{get:function(){return K}},isSeparator:{get:function(){return I}},hasSubMenu:{get:function(){return O}},isDisabled:{get:function(){return G}},isSelectionDisabled:{get:function(){return N}},getValidSelection:{get:function(){return Z}},prepareVerticalAlignClass:{get:function(){return B}},prepareHorizontalAlignClass:{get:function(){return X}},getAlignmentClasses:{get:function(){return P}},align:{get:function(){return W}},checkSelectionConsistency:{get:function(){return J}},markLabelAsSelected:{get:function(){return Q}},isItemHidden:{get:function(){return M}},filterSeparators:{get:function(){return Y}},__esModule:{value:!0}});var H,aa,q,k=(H=V("helpers/array"),H&&H.__esModule&&H||{"default":H}).arrayEach,D=(aa=V("helpers/dom/element"),aa&&aa.__esModule&&aa||{"default":aa}).hasClass,j=(q=V("predefinedItems"),q&&q.__esModule&&q||{"default":q}).SEPARATOR},{"helpers/array":42,"helpers/dom/element":46,predefinedItems:72}],74:[function(J,x,C){Object.defineProperties(C,{ContextMenuCopyPaste:{get:function(){return j}},__esModule:{value:!0}});var B,z,F,y,E,M,q,L=(B=J("browser"),B&&B.__esModule&&B||{"default":B})["default"],G=(z=J("helpers/dom/element"),z&&z.__esModule&&z||{"default":z}).removeClass,K=(F=J("helpers/array"),F&&F.__esModule&&F||{"default":F}).arrayEach,I=(y=J("eventManager"),y&&y.__esModule&&y||{"default":y}).EventManager,A=(E=J("plugins"),E&&E.__esModule&&E||{"default":E}).registerPlugin,H=(M=J("_base"),M&&M.__esModule&&M||{"default":M})["default"],D=(q=J("zeroclipboard"),q&&q.__esModule&&q||{"default":q})["default"],j=function(c){$traceurRuntime.superConstructor(k).call(this,c),this.eventManager=new I(this),this.swfPath=null,this.outsideClickDeselectsCache=null},k=j;$traceurRuntime.createClass(j,{isEnabled:function(){return this.hot.getSettings().contextMenuCopyPaste},enablePlugin:function(){var d=this;if(!this.enabled){"object"==typeof this.hot.getSettings().contextMenuCopyPaste&&(this.swfPath=this.hot.getSettings().contextMenuCopyPaste.swfPath),"undefined"==typeof D&&console.error("To be able to use the Copy/Paste feature from the context menu, you need to manually include ZeroClipboard.js file to your website.");try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(c){"undefined"==typeof navigator.mimeTypes["application/x-shockwave-flash"]&&console.error("To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.")}this.swfPath&&D.config({swfPath:this.swfPath}),this.hot.addHook("afterContextMenuShow",function(){return d.onAfterContextMenuShow()}),this.hot.addHook("afterContextMenuDefaultOptions",function(e){return d.onAfterContextMenuDefaultOptions(e)}),this.registerEvents(),$traceurRuntime.superGet(this,k.prototype,"enablePlugin").call(this)}},disablePlugin:function(){$traceurRuntime.superGet(this,k.prototype,"disablePlugin").call(this)},registerEvents:function(){var c=this;this.eventManager.addEventListener(document,"mouseenter",function(){return c.removeCurrentClass()}),this.eventManager.addEventListener(document,"mouseleave",function(){return c.removeZeroClipboardClass()})},getCopyValue:function(){return this.hot.copyPaste.setCopyableText(),this.hot.copyPaste.copyPasteInstance.elTextarea.value},onAfterContextMenuDefaultOptions:function(c){c.items.unshift({key:"copy",name:"Copy"},{key:"paste",name:"Paste",callback:function(){this.copyPaste.triggerPaste()}},L.plugins.ContextMenu.SEPARATOR)},onAfterContextMenuShow:function(){var d=this,c=this.hot.getPlugin("contextMenu"),f=c.menu.hotMenu.getSourceData();K(f,function(h,g){if("copy"===h.key){var e=new D(c.menu.hotMenu.getCell(g,0));return e.off(),e.on("copy",function(i){var l=i.clipboardData;l.setData("text/plain",d.getCopyValue()),d.hot.getSettings().outsideClickDeselects=d.outsideClickDeselectsCache}),!1}})},removeCurrentClass:function(){var d=this.hot.getPlugin("contextMenu");if(d.menu.isOpened()){var c=d.menu.hotMenu.rootElement.querySelector("td.current");c&&G(c,"current")}this.outsideClickDeselectsCache=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1},removeZeroClipboardClass:function(){var d=this.hot.getPlugin("contextMenu");if(d.menu.isOpened()){var c=d.menu.hotMenu.rootElement.querySelector("td.zeroclipboard-is-hover");c&&G(c,"zeroclipboard-is-hover")}this.hot.getSettings().outsideClickDeselects=this.outsideClickDeselectsCache}},{},H),A("contextMenuCopyPaste",j)},{_base:60,browser:23,eventManager:41,"helpers/array":42,"helpers/dom/element":46,plugins:59,zeroclipboard:"zeroclipboard"}],75:[function(af,L,X){function W(f){function c(){f.isListening()&&f.selection.empty()}function h(M){var m,k,e,v,O,p,E,H,D,w;if(f.isListening()&&f.selection.isSelected()){m=M,k=B.parse(m),e=f.getSelected(),v=new F(e[0],e[1]),O=new F(e[2],e[3]),p=new N(v,v,O),E=p.getTopLeftCorner(),H=p.getBottomRightCorner(),D=E,w=new F(Math.max(H.row,k.length-1+E.row),Math.max(H.col,k[0].length-1+E.col));var C=O.row-v.row>=k.length-1,y=O.col-v.col>=k[0].length-1;f.addHookOnce("afterChange",function(s,S){var R=s?s.length:0;if(R){var u={row:0,col:0},l=-1;x(s,function(o,r){var i=R>r+1?s[r+1]:null;i&&(C||(u.row=u.row+Math.max(i[0]-o[0]-1,0)),!y&&o[1]>l&&(l=o[1],u.col=u.col+Math.max(i[1]-o[1]-1,0)))}),f.selectCell(D.row,D.col,w.row+u.row,w.col+u.col)}}),f.populateFromArray(D.row,D.col,k,w.row,w.col,"paste",f.getSettings().pasteMode)}}function g(e){if(f.getSelected()&&!(f.getActiveEditor()&&f.getActiveEditor().isOpened()||A(e))){if(ak(e.keyCode)){if(f.getSettings().fragmentSelection&&z()){return}return d.setCopyableText(),void j(e)}var i=(e.ctrlKey||e.metaKey)&&!e.altKey;e.keyCode==Q.A&&i&&f._registerTimeout(setTimeout(aa(d.setCopyableText,d),0))}}var d=this;this.copyPasteInstance=I(),this.copyPasteInstance.onCut(c),this.copyPasteInstance.onPaste(h),this.onPaste=h,f.addHook("beforeKeyDown",g),this.destroy=function(){this.copyPasteInstance&&(this.copyPasteInstance.removeCallback(c),this.copyPasteInstance.removeCallback(h),this.copyPasteInstance.destroy(),this.copyPasteInstance=null),f.removeHook("beforeKeyDown",g)},f.addHook("afterDestroy",aa(this.destroy,this)),this.triggerPaste=aa(this.copyPasteInstance.triggerPaste,this.copyPasteInstance),this.triggerCut=aa(this.copyPasteInstance.triggerCut,this.copyPasteInstance),this.setCopyableText=function(){var R=f.getSettings(),v=R.copyRowsLimit,m=R.copyColsLimit,e=f.getSelectedRange(),y=e.getTopLeftCorner(),S=e.getBottomRightCorner(),w=y.row,M=y.col,O=S.row,H=S.col,C=Math.min(O,w+v-1),E=Math.min(H,M+m-1),D=[];D.push({startRow:w,startCol:M,endRow:C,endCol:E}),D=G.hooks.run(f,"modifyCopyableRange",D);var k=this.getRangedCopyableData(D);f.copyPaste.copyPasteInstance.copyable(k),O===C&&H===E||G.hooks.run(f,"afterCopyLimit",O-w+1,H-M+1,v,m)},this.getRangedCopyableData=function(e){var l=[],k=[],i=[];return x(e,function(m){q(m.startRow,m.endRow,function(n){-1===k.indexOf(n)&&k.push(n)}),q(m.startCol,m.endCol,function(n){-1===i.indexOf(n)&&i.push(n)})}),x(k,function(m){var n=[];x(i,function(o){n.push(f.getCopyableData(m,o))}),l.push(n)}),B.stringify(l)}}function U(){var d=this,c=d.getSettings().copyPaste!==!1;c&&!d.copyPaste?d.copyPaste=new W(d):!c&&d.copyPaste&&(d.copyPaste.destroy(),d.copyPaste=null)}Object.defineProperties(X,{CopyPastePlugin:{get:function(){return W}},__esModule:{value:!0}});var ab,P,Z,aj,J,ah,ac,ag,ae,V,ad,Y,G=(ab=af("browser"),ab&&ab.__esModule&&ab||{"default":ab})["default"],I=(P=af("copyPaste"),P&&P.__esModule&&P||{"default":P})["default"],B=(Z=af("SheetClip"),Z&&Z.__esModule&&Z||{"default":Z})["default"],ai=(aj=af("helpers/unicode"),aj&&aj.__esModule&&aj||{"default":aj}),Q=ai.KEY_CODES,ak=ai.isCtrlKey,x=(J=af("helpers/array"),J&&J.__esModule&&J||{"default":J}).arrayEach,q=(ah=af("helpers/number"),ah&&ah.__esModule&&ah||{"default":ah}).rangeEach,K=(ac=af("helpers/dom/event"),ac&&ac.__esModule&&ac||{"default":ac}),j=K.stopImmediatePropagation,A=K.isImmediatePropagationStopped,z=(ag=af("helpers/dom/element"),ag&&ag.__esModule&&ag||{"default":ag}).getSelectionText,aa=(ae=af("helpers/function"),ae&&ae.__esModule&&ae||{"default":ae}).proxy,F=((V=af("plugins"),V&&V.__esModule&&V||{"default":V}).registerPlugin,(ad=af("3rdparty/walkontable/src/cell/coords"),ad&&ad.__esModule&&ad||{"default":ad}).WalkontableCellCoords),N=(Y=af("3rdparty/walkontable/src/cell/range"),Y&&Y.__esModule&&Y||{"default":Y}).WalkontableCellRange;G.hooks.add("afterInit",U),G.hooks.add("afterUpdateSettings",U),G.hooks.register("afterCopyLimit"),G.hooks.register("modifyCopyableRange")},{"3rdparty/walkontable/src/cell/coords":5,"3rdparty/walkontable/src/cell/range":6,SheetClip:"SheetClip",browser:23,copyPaste:"copyPaste","helpers/array":42,"helpers/dom/element":46,"helpers/dom/event":47,"helpers/function":49,"helpers/number":51,"helpers/unicode":55,plugins:59}],76:[function(ad,K,V){function U(){}var P,Z,L,X,ah,I=(P=ad("browser"),P&&P.__esModule&&P||{"default":P})["default"],af=((Z=ad("plugins"),Z&&Z.__esModule&&Z||{"default":Z}).registerPlugin,(L=ad("3rdparty/walkontable/src/cell/range"),L&&L.__esModule&&L||{"default":L}).WalkontableCellRange),aa=(X=ad("3rdparty/walkontable/src/selection"),X&&X.__esModule&&X||{"default":X}).WalkontableSelection,ae=function(c){return"boolean"==typeof c&&c===!0?!0:"object"==typeof c&&c.length>0},ac=function(){ae(this.getSettings().customBorders)&&(this.customBorders||(ah=this,this.customBorders=new U))},Q=function(d){for(var c=0;c<ah.view.wt.selections.length;c++){if(ah.view.wt.selections[c].settings.className==d){return c}}return -1},ab=function(d){var c={row:d.row,col:d.col},g=new aa(d,new af(c,c,c)),f=Q(d.className);f>=0?ah.view.wt.selections[f]=g:ah.view.wt.selections.push(g)},W=function(d,c,g){var f=ai(d,c);f=x(f,g),this.setCellMeta(d,c,"borders",f),ab(f)},F=function(g){for(var d=g.range,k=d.from.row;k<=d.to.row;k++){for(var h=d.from.col;h<=d.to.col;h++){var f=ai(k,h),c=0;k==d.from.row&&(c++,g.hasOwnProperty("top")&&(f.top=g.top)),k==d.to.row&&(c++,g.hasOwnProperty("bottom")&&(f.bottom=g.bottom)),h==d.from.col&&(c++,g.hasOwnProperty("left")&&(f.left=g.left)),h==d.to.col&&(c++,g.hasOwnProperty("right")&&(f.right=g.right)),c>0&&(this.setCellMeta(k,h,"borders",f),ab(f))}}},G=function(d,c){return"border_row"+d+"col"+c},B=function(){return{width:1,color:"#000"}},ag=function(){return{hide:!0}},N=function(){return{width:1,color:"#000",cornerVisible:!1}},ai=function(d,c){return{className:G(d,c),border:N(),row:d,col:c,top:ag(),right:ag(),bottom:ag(),left:ag()}},x=function(d,c){return c.hasOwnProperty("border")&&(d.border=c.border),c.hasOwnProperty("top")&&(d.top=c.top),c.hasOwnProperty("right")&&(d.right=c.right),c.hasOwnProperty("bottom")&&(d.bottom=c.bottom),c.hasOwnProperty("left")&&(d.left=c.left),d},q=function(d){for(var c=document.querySelectorAll("."+d),g=0;g<c.length;g++){if(c[g]&&"TD"!=c[g].nodeName){var f=c[g].parentNode;f.parentNode&&f.parentNode.removeChild(f)}}},J=function(d,c){var f=G(d,c);q(f),this.removeCellMeta(d,c,"borders")},j=function(g,d,k,h){var f=this.getCellMeta(g,d).borders;f&&void 0!=f.border||(f=ai(g,d)),h?f[k]=ag():f[k]=B(),this.setCellMeta(g,d,"borders",f);var c=G(g,d);q(c),ab(f),this.render()},A=function(k,p,f){if(k.from.row==k.to.row&&k.from.col==k.to.col){"noBorders"==p?J.call(this,k.from.row,k.from.col):j.call(this,k.from.row,k.from.col,p,f)}else{switch(p){case"noBorders":for(var d=k.from.col;d<=k.to.col;d++){for(var c=k.from.row;c<=k.to.row;c++){J.call(this,c,d)}}break;case"top":for(var h=k.from.col;h<=k.to.col;h++){j.call(this,k.from.row,h,p,f)}break;case"right":for(var u=k.from.row;u<=k.to.row;u++){j.call(this,u,k.to.col,p)}break;case"bottom":for(var g=k.from.col;g<=k.to.col;g++){j.call(this,k.to.row,g,p)}break;case"left":for(var m=k.from.row;m<=k.to.row;m++){j.call(this,m,k.from.col,p)}}}},z=function(d,c){var f=!1;return d.getSelectedRange().forAll(function(h,g){var e=d.getCellMeta(h,g).borders;if(e){if(!c){return f=!0,!1}if(!e[c].hasOwnProperty("hide")){return f=!0,!1}}}),f},Y=function(c){return'<span class="selected">'+String.fromCharCode(10003)+"</span>"+c},D=function(c){this.getSettings().customBorders&&(c.items.push(I.plugins.ContextMenu.SEPARATOR),c.items.push({key:"borders",name:"Borders",submenu:{items:[{key:"borders:top",name:function(){var f="Top",d=z(this,"top");return d&&(f=Y(f)),f},callback:function(){var d=z(this,"top");A.call(this,this.getSelectedRange(),"top",d)},disabled:!1},{key:"borders:right",name:function(){var f="Right",d=z(this,"right");return d&&(f=Y(f)),f},callback:function(){var d=z(this,"right");A.call(this,this.getSelectedRange(),"right",d)},disabled:!1},{key:"borders:bottom",name:function(){var f="Bottom",d=z(this,"bottom");return d&&(f=Y(f)),f},callback:function(){var d=z(this,"bottom");A.call(this,this.getSelectedRange(),"bottom",d)},disabled:!1},{key:"borders:left",name:function(){var f="Left",d=z(this,"left");return d&&(f=Y(f)),f},callback:function(){var d=z(this,"left");A.call(this,this.getSelectedRange(),"left",d)},disabled:!1},{key:"borders:no_borders",name:"Remove border(s)",callback:function(){A.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return !z(this)}}]}}))};I.hooks.add("beforeInit",ac),I.hooks.add("afterContextMenuDefaultOptions",D),I.hooks.add("afterInit",function(){var d=this.getSettings().customBorders;if(d){for(var c=0;c<d.length;c++){d[c].range?F.call(this,d[c]):W.call(this,d[c].row,d[c].col,d[c])}this.render(),this.view.wt.draw(!0)}}),I.CustomBorders=U},{"3rdparty/walkontable/src/cell/range":6,"3rdparty/walkontable/src/selection":18,browser:23,plugins:59}],77:[function(k,v,g){function f(){this.boundaries=null,this.callback=null}Object.defineProperties(g,{DragToScroll:{get:function(){return f}},__esModule:{value:!0}});var d,j,w,h=(d=k("browser"),d&&d.__esModule&&d||{"default":d})["default"],p=(j=k("eventManager"),j&&j.__esModule&&j||{"default":j}).eventManager;(w=k("plugins"),w&&w.__esModule&&w||{"default":w}).registerPlugin;h.plugins.DragToScroll=f,f.prototype.setBoundaries=function(c){this.boundaries=c},f.prototype.setCallback=function(c){this.callback=c},f.prototype.check=function(i,c){var r=0,l=0;c<this.boundaries.top?l=c-this.boundaries.top:c>this.boundaries.bottom&&(l=c-this.boundaries.bottom),i<this.boundaries.left?r=i-this.boundaries.left:i>this.boundaries.right&&(r=i-this.boundaries.right),this.callback(r,l)};var q,m=function(i){i.dragToScrollListening=!1;var c=i.view.wt.wtTable.holder;q=new f,c!==window&&(q.setBoundaries(c.getBoundingClientRect()),q.setCallback(function(l,o){0>l?c.scrollLeft-=50:l>0&&(c.scrollLeft+=50),0>o?c.scrollTop-=20:o>0&&(c.scrollTop+=20)}),i.dragToScrollListening=!0)};h.hooks.add("afterInit",function(){var i=this,c=p(this);c.addEventListener(document,"mouseup",function(){i.dragToScrollListening=!1}),c.addEventListener(document,"mousemove",function(e){i.dragToScrollListening&&q.check(e.clientX,e.clientY)})}),h.hooks.add("afterDestroy",function(){p(this).clear()}),h.hooks.add("afterOnCellMouseDown",function(){m(this)}),h.hooks.add("afterOnCellCornerMouseDown",function(){m(this)}),h.plugins.DragToScroll=f},{browser:23,eventManager:41,plugins:59}],78:[function(k,v,g){Object.defineProperties(g,{ManualColumnFreeze:{get:function(){return q}},__esModule:{value:!0}});var f,d,j,w=(f=k("browser"),f&&f.__esModule&&f||{"default":f})["default"],h=(d=k("_base"),d&&d.__esModule&&d||{"default":d})["default"],p=(j=k("plugins"),j&&j.__esModule&&j||{"default":j}).registerPlugin,q=function(c){$traceurRuntime.superConstructor(m).call(this,c),this.manualColumnMovePlugin=null,this.frozenColumnsBasePositions=[]},m=q;$traceurRuntime.createClass(q,{isEnabled:function(){return !!this.hot.getSettings().manualColumnFreeze},enablePlugin:function(){var c=this;this.enabled||(this.addHook("modifyCol",function(e){return c.onModifyCol(e)}),this.addHook("afterContextMenuDefaultOptions",function(e){return c.addContextMenuEntry(e)}),$traceurRuntime.superGet(this,m.prototype,"enablePlugin").call(this))},init:function(){$traceurRuntime.superGet(this,m.prototype,"init").call(this),this.fixedColumnsCount=this.hot.getSettings().fixedColumnsLeft},getManualColumnMovePlugin:function(){return this.manualColumnMovePlugin||(this.manualColumnMovePlugin=this.hot.getPlugin("manualColumnMove")),this.manualColumnMovePlugin},onModifyCol:function(c){return this.getManualColumnMovePlugin().isEnabled()?c:this.getLogicalColumnIndex(c)},addContextMenuEntry:function(i){var c=this;i.items.push(w.plugins.ContextMenu.SEPARATOR,{key:"freeze_column",name:function(){var l=c.hot.getSelected()[1];return l>c.fixedColumnsCount-1?"Freeze this column":"Unfreeze this column"},disabled:function(){var l=c.hot.getSelected();return l[1]!==l[3]},callback:function(){var l=c.hot.getSelected()[1];l>c.fixedColumnsCount-1?c.freezeColumn(l):c.unfreezeColumn(l)}})},freezeColumn:function(c){c<=this.fixedColumnsCount-1||(c!==this.getLogicalColumnIndex(c)&&(this.frozenColumnsBasePositions[this.fixedColumnsCount]=c),this.changeColumnPositions(c,this.fixedColumnsCount),this.addFixedColumn(),this.hot.view.wt.wtOverlays.leftOverlay.refresh(),this.hot.view.wt.wtOverlays.adjustElementsSize())},unfreezeColumn:function(i){if(!(i>this.fixedColumnsCount-1)){var c=this.getBestColumnReturnPosition(i);this.changeColumnPositions(i,c),this.removeFixedColumn(),this.hot.view.wt.wtOverlays.leftOverlay.refresh(),this.hot.view.wt.wtOverlays.adjustElementsSize()}},addFixedColumn:function(){this.hot.updateSettings({fixedColumnsLeft:this.fixedColumnsCount+1}),this.fixedColumnsCount++},removeFixedColumn:function(){this.hot.updateSettings({fixedColumnsLeft:this.fixedColumnsCount-1}),this.fixedColumnsCount--},getBestColumnReturnPosition:function(i){var c,r=this.fixedColumnsCount,l=this.getLogicalColumnIndex(r);if(null==this.frozenColumnsBasePositions[i]){for(c=this.getLogicalColumnIndex(i);c>l;){r++,l=this.getLogicalColumnIndex(r)}}else{for(c=this.frozenColumnsBasePositions[i],this.frozenColumnsBasePositions[i]=void 0;c>=l;){r++,l=this.getLogicalColumnIndex(r)}r=l}return r-1},getVisibleColumnIndex:function(c){return this.getManualColumnMovePlugin().getVisibleColumnIndex(c)},getLogicalColumnIndex:function(c){return this.getManualColumnMovePlugin().getLogicalColumnIndex(c)},changeColumnPositions:function(i,c){this.getManualColumnMovePlugin().changeColumnPositions(i,c)}},{},h),p("manualColumnFreeze",q)},{_base:60,browser:23,plugins:59}],79:[function(Z,H,P){Object.defineProperties(P,{ManualColumnMove:{get:function(){return z}},__esModule:{value:!0}});var N,K,V,I,U,ad,F,ab,W=(N=Z("_base.js"),N&&N.__esModule&&N||{"default":N})["default"],aa=(K=Z("browser"),K&&K.__esModule&&K||{"default":K})["default"],Y=(V=Z("helpers/dom/element"),V&&V.__esModule&&V||{"default":V}),L=Y.addClass,X=Y.hasClass,Q=Y.removeClass,B=Y.outerHeight,D=(I=Z("helpers/array"),I&&I.__esModule&&I||{"default":I}),A=D.arrayEach,ac=D.arrayMap,J=(U=Z("helpers/number"),U&&U.__esModule&&U||{"default":U}).rangeEach,ae=(ad=Z("eventManager"),ad&&ad.__esModule&&ad||{"default":ad}).eventManager,q=(F=Z("helpers/dom/event"),F&&F.__esModule&&F||{"default":F}),k=q.pageX,G=(q.pageY,(ab=Z("plugins"),ab&&ab.__esModule&&ab||{"default":ab}).registerPlugin),j=new WeakMap,z=function(d){var c=this;$traceurRuntime.superConstructor(x).call(this,d),j.set(this,{guideClassName:"manualColumnMoverGuide",handleClassName:"manualColumnMover",startOffset:null,pressed:null,startCol:null,endCol:null,currentCol:null,startX:null,startY:null}),this.guideElement=null,this.handleElement=null,this.currentTH=null,this.columnPositions=[],this.eventManager=ae(this),this.addHook("init",function(){return c.onInit()})},x=z;$traceurRuntime.createClass(z,{isEnabled:function(){return !!this.hot.getSettings().manualColumnMove},enablePlugin:function(){var d=this,c=j.get(this),g=this.hot.getSettings().manualColumnMove,f=this.loadManualColumnPositions();this.handleElement=document.createElement("DIV"),this.handleElement.className=c.handleClassName,this.guideElement=document.createElement("DIV"),this.guideElement.className=c.guideClassName,this.addHook("modifyCol",function(e){return d.onModifyCol(e)}),this.addHook("unmodifyCol",function(e){return d.onUnmodifyCol(e)}),this.addHook("afterRemoveCol",function(e,h){return d.onAfterRemoveCol(e,h)}),this.addHook("afterCreateCol",function(e,h){return d.onAfterCreateCol(e,h)}),this.registerEvents(),"undefined"!=typeof f?this.columnPositions=f:Array.isArray(g)?this.columnPositions=g:g&&void 0!==this.columnPositions||(this.columnPositions=[]),$traceurRuntime.superGet(this,x.prototype,"enablePlugin").call(this)},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,x.prototype,"updatePlugin").call(this)},disablePlugin:function(){var c=this.hot.getSettings().manualColumnMove;Array.isArray(c)&&(this.unregisterEvents(),this.columnPositions=[]),$traceurRuntime.superGet(this,x.prototype,"disablePlugin").call(this)},registerEvents:function(){var c=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(d){return c.onMouseOver(d)}),this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(d){return c.onMouseDown(d)}),this.eventManager.addEventListener(window,"mousemove",function(d){return c.onMouseMove(d)}),this.eventManager.addEventListener(window,"mouseup",function(d){return c.onMouseUp(d)})},unregisterEvents:function(){this.eventManager.clear()},saveManualColumnPositions:function(){aa.hooks.run(this.hot,"persistentStateSave","manualColumnPositions",this.columnPositions)},loadManualColumnPositions:function(){var c={};return aa.hooks.run(this.hot,"persistentStateLoad","manualColumnPositions",c),c.value},completeSettingsArray:function(){var d=this,c=this.hot.countCols();this.columnPositions.length!==c&&J(0,c-1,function(e){-1===d.columnPositions.indexOf(e)&&d.columnPositions.push(e)})},setupHandlePosition:function(f){this.currentTH=f;var c=j.get(this),h=this.hot.view.wt.wtTable.getCoords(f).col,g=B(this.currentTH);if(h>=0){var d=this.currentTH.getBoundingClientRect();c.currentCol=h,c.startOffset=d.left,this.handleElement.style.top=d.top+"px",this.handleElement.style.left=c.startOffset+"px",this.handleElement.style.height=g+"px",this.hot.rootElement.appendChild(this.handleElement)}},refreshHandlePosition:function(d,c){var g=d.getBoundingClientRect(),f=6;c>0?this.handleElement.style.left=g.left+g.width-f+"px":this.handleElement.style.left=g.left+"px"},setupGuidePosition:function(){var f=this.currentTH.getBoundingClientRect(),c=j.get(this),h=parseInt(B(this.handleElement),10),g=parseInt(this.handleElement.style.top,10)+h,d=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);L(this.handleElement,"active"),L(this.guideElement,"active"),this.guideElement.style.width=f.width+"px",this.guideElement.style.height=d-h+"px",this.guideElement.style.top=g+"px",this.guideElement.style.left=c.startOffset+"px",this.hot.rootElement.appendChild(this.guideElement)},refreshGuidePosition:function(d){var c=j.get(this);this.guideElement.style.left=c.startOffset+d+"px"},hideHandleAndGuide:function(){Q(this.handleElement,"active"),Q(this.guideElement,"active")},checkColumnHeader:function(d){if(d!=this.hot.rootElement){var c=d.parentNode;return"THEAD"===c.tagName?!0:this.checkColumnHeader(c)}return !1},createPositionData:function(d){var c=this.columnPositions;c.length<d&&J(c.length,d-1,function(f){c[f]=f})},getTHFromTargetElement:function(c){return"TABLE"!=c.tagName?"TH"==c.tagName?c:this.getTHFromTargetElement(c.parentNode):null},changeColumnPositions:function(d,c){var f=Math.max(d,c);f>this.columnPositions.length-1&&this.createPositionData(f+1),this.columnPositions.splice(c,0,this.columnPositions.splice(d,1)[0])},getVisibleColumnIndex:function(c){return c>this.columnPositions.length-1&&this.createPositionData(c),this.columnPositions.indexOf(c)},getLogicalColumnIndex:function(c){return this.columnPositions[c]},onMouseOver:function(d){var c=j.get(this);if(this.checkColumnHeader(d.target)){var g=this.getTHFromTargetElement(d.target);if(g){if(c.pressed){var f=this.hot.view.wt.wtTable.getCoords(g).col;f>=0&&(c.endCol=f,this.refreshHandlePosition(g,c.endCol-c.startCol))}else{this.setupHandlePosition(g)}}}},onMouseDown:function(d){var c=j.get(this);X(d.target,c.handleClassName)&&(c.startX=k(d),this.setupGuidePosition(),c.pressed=this.hot,c.startCol=c.currentCol,c.endCol=c.currentCol)},onMouseMove:function(d){var c=j.get(this);c.pressed&&this.refreshGuidePosition(k(d)-c.startX)},onMouseUp:function(d){var c=j.get(this);c.pressed&&(this.hideHandleAndGuide(),c.pressed=!1,this.createPositionData(this.hot.countCols()),this.changeColumnPositions(c.startCol,c.endCol),aa.hooks.run(this.hot,"beforeColumnMove",c.startCol,c.endCol),this.hot.forceFullRender=!0,this.hot.view.render(),this.saveManualColumnPositions(),aa.hooks.run(this.hot,"afterColumnMove",c.startCol,c.endCol),this.setupHandlePosition(this.currentTH))},onModifyCol:function(c){return -1==typeof this.getVisibleColumnIndex(c)&&this.createPositionData(c+1),this.getLogicalColumnIndex(c)},onUnmodifyCol:function(c){return -1==typeof this.getVisibleColumnIndex(c)&&this.createPositionData(c+1),this.getVisibleColumnIndex(c)},onAfterRemoveCol:function(d,c){if(this.isEnabled()){var g,f=this.columnPositions;g=f.splice(d,c),f=ac(f,function(i,h){var l=i;return A(g,function(e,m){i>e&&l--}),l}),this.columnPositions=f}},onAfterCreateCol:function(d,c){if(this.isEnabled()){var g=this.columnPositions;if(g.length){var f=[];J(0,c-1,function(e){f.push(d+e)}),d>=g.length?g.concat(f):(g=ac(g,function(h,e){return h>=d?h+c:h}),g.splice.apply(g,[d,0].concat(f))),this.columnPositions=g}}},onInit:function(){this.completeSettingsArray()}},{},W),G("manualColumnMove",z),aa.hooks.register("beforeColumnMove"),aa.hooks.register("afterColumnMove"),aa.hooks.register("unmodifyCol")},{"_base.js":60,browser:23,eventManager:41,"helpers/array":42,"helpers/dom/element":46,"helpers/dom/event":47,"helpers/number":51,plugins:59}],80:[function(T,D,K){Object.defineProperties(K,{ManualColumnResize:{get:function(){return j}},__esModule:{value:!0}});var J,H,N,F,M,X,A,V,O=(J=T("browser"),J&&J.__esModule&&J||{"default":J})["default"],U=(H=T("_base.js"),H&&H.__esModule&&H||{"default":H})["default"],Q=(N=T("helpers/dom/element"),N&&N.__esModule&&N||{"default":N}),I=Q.addClass,P=Q.hasClass,L=Q.removeClass,x=Q.outerHeight,z=(F=T("eventManager"),F&&F.__esModule&&F||{"default":F}).eventManager,q=(M=T("helpers/dom/event"),M&&M.__esModule&&M||{"default":M}),W=q.pageX,G=(q.pageY,(X=T("helpers/array"),X&&X.__esModule&&X||{"default":X}).arrayEach),Y=(A=T("helpers/number"),A&&A.__esModule&&A||{"default":A}).rangeEach,k=(V=T("plugins"),V&&V.__esModule&&V||{"default":V}).registerPlugin,j=function(c){$traceurRuntime.superConstructor(B).call(this,c),this.currentTH=null,this.currentCol=null,this.selectedCols=[],this.currentWidth=null,this.newSize=null,this.startY=null,this.startWidth=null,this.startOffset=null,this.handle=document.createElement("DIV"),this.guide=document.createElement("DIV"),this.eventManager=z(this),this.pressed=null,this.dblclick=0,this.autoresizeTimeout=null,this.manualColumnWidths=[],I(this.handle,"manualColumnResizer"),I(this.guide,"manualColumnResizerGuide")},B=j;$traceurRuntime.createClass(j,{isEnabled:function(){return this.hot.getSettings().manualColumnResize},enablePlugin:function(){var d=this;if(!this.enabled){this.manualColumnWidths=[];var c=this.hot.getSettings().manualColumnResize,f=this.loadManualColumnWidths();this.addHook("modifyColWidth",function(e,g){return d.onModifyColWidth(e,g)}),this.addHook("beforeStretchingColumnWidth",function(e,g){return d.onBeforeStretchingColumnWidth(e,g)}),this.addHook("beforeColumnResize",function(e,h,g){return d.onBeforeColumnResize(e,h,g)}),"undefined"!=typeof f?this.manualColumnWidths=f:Array.isArray(c)?this.manualColumnWidths=c:this.manualColumnWidths=[],O.hooks.register("beforeColumnResize"),O.hooks.register("afterColumnResize"),this.bindEvents(),$traceurRuntime.superGet(this,B.prototype,"enablePlugin").call(this)}},updatePlugin:function(){var c=this.hot.getSettings().manualColumnResize;Array.isArray(c)?this.manualColumnWidths=c:c||(this.manualColumnWidths=[])},disablePlugin:function(){$traceurRuntime.superGet(this,B.prototype,"disablePlugin").call(this)},saveManualColumnWidths:function(){this.hot.runHooks("persistentStateSave","manualColumnWidths",this.manualColumnWidths)},loadManualColumnWidths:function(){var c={};return this.hot.runHooks("persistentStateLoad","manualColumnWidths",c),c.value},setupHandlePosition:function(m){var w=this;if(!m.parentNode){return !1}this.currentTH=m;var f=this.hot.view.wt.wtTable.getCoords(m).col,d=x(this.currentTH);if(f>=0){var c=this.currentTH.getBoundingClientRect();if(this.currentCol=f,this.selectedCols=[],this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.cols){var h=this.hot.getSelectedRange(),y=h.from,g=h.to,p=y.col,v=g.col;p>=v&&(p=g.col,v=y.col),this.currentCol>=p&&this.currentCol<=v?Y(p,v,function(i){return w.selectedCols.push(i)}):this.selectedCols.push(this.currentCol)}else{this.selectedCols.push(this.currentCol)}this.startOffset=c.left-6,this.startWidth=parseInt(c.width,10),this.handle.style.top=c.top+"px",this.handle.style.left=this.startOffset+this.startWidth+"px",this.handle.style.height=d+"px",this.hot.rootElement.appendChild(this.handle)}},refreshHandlePosition:function(){this.handle.style.left=this.startOffset+this.currentWidth+"px"},setupGuidePosition:function(){var d=parseInt(x(this.handle),10),c=parseInt(this.handle.style.top,10)+d,f=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);I(this.handle,"active"),I(this.guide,"active"),this.guide.style.top=c+"px",this.guide.style.left=this.handle.style.left,this.guide.style.height=f-d+"px",this.hot.rootElement.appendChild(this.guide)},refreshGuidePosition:function(){this.guide.style.left=this.handle.style.left},hideHandleAndGuide:function(){L(this.handle,"active"),L(this.guide,"active")},checkIfColumnHeader:function(d){if(d!=this.hot.rootElement){var c=d.parentNode;return"THEAD"===c.tagName?!0:this.checkIfColumnHeader(c)}return !1},getTHFromTargetElement:function(c){return"TABLE"!=c.tagName?"TH"==c.tagName?c:this.getTHFromTargetElement(c.parentNode):null},onMouseOver:function(d){if(this.checkIfColumnHeader(d.target)){var c=this.getTHFromTargetElement(d.target);if(!c){return}var f=c.getAttribute("colspan");!c||null!==f&&1!==f||this.pressed||this.setupHandlePosition(c)}},afterMouseDownTimeout:function(){var d=this,c=function(){d.hot.forceFullRender=!0,d.hot.view.render(),d.hot.view.wt.wtOverlays.adjustElementsSize(!0)},g=function(i,h){var e=d.hot.runHooks("beforeColumnResize",i,d.newSize,!0);void 0!==e&&(d.newSize=e),"all"===d.hot.getSettings().stretchH?d.clearManualSize(i):d.setManualSize(i,d.newSize),h&&c(),d.saveManualColumnWidths(),d.hot.runHooks("afterColumnResize",i,d.newSize,!0)};if(this.dblclick>=2){var f=this.selectedCols.length;f>1?(G(this.selectedCols,function(h){g(h)}),c()):G(this.selectedCols,function(h){g(h,!0)})}this.dblclick=0,this.autoresizeTimeout=null},onMouseDown:function(d){var c=this;P(d.target,"manualColumnResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(function(){return c.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startX=W(d),this.newSize=this.startWidth)},onMouseMove:function(d){var c=this;this.pressed&&(this.currentWidth=this.startWidth+(W(d)-this.startX),G(this.selectedCols,function(f){c.newSize=c.setManualSize(f,c.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition())},onMouseUp:function(f){var c=this,h=function(){c.hot.forceFullRender=!0,c.hot.view.render(),c.hot.view.wt.wtOverlays.adjustElementsSize(!0)},g=function(i,l){c.hot.runHooks("beforeColumnResize",i,c.newSize),l&&h(),c.saveManualColumnWidths(),c.hot.runHooks("afterColumnResize",i,c.newSize)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startWidth){var d=this.selectedCols.length;d>1?(G(this.selectedCols,function(i){g(i)}),h()):G(this.selectedCols,function(i){g(i,!0)})}this.setupHandlePosition(this.currentTH)}},bindEvents:function(){var c=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(d){return c.onMouseOver(d)}),this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(d){return c.onMouseDown(d)}),this.eventManager.addEventListener(window,"mousemove",function(d){return c.onMouseMove(d)}),this.eventManager.addEventListener(window,"mouseup",function(d){return c.onMouseUp(d)})},setManualSize:function(d,c){return c=Math.max(c,20),d=this.hot.runHooks("modifyCol",d),this.manualColumnWidths[d]=c,c},clearManualSize:function(c){c=this.hot.runHooks("modifyCol",c),this.manualColumnWidths[c]=void 0},onModifyColWidth:function(d,c){return this.enabled&&(c=this.hot.runHooks("modifyCol",c),this.hot.getSettings().manualColumnResize&&this.manualColumnWidths[c])?this.manualColumnWidths[c]:d},onBeforeStretchingColumnWidth:function(d,c){var f=this.manualColumnWidths[c];return void 0===f&&(f=d),f},onBeforeColumnResize:function(){this.hot.view.wt.wtViewport.hasOversizedColumnHeadersMarked={}}},{},U),k("manualColumnResize",j)},{"_base.js":60,browser:23,eventManager:41,"helpers/array":42,"helpers/dom/element":46,"helpers/dom/event":47,"helpers/number":51,plugins:59}],81:[function(Z,H,P){Object.defineProperties(P,{ManualRowMove:{get:function(){return z}},__esModule:{value:!0}});var N,K,V,I,U,ad,F,ab,W=(N=Z("_base.js"),N&&N.__esModule&&N||{"default":N})["default"],aa=(K=Z("browser"),K&&K.__esModule&&K||{"default":K})["default"],Y=(V=Z("helpers/dom/element"),V&&V.__esModule&&V||{"default":V}),L=Y.addClass,X=Y.hasClass,Q=Y.removeClass,B=Y.outerWidth,D=(I=Z("helpers/array"),I&&I.__esModule&&I||{"default":I}),A=D.arrayEach,ac=D.arrayMap,J=(U=Z("helpers/number"),U&&U.__esModule&&U||{"default":U}).rangeEach,ae=(ad=Z("eventManager"),ad&&ad.__esModule&&ad||{"default":ad}).eventManager,q=(F=Z("helpers/dom/event"),F&&F.__esModule&&F||{"default":F}),k=(q.pageX,q.pageY),G=(ab=Z("plugins"),ab&&ab.__esModule&&ab||{"default":ab}).registerPlugin,j=new WeakMap,z=function(c){$traceurRuntime.superConstructor(x).call(this,c),j.set(this,{guideClassName:"manualRowMoverGuide",handleClassName:"manualRowMover",startOffset:null,pressed:null,startRow:null,endRow:null,currentRow:null,startX:null,startY:null}),this.guideElement=null,this.handleElement=null,this.currentTH=null,this.rowPositions=[],this.eventManager=ae(this)},x=z;$traceurRuntime.createClass(z,{isEnabled:function(){return !!this.hot.getSettings().manualRowMove},enablePlugin:function(){var d=this,c=j.get(this),g=this.hot.getSettings().manualRowMove,f=this.loadManualRowPositions();this.handleElement=document.createElement("DIV"),this.handleElement.className=c.handleClassName,this.guideElement=document.createElement("DIV"),this.guideElement.className=c.guideClassName,this.addHook("modifyRow",function(e){return d.onModifyRow(e)}),this.addHook("afterRemoveRow",function(e,h){return d.onAfterRemoveRow(e,h)}),this.addHook("afterCreateRow",function(e,h){return d.onAfterCreateRow(e,h)}),this.addHook("init",function(){return d.onInit()}),this.registerEvents(),"undefined"!=typeof f?this.rowPositions=f:Array.isArray(g)?this.rowPositions=g:g&&void 0!==this.rowPositions||(this.rowPositions=[]),$traceurRuntime.superGet(this,x.prototype,"enablePlugin").call(this)},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,x.prototype,"updatePlugin").call(this)},disablePlugin:function(){var c=this.hot.getSettings().manualRowMove;Array.isArray(c)&&(this.unregisterEvents(),this.rowPositions=[]),$traceurRuntime.superGet(this,x.prototype,"disablePlugin").call(this)},registerEvents:function(){var c=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(d){return c.onMouseOver(d)}),this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(d){return c.onMouseDown(d)}),this.eventManager.addEventListener(window,"mousemove",function(d){return c.onMouseMove(d)}),this.eventManager.addEventListener(window,"mouseup",function(d){return c.onMouseUp(d)})},unregisterEvents:function(){this.eventManager.clear()},saveManualRowPositions:function(){aa.hooks.run(this.hot,"persistentStateSave","manualRowPositions",this.rowPositions)},loadManualRowPositions:function(){var c={};return aa.hooks.run(this.hot,"persistentStateLoad","manualRowPositions",c),c.value},completeSettingsArray:function(){var d=this,c=this.hot.countRows();this.rowPositions.length!==c&&J(0,c-1,function(e){-1===d.rowPositions.indexOf(e)&&d.rowPositions.push(e)})},setupHandlePosition:function(f){this.currentTH=f;var c=j.get(this),h=this.hot.view.wt.wtTable.getCoords(f).row,g=B(this.currentTH);if(h>=0){var d=this.currentTH.getBoundingClientRect();c.currentRow=h,c.startOffset=d.top,this.handleElement.style.top=c.startOffset+"px",this.handleElement.style.left=d.left+"px",this.handleElement.style.width=g+"px",this.hot.rootElement.appendChild(this.handleElement)}},refreshHandlePosition:function(d,c){var g=d.getBoundingClientRect(),f=6;c>0?this.handleElement.style.top=g.top+g.height-f+"px":this.handleElement.style.top=g.top+"px"},setupGuidePosition:function(){var f=this.currentTH.getBoundingClientRect(),c=j.get(this),h=parseInt(B(this.handleElement),10),g=parseInt(this.handleElement.style.left,10)+h,d=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);L(this.handleElement,"active"),L(this.guideElement,"active"),this.guideElement.style.height=f.height+"px",this.guideElement.style.width=d-h+"px",this.guideElement.style.top=c.startOffset+"px",this.guideElement.style.left=g+"px",this.hot.rootElement.appendChild(this.guideElement)},refreshGuidePosition:function(d){var c=j.get(this);this.guideElement.style.top=c.startOffset+d+"px"},hideHandleAndGuide:function(){Q(this.handleElement,"active"),Q(this.guideElement,"active")},checkRowHeader:function(d){if(d!=this.hot.rootElement){var c=d.parentNode;return"TBODY"===c.tagName?!0:this.checkRowHeader(c)}return !1},createPositionData:function(d){var c=this.rowPositions;c.length<d&&J(c.length,d-1,function(f){c[f]=f})},getTHFromTargetElement:function(c){return"TABLE"!=c.tagName?"TH"==c.tagName?c:this.getTHFromTargetElement(c.parentNode):null},changeRowPositions:function(d,c){var f=Math.max(d,c);f>this.rowPositions.length-1&&this.createPositionData(f+1),this.rowPositions.splice(c,0,this.rowPositions.splice(d,1)[0])},getVisibleRowIndex:function(c){return c>this.rowPositions.length-1&&this.createPositionData(c),this.rowPositions.indexOf(c)},getLogicalRowIndex:function(c){return this.rowPositions[c]},onMouseOver:function(d){var c=j.get(this);if(this.checkRowHeader(d.target)){var f=this.getTHFromTargetElement(d.target);f&&(c.pressed?(c.endRow=this.hot.view.wt.wtTable.getCoords(f).row,this.refreshHandlePosition(f,c.endRow-c.startRow)):this.setupHandlePosition(f))}},onMouseDown:function(d){var c=j.get(this);X(d.target,c.handleClassName)&&(c.startY=k(d),this.setupGuidePosition(),c.pressed=this.hot,c.startRow=c.currentRow,c.endRow=c.currentRow)},onMouseMove:function(d){var c=j.get(this);c.pressed&&this.refreshGuidePosition(k(d)-c.startY)},onMouseUp:function(d){var c=j.get(this);c.pressed&&(this.hideHandleAndGuide(),c.pressed=!1,this.createPositionData(this.hot.countRows()),this.changeRowPositions(c.startRow,c.endRow),aa.hooks.run(this.hot,"beforeRowMove",c.startRow,c.endRow),this.hot.forceFullRender=!0,this.hot.view.render(),this.saveManualRowPositions(),aa.hooks.run(this.hot,"afterRowMove",c.startRow,c.endRow),this.setupHandlePosition(this.currentTH))},onModifyRow:function(c){return"undefined"==typeof this.getVisibleRowIndex(c)&&this.createPositionData(c+1),this.getLogicalRowIndex(c)},onAfterRemoveRow:function(d,c){if(this.isEnabled()){var g,f=this.rowPositions;g=f.splice(d,c),f=ac(f,function(i,h){var l=i;return A(g,function(e,m){i>e&&l--}),l}),this.rowPositions=f}},onAfterCreateRow:function(f,c){if(this.isEnabled()){var h=this.rowPositions;if(h.length){for(var g=[],d=0;c>d;d++){g.push(f+d)}f>=h.length?h.concat(g):(h=ac(h,function(i,e){return i>=f?i+c:i}),h.splice.apply(h,[f,0].concat(g))),this.rowPositions=h}}},onInit:function(){this.completeSettingsArray()}},{},W),G("ManualRowMove",z),aa.hooks.register("beforeRowMove"),aa.hooks.register("afterRowMove")},{"_base.js":60,browser:23,eventManager:41,"helpers/array":42,"helpers/dom/element":46,"helpers/dom/event":47,"helpers/number":51,plugins:59}],82:[function(T,D,K){Object.defineProperties(K,{ManualRowResize:{get:function(){return j}},__esModule:{value:!0}});var J,H,N,F,M,X,A,V,O=(J=T("browser"),J&&J.__esModule&&J||{"default":J})["default"],U=(H=T("_base.js"),H&&H.__esModule&&H||{"default":H})["default"],Q=(N=T("helpers/dom/element"),N&&N.__esModule&&N||{"default":N}),I=Q.addClass,P=Q.hasClass,L=Q.removeClass,x=Q.outerWidth,z=(F=T("eventManager"),F&&F.__esModule&&F||{"default":F}).eventManager,q=(M=T("helpers/dom/event"),M&&M.__esModule&&M||{"default":M}),W=(q.pageX,q.pageY),G=(X=T("helpers/array"),X&&X.__esModule&&X||{"default":X}).arrayEach,Y=(A=T("helpers/number"),A&&A.__esModule&&A||{"default":A}).rangeEach,k=(V=T("plugins"),V&&V.__esModule&&V||{"default":V}).registerPlugin,j=function(c){$traceurRuntime.superConstructor(B).call(this,c),this.currentTH=null,this.currentRow=null,this.selectedRows=[],this.currentHeight=null,this.newSize=null,this.startY=null,this.startHeight=null,this.startOffset=null,this.handle=document.createElement("DIV"),this.guide=document.createElement("DIV"),this.eventManager=z(this),this.pressed=null,this.dblclick=0,this.autoresizeTimeout=null,this.manualRowHeights=[],I(this.handle,"manualRowResizer"),I(this.guide,"manualRowResizerGuide")},B=j;$traceurRuntime.createClass(j,{isEnabled:function(){return this.hot.getSettings().manualRowResize},enablePlugin:function(){var d=this;if(!this.enabled){this.manualRowHeights=[];var c=this.hot.getSettings().manualRowResize,f=this.loadManualRowHeights();"undefined"!=typeof f?this.manualRowHeights=f:Array.isArray(c)?this.manualRowHeights=c:this.manualRowHeights=[],this.addHook("modifyRowHeight",function(e,g){return d.onModifyRowHeight(e,g)}),O.hooks.register("beforeRowResize"),O.hooks.register("afterRowResize"),this.bindEvents(),$traceurRuntime.superGet(this,B.prototype,"enablePlugin").call(this)}},updatePlugin:function(){var c=this.hot.getSettings().manualRowResize;Array.isArray(c)?this.manualRowHeights=c:c||(this.manualRowHeights=[])},disablePlugin:function(){$traceurRuntime.superGet(this,B.prototype,"disablePlugin").call(this)},saveManualRowHeights:function(){this.hot.runHooks("persistentStateSave","manualRowHeights",this.manualRowHeights)},loadManualRowHeights:function(){var c={};return this.hot.runHooks("persistentStateLoad","manualRowHeights",c),c.value},setupHandlePosition:function(m){var w=this;this.currentTH=m;var f=this.hot.view.wt.wtTable.getCoords(m).row,d=x(this.currentTH);if(f>=0){var c=this.currentTH.getBoundingClientRect();if(this.currentRow=f,this.selectedRows=[],this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.rows){var h=this.hot.getSelectedRange(),y=h.from,g=h.to,p=y.row,v=g.row;p>=v&&(p=g.row,v=y.row),this.currentRow>=p&&this.currentRow<=v?Y(p,v,function(i){return w.selectedRows.push(i)}):this.selectedRows.push(this.currentRow)}else{this.selectedRows.push(this.currentRow)}this.startOffset=c.top-6,this.startHeight=parseInt(c.height,10),this.handle.style.left=c.left+"px",this.handle.style.top=this.startOffset+this.startHeight+"px",this.handle.style.width=d+"px",this.hot.rootElement.appendChild(this.handle)}},refreshHandlePosition:function(){this.handle.style.top=this.startOffset+this.currentHeight+"px"},setupGuidePosition:function(){var d=parseInt(x(this.handle),10),c=parseInt(this.handle.style.left,10)+d,f=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);I(this.handle,"active"),I(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style.left=c+"px",this.guide.style.width=f-d+"px",this.hot.rootElement.appendChild(this.guide)},refreshGuidePosition:function(){this.guide.style.top=this.handle.style.top},hideHandleAndGuide:function(){L(this.handle,"active"),L(this.guide,"active")},checkIfRowHeader:function(d){if(d!=this.hot.rootElement){var c=d.parentNode;return"TBODY"===c.tagName?!0:this.checkIfRowHeader(c)}return !1},getTHFromTargetElement:function(c){return"TABLE"!=c.tagName?"TH"==c.tagName?c:this.getTHFromTargetElement(c.parentNode):null},onMouseOver:function(d){if(this.checkIfRowHeader(d.target)){var c=this.getTHFromTargetElement(d.target);c&&(this.pressed||this.setupHandlePosition(c))}},afterMouseDownTimeout:function(){var d=this,c=function(){d.hot.forceFullRender=!0,d.hot.view.render(),d.hot.view.wt.wtOverlays.adjustElementsSize(!0)},g=function(i,h){var e=d.hot.runHooks("beforeRowResize",i,d.newSize,!0);void 0!==e&&(d.newSize=e),d.setManualSize(i,d.newSize),h&&c(),d.hot.runHooks("afterRowResize",i,d.newSize,!0)};if(this.dblclick>=2){var f=this.selectedRows.length;f>1?(G(this.selectedRows,function(h){g(h)}),c()):G(this.selectedRows,function(h){g(h,!0)})}this.dblclick=0,this.autoresizeTimeout=null},onMouseDown:function(d){var c=this;P(d.target,"manualRowResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null==this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(function(){return c.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startY=W(d),this.newSize=this.startHeight)},onMouseMove:function(d){var c=this;this.pressed&&(this.currentHeight=this.startHeight+(W(d)-this.startY),G(this.selectedRows,function(f){c.newSize=c.setManualSize(f,c.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())},onMouseUp:function(f){var c=this,h=function(){c.hot.forceFullRender=!0,c.hot.view.render(),c.hot.view.wt.wtOverlays.adjustElementsSize(!0)},g=function(i,l){c.hot.runHooks("beforeRowResize",i,c.newSize),l&&h(),c.saveManualRowHeights(),c.hot.runHooks("afterRowResize",i,c.newSize)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startHeight){var d=this.selectedRows.length;d>1?(G(this.selectedRows,function(i){g(i)}),h()):G(this.selectedRows,function(i){g(i,!0)})}this.setupHandlePosition(this.currentTH)}},bindEvents:function(){var c=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(d){return c.onMouseOver(d)}),this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(d){return c.onMouseDown(d)}),this.eventManager.addEventListener(window,"mousemove",function(d){return c.onMouseMove(d)}),this.eventManager.addEventListener(window,"mouseup",function(d){return c.onMouseUp(d)})},setManualSize:function(d,c){return d=this.hot.runHooks("modifyRow",d),this.manualRowHeights[d]=c,c},onModifyRowHeight:function(f,c){if(this.enabled){var h=this.hot.getPlugin("autoRowSize"),g=h?h.heights[c]:null;c=this.hot.runHooks("modifyRow",c);var d=this.manualRowHeights[c];if(void 0!==d&&(d===g||d>(f||0))){return d}}return f}},{},U),k("manualRowResize",j)},{"_base.js":60,browser:23,eventManager:41,"helpers/array":42,"helpers/dom/element":46,"helpers/dom/event":47,"helpers/number":51,plugins:59}],83:[function(aj,Q,ab){function aa(){var c=[];return c.getInfo=function(f,d){for(var h=0,g=this.length;g>h;h++){if(this[h].row<=f&&this[h].row+this[h].rowspan-1>=f&&this[h].col<=d&&this[h].col+this[h].colspan-1>=d){return this[h]}}},c.setInfo=function(f){for(var d=0,g=this.length;g>d;d++){if(this[d].row===f.row&&this[d].col===f.col){return void (this[d]=f)}}this.push(f)},c.removeInfo=function(f,d){for(var h=0,g=this.length;g>h;h++){if(this[h].row===f&&this[h].col===d){this.splice(h,1);break}}},c}function X(d){if(this.mergedCellInfoCollection=new aa,Array.isArray(d)){for(var c=0,f=d.length;f>c;c++){this.mergedCellInfoCollection.setInfo(d[c])}}}function af(d,c){var g=this.getSettings().mergeCells;if(g&&!this.selection.isMultiple()){var f=this.mergeCells.mergedCellInfoCollection.getInfo(d[0],d[1]);f&&(d[0]=f.row,d[1]=f.col,d[2]=f.row+f.rowspan-1,d[3]=f.col+f.colspan-1)}}function V(d,c){this.mergeCells&&this.mergeCells.shiftCollection("right",d,c)}function ad(d,c){this.mergeCells&&this.mergeCells.shiftCollection("left",d,c)}function an(d,c){this.mergeCells&&this.mergeCells.shiftCollection("down",d,c)}function N(d,c){this.mergeCells&&this.mergeCells.shiftCollection("up",d,c)}Object.defineProperties(ab,{MergeCells:{get:function(){return X}},__esModule:{value:!0}});var al,ag,ak,ai,Z,ah,ac=(al=aj("browser"),al&&al.__esModule&&al||{"default":al})["default"],K=((ag=aj("plugins"),ag&&ag.__esModule&&ag||{"default":ag}).registerPlugin,(ak=aj("helpers/dom/event"),ak&&ak.__esModule&&ak||{"default":ak}).stopImmediatePropagation),L=(ai=aj("3rdparty/walkontable/src/cell/coords"),ai&&ai.__esModule&&ai||{"default":ai}).WalkontableCellCoords,G=(Z=aj("3rdparty/walkontable/src/cell/range"),Z&&Z.__esModule&&Z||{"default":Z}).WalkontableCellRange,am=(ah=aj("3rdparty/walkontable/src/table"),ah&&ah.__esModule&&ah||{"default":ah}).WalkontableTable;X.prototype.canMergeRange=function(c){return !c.isSingle()},X.prototype.mergeRange=function(d){if(this.canMergeRange(d)){var c=d.getTopLeftCorner(),g=d.getBottomRightCorner(),f={};f.row=c.row,f.col=c.col,f.rowspan=g.row-c.row+1,f.colspan=g.col-c.col+1,this.mergedCellInfoCollection.setInfo(f)}},X.prototype.mergeOrUnmergeSelection=function(d){var c=this.mergedCellInfoCollection.getInfo(d.from.row,d.from.col);c?this.unmergeSelection(d.from):this.mergeSelection(d)},X.prototype.mergeSelection=function(c){this.mergeRange(c)},X.prototype.unmergeSelection=function(d){var c=this.mergedCellInfoCollection.getInfo(d.row,d.col);this.mergedCellInfoCollection.removeInfo(c.row,c.col)},X.prototype.applySpanProperties=function(d,c,g){var f=this.mergedCellInfoCollection.getInfo(c,g);f?f.row===c&&f.col===g?(d.setAttribute("rowspan",f.rowspan),d.setAttribute("colspan",f.colspan)):(d.removeAttribute("rowspan"),d.removeAttribute("colspan"),d.style.display="none"):(d.removeAttribute("rowspan"),d.removeAttribute("colspan"))},X.prototype.modifyTransform=function(ay,D,aq){var ap=function(d,c){return c.row>=d.row&&c.row<=d.row+d.rowspan-1},O=function(d,c){return c.col>=d.col&&c.col<=d.col+d.colspan-1},au=function(c){return new L(D.to.row+c.row,D.to.col+c.col)},H={row:aq.row,col:aq.col};if("modifyTransformStart"==ay){this.lastDesiredCoords||(this.lastDesiredCoords=new L(null,null));for(var at,aC=new L(D.highlight.row,D.highlight.col),y=this.mergedCellInfoCollection.getInfo(aC.row,aC.col),aA=0,av=this.mergedCellInfoCollection.length;av>aA;aA++){var az=this.mergedCellInfoCollection[aA];if(az=new L(az.row+az.rowspan-1,az.col+az.colspan-1),D.includes(az)){at=!0;break}}if(y){var ax=new L(y.row,y.col),T=new L(y.row+y.rowspan-1,y.col+y.colspan-1),aw=new G(ax,ax,T);aw.includes(this.lastDesiredCoords)||(this.lastDesiredCoords=new L(null,null)),H.row=this.lastDesiredCoords.row?this.lastDesiredCoords.row-aC.row:H.row,H.col=this.lastDesiredCoords.col?this.lastDesiredCoords.col-aC.col:H.col,aq.row>0?H.row=y.row+y.rowspan-1-aC.row+aq.row:aq.row<0&&(H.row=aC.row-y.row+aq.row),aq.col>0?H.col=y.col+y.colspan-1-aC.col+aq.col:aq.col<0&&(H.col=aC.col-y.col+aq.col)}var ar=new L(D.highlight.row+H.row,D.highlight.col+H.col),x=this.mergedCellInfoCollection.getInfo(ar.row,ar.col);x&&(this.lastDesiredCoords=ar,H={row:x.row-aC.row,col:x.col-aC.col})}else{if("modifyTransformEnd"==ay){for(var aA=0,av=this.mergedCellInfoCollection.length;av>aA;aA++){var aB=this.mergedCellInfoCollection[aA],ax=new L(aB.row,aB.col),T=new L(aB.row+aB.rowspan-1,aB.col+aB.colspan-1),M=new G(ax,ax,T),aD=D.getBordersSharedWith(M);if(M.isEqual(D)){D.setDirection("NW-SE")}else{if(aD.length>0){var v=D.highlight.isEqual(M.from);aD.indexOf("top")>-1?D.to.isSouthEastOf(M.from)&&v?D.setDirection("NW-SE"):D.to.isSouthWestOf(M.from)&&v&&D.setDirection("NE-SW"):aD.indexOf("bottom")>-1&&(D.to.isNorthEastOf(M.from)&&v?D.setDirection("SW-NE"):D.to.isNorthWestOf(M.from)&&v&&D.setDirection("SE-NW"))}}var ar=au(H),k=ap(aB,ar),A=O(aB,ar);D.includesRange(M)&&(M.includes(ar)||k||A)&&(k&&(H.row<0?H.row-=aB.rowspan-1:H.row>0&&(H.row+=aB.rowspan-1)),A&&(H.col<0?H.col-=aB.colspan-1:H.col>0&&(H.col+=aB.colspan-1)))}}}0!==H.row&&(aq.row=H.row),0!==H.col&&(aq.col=H.col)},X.prototype.shiftCollection=function(g,d,k){var h=[0,0];switch(g){case"right":h[0]+=1;break;case"left":h[0]-=1;break;case"down":h[1]+=1;break;case"up":h[1]-=1}for(var f=0;f<this.mergedCellInfoCollection.length;f++){var c=this.mergedCellInfoCollection[f];"right"===g||"left"===g?d<=c.col&&(c.col+=h[0]):d<=c.row&&(c.row+=h[1])}};var W=function(){var d=this,c=d.getSettings().mergeCells;c&&(d.mergeCells||(d.mergeCells=new X(c)))},ao=function(){var c=this;c.mergeCells&&(c.view.wt.wtTable.getCell=function(d){if(c.getSettings().mergeCells){var e=c.mergeCells.mergedCellInfoCollection.getInfo(d.row,d.col);e&&(d=e)}return am.prototype.getCell.call(this,d)})},z=function(){var f=this,d=f.getSettings().mergeCells;if(d){if(f.mergeCells){if(f.mergeCells.mergedCellInfoCollection=new aa,Array.isArray(d)){for(var g=0,c=d.length;c>g;g++){f.mergeCells.mergedCellInfoCollection.setInfo(d[g])}}}else{f.mergeCells=new X(d)}}else{f.mergeCells&&(f.mergeCells.mergedCellInfoCollection=new aa)}},q=function(d){if(this.mergeCells){var c=(d.ctrlKey||d.metaKey)&&!d.altKey;c&&77===d.keyCode&&(this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render(),K(d))}},P=function(c){this.getSettings().mergeCells&&(c.items.push(ac.plugins.ContextMenu.SEPARATOR),c.items.push({key:"mergeCells",name:function(){var f=this.getSelected(),d=this.mergeCells.mergedCellInfoCollection.getInfo(f[0],f[1]);return d?"Unmerge cells":"Merge cells"},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render()},disabled:function(){return !1}}))},j=function(g,d,k,h,f,c){this.mergeCells&&this.mergeCells.applySpanProperties(g,d,k)},F=function(c){return function(e){var h=this.getSettings().mergeCells;if(h){var g=this.getSelectedRange();if(this.mergeCells.modifyTransform(c,g,e),"modifyTransformEnd"===c){var f=this.countRows(),d=this.countCols();g.from.row<0?g.from.row=0:g.from.row>0&&g.from.row>=f&&(g.from.row=g.from-1),g.from.col<0?g.from.col=0:g.from.col>0&&g.from.col>=d&&(g.from.col=d-1)}}}},B=function(k){this.lastDesiredCoords=null;var v=this.getSettings().mergeCells;if(v){var f=this.getSelectedRange();f.highlight=new L(f.highlight.row,f.highlight.col),f.to=k;var d=!1;do{d=!1;for(var c=0,h=this.mergeCells.mergedCellInfoCollection.length;h>c;c++){var w=this.mergeCells.mergedCellInfoCollection[c],g=new L(w.row,w.col),m=new L(w.row+w.rowspan-1,w.col+w.colspan-1),p=new G(g,g,m);f.expandByRange(p)&&(k.row=f.to.row,k.col=f.to.col,d=!0)}}while(d)}},ae=function(v,A){if(A&&"area"==A){var g=this.getSettings().mergeCells;if(g){for(var f=this.getSelectedRange(),d=new G(f.from,f.from,f.from),m=new G(f.to,f.to,f.to),C=0,k=this.mergeCells.mergedCellInfoCollection.length;k>C;C++){var x=this.mergeCells.mergedCellInfoCollection[C],y=new L(x.row,x.col),w=new L(x.row+x.rowspan-1,x.col+x.colspan-1),p=new G(y,y,w);d.expandByRange(p)&&(v[0]=d.from.row,v[1]=d.from.col),m.expandByRange(p)&&(v[2]=m.from.row,v[3]=m.from.col)}}}},J=function(f,c,h){var g=this.getSettings().mergeCells;if(g){var d=this.mergeCells.mergedCellInfoCollection.getInfo(f,c);!d||d.row==f&&d.col==c||(h.copyable=!1)}},U=function(g){var d=this.getSettings().mergeCells;if(d){for(var k,h=this.countCols(),f=0;h>f;f++){if(k=this.mergeCells.mergedCellInfoCollection.getInfo(g.startRow,f),k&&k.row<g.startRow){return g.startRow=k.row,U.call(this,g)}if(k=this.mergeCells.mergedCellInfoCollection.getInfo(g.endRow,f)){var c=k.row+k.rowspan-1;if(c>g.endRow){return g.endRow=c,U.call(this,g)}}}}},Y=function(g){var d=this.getSettings().mergeCells;if(d){for(var k,h=this.countRows(),f=0;h>f;f++){if(k=this.mergeCells.mergedCellInfoCollection.getInfo(f,g.startColumn),k&&k.col<g.startColumn){return g.startColumn=k.col,Y.call(this,g)}if(k=this.mergeCells.mergedCellInfoCollection.getInfo(f,g.endColumn)){var c=k.col+k.colspan-1;if(c>g.endColumn){return g.endColumn=c,Y.call(this,g)}}}}},I=function(d){if(d&&this.mergeCells){var c=this.mergeCells.mergedCellInfoCollection,g=this.getSelectedRange();for(var f in c){if(g.highlight.row==c[f].row&&g.highlight.col==c[f].col&&g.to.row==c[f].row+c[f].rowspan-1&&g.to.col==c[f].col+c[f].colspan-1){return !1}}}return d};ac.hooks.add("beforeInit",W),ac.hooks.add("afterInit",ao),ac.hooks.add("afterUpdateSettings",z),ac.hooks.add("beforeKeyDown",q),ac.hooks.add("modifyTransformStart",F("modifyTransformStart")),ac.hooks.add("modifyTransformEnd",F("modifyTransformEnd")),ac.hooks.add("beforeSetRangeEnd",B),ac.hooks.add("beforeDrawBorders",ae),ac.hooks.add("afterIsMultipleSelection",I),ac.hooks.add("afterRenderer",j),ac.hooks.add("afterContextMenuDefaultOptions",P),ac.hooks.add("afterGetCellMeta",J),ac.hooks.add("afterViewportRowCalculatorOverride",U),ac.hooks.add("afterViewportColumnCalculatorOverride",Y),ac.hooks.add("afterAutofillApplyValues",af),ac.hooks.add("afterCreateCol",V),ac.hooks.add("afterRemoveCol",ad),ac.hooks.add("afterCreateRow",an),ac.hooks.add("afterRemoveRow",N),ac.MergeCells=X},{"3rdparty/walkontable/src/cell/coords":5,"3rdparty/walkontable/src/cell/range":6,"3rdparty/walkontable/src/table":20,browser:23,"helpers/dom/event":47,plugins:59}],84:[function(J,x,C){Object.defineProperties(C,{MultipleSelectionHandles:{get:function(){return j}},__esModule:{value:!0}});var B,z,F,y,E,M,q=((B=J("browser"),B&&B.__esModule&&B||{"default":B})["default"],z=J("helpers/dom/element"),z&&z.__esModule&&z||{"default":z}),L=q.getWindowScrollTop,G=q.hasClass,K=q.getWindowScrollLeft,I=(F=J("helpers/browser"),F&&F.__esModule&&F||{"default":F}).isMobileBrowser,A=(y=J("_base"),y&&y.__esModule&&y||{"default":y})["default"],H=(E=J("eventManager"),E&&E.__esModule&&E||{"default":E}).EventManager,D=(M=J("plugins"),M&&M.__esModule&&M||{"default":M}).registerPlugin,j=function(c){$traceurRuntime.superConstructor(k).call(this,c),this.dragged=[],this.eventManager=null,this.lastSetCell=null},k=j;$traceurRuntime.createClass(j,{isEnabled:function(){return I()},enablePlugin:function(){this.enabled||(this.eventManager||(this.eventManager=new H(this)),this.registerListeners(),$traceurRuntime.superGet(this,k.prototype,"enablePlugin").call(this))},registerListeners:function(){function d(f){if(1===c.dragged.length){return c.dragged.splice(0,c.dragged.length),!0}var g=c.dragged.indexOf(f);return -1==g?!1:void (0===g?c.dragged=c.dragged.slice(0,1):1==g&&(c.dragged=c.dragged.slice(-1)))}var c=this;this.eventManager.addEventListener(this.hot.rootElement,"touchstart",function(f){var g;return G(f.target,"topLeftSelectionHandle-HitArea")?(g=c.hot.getSelectedRange(),c.dragged.push("topLeft"),c.touchStartRange={width:g.getWidth(),height:g.getHeight(),direction:g.getDirection()},f.preventDefault(),!1):G(f.target,"bottomRightSelectionHandle-HitArea")?(g=c.hot.getSelectedRange(),c.dragged.push("bottomRight"),c.touchStartRange={width:g.getWidth(),height:g.getHeight(),direction:g.getDirection()},f.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.hot.rootElement,"touchend",function(e){return G(e.target,"topLeftSelectionHandle-HitArea")?(d.call(c,"topLeft"),c.touchStartRange=void 0,e.preventDefault(),!1):G(e.target,"bottomRightSelectionHandle-HitArea")?(d.call(c,"bottomRight"),c.touchStartRange=void 0,e.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.hot.rootElement,"touchmove",function(w){var m,g,f,t,P,p,N,O=L(),v=K();0!==c.dragged.length&&(m=document.elementFromPoint(w.touches[0].screenX-v,w.touches[0].screenY-O),m&&m!==c.lastSetCell&&("TD"!=m.nodeName&&"TH"!=m.nodeName||(g=c.hot.getCoords(m),-1==g.col&&(g.col=0),f=c.hot.getSelectedRange(),t=f.getWidth(),P=f.getHeight(),p=f.getDirection(),1==t&&1==P&&c.hot.selection.setRangeEnd(g),N=c.getCurrentRangeCoords(f,g,c.touchStartRange.direction,p,c.dragged[0]),null!==N.start&&c.hot.selection.setRangeStart(N.start),c.hot.selection.setRangeEnd(N.end),c.lastSetCell=m),w.preventDefault()))})},getCurrentRangeCoords:function(m,w,f,d,c){var h=m.getTopLeftCorner(),N=m.getBottomRightCorner(),g=m.getBottomLeftCorner(),p=m.getTopRightCorner(),v={start:null,end:null};switch(f){case"NE-SW":switch(d){case"NE-SW":case"NW-SE":v="topLeft"==c?{start:new WalkontableCellCoords(w.row,m.highlight.col),end:new WalkontableCellCoords(g.row,w.col)}:{start:new WalkontableCellCoords(m.highlight.row,w.col),end:new WalkontableCellCoords(w.row,h.col)};break;case"SE-NW":"bottomRight"==c&&(v={start:new WalkontableCellCoords(N.row,w.col),end:new WalkontableCellCoords(w.row,h.col)})}break;case"NW-SE":switch(d){case"NE-SW":"topLeft"==c?v={start:w,end:g}:v.end=w;break;case"NW-SE":"topLeft"==c?v={start:w,end:N}:v.end=w;break;case"SE-NW":"topLeft"==c?v={start:w,end:h}:v.end=w;break;case"SW-NE":"topLeft"==c?v={start:w,end:p}:v.end=w}break;case"SW-NE":switch(d){case"NW-SE":v="bottomRight"==c?{start:new WalkontableCellCoords(w.row,h.col),end:new WalkontableCellCoords(g.row,w.col)}:{start:new WalkontableCellCoords(h.row,w.col),end:new WalkontableCellCoords(w.row,N.col)};break;case"SW-NE":v="topLeft"==c?{start:new WalkontableCellCoords(m.highlight.row,w.col),end:new WalkontableCellCoords(w.row,N.col)}:{start:new WalkontableCellCoords(w.row,h.col),end:new WalkontableCellCoords(h.row,w.col)};break;case"SE-NW":"bottomRight"==c?v={start:new WalkontableCellCoords(w.row,p.col),end:new WalkontableCellCoords(h.row,w.col)}:"topLeft"==c&&(v={start:g,end:w})}break;case"SE-NW":switch(d){case"NW-SE":case"NE-SW":case"SW-NE":"topLeft"==c&&(v.end=w);break;case"SE-NW":"topLeft"==c?v.end=w:v={start:w,end:h}}}return v},isDragged:function(){return this.dragged.length>0}},{},A),D("multipleSelectionHandles",j)},{_base:60,browser:23,eventManager:41,"helpers/browser":43,"helpers/dom/element":46,plugins:59}],85:[function(p,x,g){Object.defineProperties(g,{DataObserver:{get:function(){return m}},__esModule:{value:!0}});var f,d,k,y,j=(f=p("jsonpatch"),f&&f.__esModule&&f||{"default":f})["default"],v=(d=p("../../mixins/localHooks"),d&&d.__esModule&&d||{"default":d}).localHooks,w=(k=p("../../helpers/object"),k&&k.__esModule&&k||{"default":k}).mixin,q=(y=p("utils"),y&&y.__esModule&&y||{"default":y}).cleanPatches,m=function(c){this.observedData=null,this.observer=null,this.paused=!1,this.setObservedData(c)};$traceurRuntime.createClass(m,{setObservedData:function(h){var c=this;this.observer&&j.unobserve(this.observedData,this.observer),this.observedData=h,this.observer=j.observe(this.observedData,function(i){return c.onChange(i)})},isPaused:function(){return this.paused},pause:function(){this.paused=!0},resume:function(){this.paused=!1},onChange:function(c){this.runLocalHooks("change",q(c))},destroy:function(){j.unobserve(this.observedData,this.observer),this.observedData=null,this.observer=null}},{}),w(m,v)},{"../../helpers/object":52,"../../mixins/localHooks":56,jsonpatch:"jsonpatch",utils:87}],86:[function(A,F,q){Object.defineProperties(q,{ObserveChanges:{get:function(){return k}},__esModule:{value:!0}});var m,j,w,G,v,D,E=(m=A("browser"),m&&m.__esModule&&m||{"default":m})["default"],C=(j=A("_base"),j&&j.__esModule&&j||{"default":j})["default"],x=((w=A("jsonpatch"),w&&w.__esModule&&w||{"default":w})["default"],(G=A("dataObserver"),G&&G.__esModule&&G||{"default":G}).DataObserver),B=(v=A("helpers/array"),v&&v.__esModule&&v||{"default":v}).arrayEach,z=(D=A("plugins"),D&&D.__esModule&&D||{"default":D}).registerPlugin;E.hooks.register("afterChangesObserved");var k=function(c){$traceurRuntime.superConstructor(y).call(this,c),this.observer=null},y=k;$traceurRuntime.createClass(k,{isEnabled:function(){return this.hot.getSettings().observeChanges},enablePlugin:function(){var c=this;this.enabled||(this.observer||(this.observer=new x(this.hot.getSourceData()),this._exposePublicApi()),this.observer.addLocalHook("change",function(d){return c.onDataChange(d)}),this.addHook("afterCreateRow",function(){return c.onAfterTableAlter()}),this.addHook("afterRemoveRow",function(){return c.onAfterTableAlter()}),this.addHook("afterCreateCol",function(){return c.onAfterTableAlter()}),this.addHook("afterRemoveCol",function(){return c.onAfterTableAlter()}),this.addHook("afterChange",function(d,e){return c.onAfterTableAlter(e)}),this.addHook("afterLoadData",function(d){return c.onAfterLoadData(d)}),$traceurRuntime.superGet(this,y.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.observer&&(this.observer.destroy(),this.observer=null,this._deletePublicApi()),$traceurRuntime.superGet(this,y.prototype,"disablePlugin").call(this)},onDataChange:function(d){var c=this;if(!this.observer.isPaused()){var f={add:function(g){isNaN(g.col)?c.hot.runHooks("afterCreateRow",g.row):c.hot.runHooks("afterCreateCol",g.col)},remove:function(g){isNaN(g.col)?c.hot.runHooks("afterRemoveRow",g.row,1):c.hot.runHooks("afterRemoveCol",g.col,1)},replace:function(g){c.hot.runHooks("afterChange",[g.row,g.col,null,g.value],"external")}};B(d,function(g){f[g.op]&&f[g.op](g)}),this.hot.render()}this.hot.runHooks("afterChangesObserved")},onAfterTableAlter:function(d){var c=this;"loadData"!==d&&(this.observer.pause(),this.hot.addHookOnce("afterChangesObserved",function(){return c.observer.resume()}))},onAfterLoadData:function(c){c||this.observer.setObservedData(this.hot.getSourceData())},destroy:function(){this.observer&&(this.observer.destroy(),this._deletePublicApi()),$traceurRuntime.superGet(this,y.prototype,"destroy").call(this)},_exposePublicApi:function(){var d=this,c=this.hot;c.pauseObservingChanges=function(){return d.observer.pause()},c.resumeObservingChanges=function(){return d.observer.resume()},c.isPausedObservingChanges=function(){return d.observer.isPaused()}},_deletePublicApi:function(){var c=this.hot;delete c.pauseObservingChanges,delete c.resumeObservingChanges,delete c.isPausedObservingChanges}},{},C),z("observeChanges",k)},{_base:60,browser:23,dataObserver:85,"helpers/array":42,jsonpatch:"jsonpatch",plugins:59}],87:[function(j,m,f){function d(l){var i=[];return l=g(l,function(n){return/[\/]length/gi.test(n.path)?!1:!!c(n.path)}),l=k(l,function(o){var n=c(o.path);return o.row=n.row,o.col=n.col,o}),l=g(l,function(n){if(-1!==["add","remove"].indexOf(n.op)&&!isNaN(n.col)){if(-1!==i.indexOf(n.col)){return !1}i.push(n.col)}return !0}),i.length=0,l}function c(q){var i=q.match(/^\/(\d+)\/?(.*)?$/);if(!i){return null}var u=i,s=u[1],l=u[2];return{row:parseInt(s,10),col:/^\d*$/.test(l)?parseInt(l,10):l}}Object.defineProperties(f,{cleanPatches:{get:function(){return d}},parsePath:{get:function(){return c}},__esModule:{value:!0}});var h,p=(h=j("../../helpers/array"),h&&h.__esModule&&h||{"default":h}),g=p.arrayFilter,k=p.arrayMap},{"../../helpers/array":42}],88:[function(j,m,f){function d(q){var i,u=function(){window.localStorage[q+"__persistentStateKeys"]=JSON.stringify(i)},s=function(){var r=window.localStorage[q+"__persistentStateKeys"],e="string"==typeof r?JSON.parse(r):void 0;i=e?e:[]},l=function(){i=[],u()};s(),this.saveValue=function(n,e){window.localStorage[q+"_"+n]=JSON.stringify(e),-1==i.indexOf(n)&&(i.push(n),u())},this.loadValue=function(e,v){e="undefined"==typeof e?v:e;var r=window.localStorage[q+"_"+e];return"undefined"==typeof r?void 0:JSON.parse(r)},this.reset=function(e){window.localStorage.removeItem(q+"_"+e)},this.resetAll=function(){for(var e=0;e<i.length;e++){window.localStorage.removeItem(q+"_"+i[e])}l()}}function c(){function s(){var n=this;for(var i in q){q.hasOwnProperty(i)&&n.addHook(i,q[i])}}function o(){var n=this;for(var i in q){q.hasOwnProperty(i)&&n.removeHook(i,q[i])}}var u=this;this.init=function(){var n=this,e=n.getSettings().persistentState;return u.enabled=!!e,u.enabled?(n.storage||(n.storage=new d(n.rootElement.id)),n.resetState=u.resetValue,void s.call(n)):void o.call(n)},this.saveValue=function(r,i){var v=this;v.storage.saveValue(r,i)},this.loadValue=function(r,i){var v=this;i.value=v.storage.loadValue(r)},this.resetValue=function(n){var i=this;"undefined"==typeof n?i.storage.resetAll():i.storage.reset(n)};var q={persistentStateSave:u.saveValue,persistentStateLoad:u.loadValue,persistentStateReset:u.resetValue};for(var l in q){q.hasOwnProperty(l)&&g.hooks.register(l)}}Object.defineProperties(f,{HandsontablePersistentState:{get:function(){return c}},__esModule:{value:!0}});var h,p,g=(h=j("browser"),h&&h.__esModule&&h||{"default":h})["default"],k=((p=j("plugins"),p&&p.__esModule&&p||{"default":p}).registerPlugin,new c);g.hooks.add("beforeInit",k.init),g.hooks.add("afterUpdateSettings",k.init)},{browser:23,plugins:59}],89:[function(y,D,m){function k(){var d=this,c=!!d.getSettings().search;c?d.search=new q.Search(d):delete d.search}var g,v,E,q=(g=y("browser"),g&&g.__esModule&&g||{"default":g})["default"],B=(v=y("helpers/dom/element"),v&&v.__esModule&&v||{"default":v}),C=B.addClass,A=B.removeClass,w=(E=y("renderers"),E&&E.__esModule&&E||{"default":E}),z=w.registerRenderer,x=w.getRenderer;q.Search=function(c){this.query=function(P,G,F){var e=c.countRows(),H=c.countCols(),Q=[];G||(G=q.Search.global.getDefaultCallback()),F||(F=q.Search.global.getDefaultQueryMethod());for(var N=0;e>N;N++){for(var O=0;H>O;O++){var M=c.getDataAtCell(N,O),I=c.getCellMeta(N,O),L=I.search.callback||G,K=I.search.queryMethod||F,l=K(P,M);if(l){var J={row:N,col:O,data:M};Q.push(J)}L&&L(c,N,O,M,l)}}return Q}},q.Search.DEFAULT_CALLBACK=function(f,c,i,h,d){f.getCellMeta(c,i).isSearchResult=d},q.Search.DEFAULT_QUERY_METHOD=function(d,c){return"undefined"!=typeof d&&null!=d&&d.toLowerCase&&0!==d.length?"undefined"==typeof c||null==c?!1:-1!=c.toString().toLowerCase().indexOf(d.toLowerCase()):!1},q.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",q.Search.global=function(){var d=q.Search.DEFAULT_CALLBACK,c=q.Search.DEFAULT_QUERY_METHOD,f=q.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return d},setDefaultCallback:function(e){d=e},getDefaultQueryMethod:function(){return c},setDefaultQueryMethod:function(h){c=h},getDefaultSearchResultClass:function(){return f},setDefaultSearchResultClass:function(h){f=h}}}(),q.SearchCellDecorator=function(p,f,F,u,l,d,h){var c=null!==h.search&&"object"==typeof h.search&&h.search.searchResultClass||q.Search.global.getDefaultSearchResultClass();h.isSearchResult?C(f,c):A(f,c)};var j=x("base");z("base",function(l,d,u,p,h,c,f){j.apply(this,arguments),q.SearchCellDecorator.apply(this,arguments)}),q.hooks.add("afterInit",k),q.hooks.add("afterUpdateSettings",k)},{browser:23,"helpers/dom/element":46,renderers:92}],90:[function(y,D,m){Object.defineProperties(m,{TouchScroll:{get:function(){return x}},__esModule:{value:!0}});var k,g,v,E,q=(k=y("browser"),k&&k.__esModule&&k||{"default":k})["default"],B=(g=y("helpers/dom/element"),g&&g.__esModule&&g||{"default":g}),C=B.addClass,A=B.removeClass,w=(v=y("_base"),v&&v.__esModule&&v||{"default":v})["default"],z=(E=y("plugins"),E&&E.__esModule&&E||{"default":E}).registerPlugin,x=function(d){var c=this;$traceurRuntime.superConstructor(j).call(this,d),this.hot.addHook("afterInit",function(){return c.afterInit()}),this.hot.addHook("afterUpdateSettings",function(){return c.onAfterUpdateSettings()}),this.scrollbars=[],this.clones=[]},j=x;$traceurRuntime.createClass(x,{afterInit:function(){this.registerEvents(),this.onAfterUpdateSettings()},onAfterUpdateSettings:function(){var c=this;this.hot.addHookOnce("afterRender",function(){var d=c.hot.view.wt.wtOverlays;c.scrollbars=[],c.scrollbars.push(d.topOverlay),d.bottomOverlay.clone&&c.scrollbars.push(d.bottomOverlay),c.scrollbars.push(d.leftOverlay),d.topLeftCornerOverlay&&c.scrollbars.push(d.topLeftCornerOverlay),d.bottomLeftCornerOverlay&&d.bottomLeftCornerOverlay.clone&&c.scrollbars.push(d.bottomLeftCornerOverlay),c.clones=[],d.topOverlay.needFullRender&&c.clones.push(d.topOverlay.clone.wtTable.holder.parentNode),d.bottomOverlay.needFullRender&&c.clones.push(d.bottomOverlay.clone.wtTable.holder.parentNode),d.leftOverlay.needFullRender&&c.clones.push(d.leftOverlay.clone.wtTable.holder.parentNode),d.topLeftCornerOverlay&&c.clones.push(d.topLeftCornerOverlay.clone.wtTable.holder.parentNode),d.bottomLeftCornerOverlay&&d.bottomLeftCornerOverlay.clone&&c.clones.push(d.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode)})},registerEvents:function(){var c=this;this.hot.addHook("beforeTouchScroll",function(){return c.onBeforeTouchScroll()}),this.hot.addHook("afterMomentumScroll",function(){return c.onAfterMomentumScroll()})},onBeforeTouchScroll:function(){q.freezeOverlays=!0;for(var d=0,c=this.clones.length;c>d;d++){C(this.clones[d],"hide-tween")}},onAfterMomentumScroll:function(){q.freezeOverlays=!1;for(var l=this,d=0,u=this.clones.length;u>d;d++){A(this.clones[d],"hide-tween")}for(var p=0,h=this.clones.length;h>p;p++){C(this.clones[p],"show-tween")}setTimeout(function(){for(var e=0,i=l.clones.length;i>e;e++){A(l.clones[e],"show-tween")}},400);for(var c=0,f=this.scrollbars.length;f>c;c++){this.scrollbars[c].refresh(),this.scrollbars[c].resetFixedPosition()}this.hot.view.wt.wtOverlays.syncScrollWithMaster()}},{},w),z("touchScroll",x)},{_base:60,browser:23,"helpers/dom/element":46,plugins:59}],91:[function(L,z,E){function D(){var d=this,c="undefined"==typeof d.getSettings().undo||d.getSettings().undo;c?d.undoRedo||(d.undoRedo=new K.UndoRedo(d),A(d),d.addHook("beforeKeyDown",B),d.addHook("afterChange",H)):d.undoRedo&&(delete d.undoRedo,G(d),d.removeHook("beforeKeyDown",B),d.removeHook("afterChange",H))}function B(d){var c=this,f=(d.ctrlKey||d.metaKey)&&!d.altKey;f&&(89===d.keyCode||d.shiftKey&&90===d.keyCode?(c.undoRedo.redo(),j(d)):90===d.keyCode&&(c.undoRedo.undo(),j(d)))}function H(d,c){var f=this;return"loadData"==c?f.undoRedo.clear():void 0}function A(c){c.undo=function(){return c.undoRedo.undo()},c.redo=function(){return c.undoRedo.redo()},c.isUndoAvailable=function(){return c.undoRedo.isUndoAvailable()},c.isRedoAvailable=function(){return c.undoRedo.isRedoAvailable()},c.clearUndo=function(){return c.undoRedo.clear()}}function G(c){delete c.undo,delete c.redo,delete c.isUndoAvailable,delete c.isRedoAvailable,delete c.clearUndo}var O,x,N,I,M,K=(O=L("browser"),O&&O.__esModule&&O||{"default":O})["default"],C=(x=L("helpers/array"),x&&x.__esModule&&x||{"default":x}).arrayMap,J=(N=L("helpers/number"),N&&N.__esModule&&N||{"default":N}).rangeEach,F=(I=L("helpers/object"),I&&I.__esModule&&I||{"default":I}),k=F.inherit,q=F.deepClone,j=(M=L("helpers/dom/event"),M&&M.__esModule&&M||{"default":M}).stopImmediatePropagation;K.UndoRedo=function(d){var c=this;this.instance=d,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,d.addHook("afterChange",function(f,h){if(f){var g=new K.UndoRedo.ChangeAction(f);c.done(g)}}),d.addHook("afterCreateRow",function(g,i,h){if(!h){var f=new K.UndoRedo.CreateRowAction(g,i);c.done(f)}}),d.addHook("beforeRemoveRow",function(h,m){var l=c.instance.getSourceData();h=(l.length+h)%l.length;var g=l.slice(h,h+m),f=new K.UndoRedo.RemoveRowAction(h,g);c.done(f)}),d.addHook("afterCreateCol",function(g,i,h){if(!h){var f=new K.UndoRedo.CreateColumnAction(g,i);c.done(f)}}),d.addHook("beforeRemoveCol",function(v,t){var p=c.instance.getData();v=(c.instance.countCols()+v)%c.instance.countCols();var h=[],m=[],f=[];J(0,p.length-1,function(i){h[i]=p[i].slice(v,v+t)}),J(0,t-1,function(i){f.push(d.runHooks("modifyCol",v+i))}),Array.isArray(d.getSettings().colHeaders)&&J(0,t-1,function(i){m.push(d.getSettings().colHeaders[d.runHooks("modifyCol",v+i)]||null)});var e=c.instance.getPlugin("manualColumnMove"),g=new K.UndoRedo.RemoveColumnAction(f,h,m,e?e.columnPositions:[]);c.done(g)}),d.addHook("beforeCellAlignment",function(h,m,l,g){var f=new K.UndoRedo.CellAlignmentAction(h,m,l,g);c.done(f)}),d.addHook("beforeFilter",function(f){c.done(new K.UndoRedo.FiltersAction(f))})},K.UndoRedo.prototype.done=function(c){this.ignoreNewActions||(this.doneActions.push(c),this.undoneActions.length=0)},K.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var d=this.doneActions.pop();this.ignoreNewActions=!0;var c=this;d.undo(this.instance,function(){c.ignoreNewActions=!1,c.undoneActions.push(d)})}},K.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var d=this.undoneActions.pop();this.ignoreNewActions=!0;var c=this;d.redo(this.instance,function(){c.ignoreNewActions=!1,c.doneActions.push(d)})}},K.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},K.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},K.UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},K.UndoRedo.Action=function(){},K.UndoRedo.Action.prototype.undo=function(){},K.UndoRedo.Action.prototype.redo=function(){},K.UndoRedo.ChangeAction=function(c){this.changes=c},k(K.UndoRedo.ChangeAction,K.UndoRedo.Action),K.UndoRedo.ChangeAction.prototype.undo=function(h,d){for(var m=q(this.changes),l=h.countEmptyRows(!0),g=h.countEmptyCols(!0),c=0,f=m.length;f>c;c++){m[c].splice(3,1)}h.addHookOnce("afterChange",d),h.setDataAtRowProp(m,null,null,"undo");for(var c=0,f=m.length;f>c;c++){h.getSettings().minSpareRows&&m[c][0]+1+h.getSettings().minSpareRows===h.countRows()&&l==h.getSettings().minSpareRows&&(h.alter("remove_row",parseInt(m[c][0]+1,10),h.getSettings().minSpareRows),h.undoRedo.doneActions.pop()),h.getSettings().minSpareCols&&m[c][1]+1+h.getSettings().minSpareCols===h.countCols()&&g==h.getSettings().minSpareCols&&(h.alter("remove_col",parseInt(m[c][1]+1,10),h.getSettings().minSpareCols),h.undoRedo.doneActions.pop())}},K.UndoRedo.ChangeAction.prototype.redo=function(f,c){for(var h=q(this.changes),g=0,d=h.length;d>g;g++){h[g].splice(2,1)}f.addHookOnce("afterChange",c),f.setDataAtRowProp(h,null,null,"redo")},K.UndoRedo.CreateRowAction=function(d,c){this.index=d,this.amount=c},k(K.UndoRedo.CreateRowAction,K.UndoRedo.Action),K.UndoRedo.CreateRowAction.prototype.undo=function(d,c){var g=d.countRows(),f=d.getSettings().minSpareRows;this.index>=g&&this.index-f<g&&(this.index-=f),d.addHookOnce("afterRemoveRow",c),d.alter("remove_row",this.index,this.amount)},K.UndoRedo.CreateRowAction.prototype.redo=function(d,c){d.addHookOnce("afterCreateRow",c),d.alter("insert_row",this.index+1,this.amount)},K.UndoRedo.RemoveRowAction=function(d,c){this.index=d,this.data=c},k(K.UndoRedo.RemoveRowAction,K.UndoRedo.Action),K.UndoRedo.RemoveRowAction.prototype.undo=function(d,c){var f=[this.index,0];Array.prototype.push.apply(f,this.data),Array.prototype.splice.apply(d.getSourceData(),f),d.addHookOnce("afterRender",c),d.render()},K.UndoRedo.RemoveRowAction.prototype.redo=function(d,c){d.addHookOnce("afterRemoveRow",c),d.alter("remove_row",this.index,this.data.length)},K.UndoRedo.CreateColumnAction=function(d,c){this.index=d,this.amount=c},k(K.UndoRedo.CreateColumnAction,K.UndoRedo.Action),K.UndoRedo.CreateColumnAction.prototype.undo=function(d,c){d.addHookOnce("afterRemoveCol",c),d.alter("remove_col",this.index,this.amount)},K.UndoRedo.CreateColumnAction.prototype.redo=function(d,c){d.addHookOnce("afterCreateCol",c),d.alter("insert_col",this.index+1,this.amount)},K.UndoRedo.CellAlignmentAction=function(d,c,g,f){this.stateBefore=d,this.range=c,this.type=g,this.alignment=f},K.UndoRedo.CellAlignmentAction.prototype.undo=function(d,c){if(d.getPlugin("contextMenu").isEnabled()){for(var g=this.range.from.row;g<=this.range.to.row;g++){for(var f=this.range.from.col;f<=this.range.to.col;f++){d.setCellMeta(g,f,"className",this.stateBefore[g][f]||" htLeft")}}d.addHookOnce("afterRender",c),d.render()}},K.UndoRedo.CellAlignmentAction.prototype.redo=function(d,c){d.getPlugin("contextMenu").isEnabled()&&(d.selectCell(this.range.from.row,this.range.from.col,this.range.to.row,this.range.to.col),d.getPlugin("contextMenu").executeCommand("alignment:"+this.alignment.replace("ht","").toLowerCase()),d.addHookOnce("afterRender",c),d.render())},K.UndoRedo.RemoveColumnAction=function(d,c,g,f){this.indexes=d,this.data=c,this.amount=this.data[0].length,this.headers=g,this.columnPositions=f.slice(0)},k(K.UndoRedo.RemoveColumnAction,K.UndoRedo.Action),K.UndoRedo.RemoveColumnAction.prototype.undo=function(m,f){var u,p=this,h=this.indexes.slice(0).sort(),d=function(l,i,o){return o[p.indexes.indexOf(h[i])]},g=[];J(0,this.data.length-1,function(i){g[i]=C(p.data[i],d)});var c=[];c=C(this.headers,d),J(0,this.data.length-1,function(e){u=m.getSourceDataAtRow(e),J(0,h.length-1,function(i){u.splice(h[i],0,g[e][i])})}),"undefined"!=typeof this.headers&&J(0,c.length-1,function(e){m.getSettings().colHeaders.splice(h[e],0,c[e])}),m.getPlugin("manualColumnMove")&&(m.getPlugin("manualColumnMove").columnPositions=this.columnPositions),m.addHookOnce("afterRender",f),m.render()},K.UndoRedo.RemoveColumnAction.prototype.redo=function(d,c){d.addHookOnce("afterRemoveCol",c),d.alter("remove_col",d.runHooks("unmodifyCol",this.indexes[0]),this.amount)},K.UndoRedo.FiltersAction=function(c){this.formulaStacks=c},k(K.UndoRedo.FiltersAction,K.UndoRedo.Action),K.UndoRedo.FiltersAction.prototype.undo=function(d,c){var f=d.getPlugin("filters");d.addHookOnce("afterRender",c),f.formulaCollection.importAllFormulas(this.formulaStacks.slice(0,this.formulaStacks.length-1)),f.filter()},K.UndoRedo.FiltersAction.prototype.redo=function(d,c){var f=d.getPlugin("filters");d.addHookOnce("afterRender",c),f.formulaCollection.importAllFormulas(this.formulaStacks),f.filter()},K.hooks.add("afterInit",D),K.hooks.add("afterUpdateSettings",D)},{browser:23,"helpers/array":42,"helpers/dom/event":47,"helpers/number":51,"helpers/object":52}],92:[function(k,v,g){function f(i,c){var l;m[i]=c,l=q(i)+"Renderer",p.renderers[l]=c,p[l]=c,"base"===i&&(p.renderers.cellDecorator=c)}function d(c){if("function"==typeof c){return c}if("string"!=typeof c){throw Error('Only strings and functions can be passed as "renderer" parameter')}if(!(c in m)){throw Error('No editor registered under name "'+c+'"')}return m[c]}function j(c){return c in m}Object.defineProperties(g,{registerRenderer:{get:function(){return f}},getRenderer:{get:function(){return d}},hasRenderer:{get:function(){return j}},__esModule:{value:!0}});var w,h,p=(w=k("browser"),w&&w.__esModule&&w||{"default":w})["default"],q=(h=k("helpers/string"),h&&h.__esModule&&h||{"default":h}).toUpperCaseFirst,m={};p.renderers=p.renderers||{},p.renderers.registerRenderer=f,p.renderers.getRenderer=d},{browser:23,"helpers/string":54}],93:[function(j,p,f){function d(x,u,z,y,w,l,v){v.className&&(u.className?u.className=u.className+" "+v.className:u.className=v.className),v.readOnly&&g(u,v.readOnlyCellClassName),v.valid===!1&&v.invalidCellClassName?g(u,v.invalidCellClassName):k(u,v.invalidCellClassName),v.wordWrap===!1&&v.noWordWrapClassName&&g(u,v.noWordWrapClassName),!l&&v.placeholder&&g(u,v.placeholderCellClassName)}Object.defineProperties(f,{cellDecorator:{get:function(){return d}},__esModule:{value:!0}});var c,h,q=(c=j("helpers/dom/element"),c&&c.__esModule&&c||{"default":c}),g=q.addClass,k=q.removeClass,m=(h=j("renderers"),h&&h.__esModule&&h||{"default":h}).registerRenderer;m("base",d)},{"helpers/dom/element":46,renderers:92}],94:[function(H,q,A){function z(m,u,f,d,c,h,w){var g=(B.cloneNode(!0),j.cloneNode(!0));if(G("text")(m,u,f,d,c,h,w),u.appendChild(g),k(u,"htAutocomplete"),u.firstChild||u.appendChild(document.createTextNode(String.fromCharCode(160))),!m.acArrowListener){var p=E(m);m.acArrowListener=function(e){J(e.target,"htAutocompleteArrow")&&m.view.wt.getSetting("onCellDblClick",null,new F(f,d),u)},p.addEventListener(m.rootElement,"mousedown",m.acArrowListener),m.addHookOnce("afterDestroy",function(){p.destroy()})}}Object.defineProperties(A,{autocompleteRenderer:{get:function(){return z}},__esModule:{value:!0}});var x,D,v,C,K=(x=H("helpers/dom/element"),x&&x.__esModule&&x||{"default":x}),k=K.addClass,J=K.hasClass,E=(K.empty,(D=H("eventManager"),D&&D.__esModule&&D||{"default":D}).eventManager),I=(v=H("renderers"),v&&v.__esModule&&v||{"default":v}),G=I.getRenderer,y=I.registerRenderer,F=(C=H("3rdparty/walkontable/src/cell/coords"),C&&C.__esModule&&C||{"default":C}).WalkontableCellCoords,B=document.createElement("DIV");B.className="htAutocompleteWrapper";var j=document.createElement("DIV");j.className="htAutocompleteArrow",j.appendChild(document.createTextNode(String.fromCharCode(9660)));y("autocomplete",z)},{"3rdparty/walkontable/src/cell/coords":5,eventManager:41,"helpers/dom/element":46,renderers:92}],95:[function(af,L,X){function W(E,am,r,l,al,M,y){function H(d){var c=[K.SPACE,K.ENTER,K.DELETE,K.BACKSPACE];-1===c.indexOf(d.keyCode)||z(d)||C(function(){A(d),d.preventDefault()}),d.keyCode!==K.SPACE&&d.keyCode!==K.ENTER||D(),d.keyCode!==K.DELETE&&d.keyCode!==K.BACKSPACE||D(!1)}function D(){var c=void 0!==arguments[0]?arguments[0]:null;C(function(d){for(var f=0,e=d.length;e>f;f++){if(B(d[f],N)&&null===c){return}i(d[f],c)}})}function i(d){var c=void 0!==arguments[1]?arguments[1]:null;null===c?d.checked=!d.checked:d.checked=c,s.fireEvent(d,"change")}function C(p){var e=E.getSelectedRange();if(e){for(var d=e.getTopLeftCorner(),c=e.getBottomRightCorner(),g=d.row;g<=c.row;g++){for(var S=d.col;S<=c.col;S++){var f=E.getCell(g,S),h=E.getCellMeta(g,S),m=f.querySelectorAll("input[type=checkbox]");m.length>0&&!h.readOnly&&p(m)}}}}x("base").apply(this,arguments);var s=new Q(E),R=U(),w=y.label,v=!1;if("undefined"==typeof y.checkedTemplate&&(y.checkedTemplate=!0),"undefined"==typeof y.uncheckedTemplate&&(y.uncheckedTemplate=!1),G(am),M===y.checkedTemplate||ai(M,y.checkedTemplate)?R.checked=!0:M===y.uncheckedTemplate||ai(M,y.uncheckedTemplate)?R.checked=!1:null===M?I(R,"noValue"):(R.style.display="none",I(R,N),v=!0),R.setAttribute("data-row",r),R.setAttribute("data-col",l),!v&&w){var k="";w.value?k="function"==typeof w.value?w.value.call(this,r,l,al,M):w.value:w.property&&(k=E.getDataAtRowProp(r,w.property));var O=ab(k);"before"===w.position?O.appendChild(R):O.insertBefore(R,O.firstChild),R=O}am.appendChild(R),v&&am.appendChild(document.createTextNode("#bad-value#")),F.has(E)||(y.readOnly?s.addEventListener(E.rootElement,"click",P):(s.addEventListener(E.rootElement,"mouseup",function(c){return Z(c,E)}),s.addEventListener(E.rootElement,"change",function(c){return aj(c,E)})),F.set(E,!0)),aa.has(E)||(aa.set(E,!0),E.addHook("beforeKeyDown",H))}function U(){var c=document.createElement("input");return c.className="htCheckboxRendererInput",c.type="checkbox",c.setAttribute("autocomplete","off"),c.setAttribute("tabindex","-1"),c.cloneNode(!1)}function ab(d){var c=document.createElement("label");return c.className="htCheckboxRendererLabel",c.appendChild(document.createTextNode(d)),c.cloneNode(!0)}function P(c){J(c.target)&&c.preventDefault()}function Z(d,c){J(d.target)&&setTimeout(c.listen,10)}function aj(f,c){if(!J(f.target)){return !1}var h=parseInt(f.target.getAttribute("data-row"),10),g=parseInt(f.target.getAttribute("data-col"),10),d=c.getCellMeta(h,g);c.setDataAtCell(h,g,f.target.checked?d.checkedTemplate||!0:d.uncheckedTemplate||!1)}function J(c){return"INPUT"===c.tagName&&"checkbox"===c.getAttribute("type")}Object.defineProperties(X,{checkboxRenderer:{get:function(){return W}},__esModule:{value:!0}});var ah,ac,ag,ae,V,ad,Y=(ah=af("helpers/dom/element"),ah&&ah.__esModule&&ah||{"default":ah}),G=Y.empty,I=Y.addClass,B=Y.hasClass,ai=(ac=af("helpers/string"),ac&&ac.__esModule&&ac||{"default":ac}).equalsIgnoreCase,Q=(ag=af("eventManager"),ag&&ag.__esModule&&ag||{"default":ag}).EventManager,ak=(ae=af("renderers"),ae&&ae.__esModule&&ae||{"default":ae}),x=ak.getRenderer,q=ak.registerRenderer,K=(V=af("helpers/unicode"),V&&V.__esModule&&V||{"default":V}).KEY_CODES,j=(ad=af("helpers/dom/event"),ad&&ad.__esModule&&ad||{"default":ad}),A=(j.stopPropagation,j.stopImmediatePropagation),z=j.isImmediatePropagationStopped,aa=new WeakMap,F=new WeakMap,N="htBadValue";q("checkbox",W)},{eventManager:41,"helpers/dom/element":46,"helpers/dom/event":47,"helpers/string":54,"helpers/unicode":55,renderers:92}],96:[function(j,p,f){function d(x,v,z,y,w,u,s){k("base").apply(this,arguments),null!==u&&void 0!==u||(u=""),q(v,u)}Object.defineProperties(f,{htmlRenderer:{get:function(){return d}},__esModule:{value:!0}});var c,h,q=(c=j("helpers/dom/element"),c&&c.__esModule&&c||{"default":c}).fastInnerHTML,g=(h=j("renderers"),h&&h.__esModule&&h||{"default":h}),k=g.getRenderer,m=g.registerRenderer;m("html",d)},{"helpers/dom/element":46,renderers:92}],97:[function(p,x,g){function f(A,D,u,l,h,z,E){if(m(z)){"undefined"!=typeof E.language&&j.language(E.language),z=j(z).format(E.format||"0");var C=E.className||"",B=C.length?C.split(" "):[];B.indexOf("htLeft")<0&&B.indexOf("htCenter")<0&&B.indexOf("htRight")<0&&B.indexOf("htJustify")<0&&B.push("htRight"),B.indexOf("htNumeric")<0&&B.push("htNumeric"),E.className=B.join(" ")}w("text")(A,D,u,l,h,z,E)}Object.defineProperties(g,{numericRenderer:{get:function(){return f}},__esModule:{value:!0}});var d,k,y,j=(d=p("numeral"),d&&d.__esModule&&d||{"default":d})["default"],v=(k=p("renderers"),k&&k.__esModule&&k||{"default":k}),w=v.getRenderer,q=v.registerRenderer,m=(y=p("helpers/number"),y&&y.__esModule&&y||{"default":y}).isNumeric;q("numeric",f)},{"helpers/number":51,numeral:"numeral",renderers:92}],98:[function(j,p,f){function d(A,D,w,v,s,y,x){k("text").apply(this,arguments),y=D.innerHTML;var C,B=x.hashLength||y.length,z=x.hashSymbol||"*";for(C="";C.split(z).length-1<B;C+=z){}q(D,C)}Object.defineProperties(f,{passwordRenderer:{get:function(){return d}},__esModule:{value:!0}});var c,h,q=(c=j("helpers/dom/element"),c&&c.__esModule&&c||{"default":c}).fastInnerHTML,g=(h=j("renderers"),h&&h.__esModule&&h||{"default":h}),k=g.getRenderer,m=g.registerRenderer;m("password",d)},{"helpers/dom/element":46,renderers:92}],99:[function(w,B,k){function j(F,G,f,d,c,D,H){x("base").apply(this,arguments),!D&&H.placeholder&&(D=H.placeholder);var u=y(D);if(F.getSettings().trimWhitespace||(u=u.replace(/ /g,String.fromCharCode(160))),H.rendererTemplate){z(G);var E=document.createElement("TEMPLATE");E.setAttribute("bind","{{}}"),E.innerHTML=H.rendererTemplate,HTMLTemplateElement.decorate(E),E.model=F.getSourceDataAtRow(f),G.appendChild(E)}else{A(G,u)}}Object.defineProperties(k,{textRenderer:{get:function(){return j}},__esModule:{value:!0}});var g,p,C,m=(g=w("helpers/dom/element"),g&&g.__esModule&&g||{"default":g}),z=m.empty,A=m.fastInnerText,y=(p=w("helpers/mixed"),p&&p.__esModule&&p||{"default":p}).stringify,q=(C=w("renderers"),C&&C.__esModule&&C||{"default":C}),x=q.getRenderer,v=q.registerRenderer;v("text",j)},{"helpers/dom/element":46,"helpers/mixed":50,renderers:92}],100:[function(d,c,f){!function(aA){function al(g){return{configurable:!0,enumerable:!1,value:g,writable:!0}}function aq(){return"__$"+Math.floor(1000000000*Math.random())+"$"+ ++af+"$__"}function ap(g){return q[g]}function an(){var g=aq();return q[g]=!0,g}function aw(g){return"object"==typeof g&&g instanceof aE}function am(g){return aw(g)?"symbol":typeof g}function at(h){var g=new aE(h);if(!(this instanceof at)){return g}throw new TypeError("Symbol cannot be new'ed")}function aE(h){var g=aq();ac(this,U,{value:this}),ac(this,ah,{value:g}),ac(this,K,{value:h}),aC(this),Y[g]=this}function ak(h){var g=h[Z];return g&&g.self===h?g:aa(h)?(z.hash.value=ab++,z.self.value=h,av.value=J(null,z),ac(h,Z,av),av.value):void 0}function aC(g){return ak(g),B.apply(this,arguments)}function ax(g){return Y[g]||q[g]}function aB(g){return aw(g)?g[ah]:g}function az(i){for(var g=[],k=Q(i),j=0;j<k.length;j++){var h=Y[k[j]];h&&g.push(h)}return g}function ao(e){return aA.traceur&&aA.traceur.options[e]}function ay(i){for(var g=1;g<arguments.length;g++){for(var k=Q(arguments[g]),j=0;j<k.length;j++){var h=k[j];ax(h)||!function(e,l){ac(i,l,{get:function(){return e[l]},enumerable:!0})}(arguments[g],k[j])}}return i}function ar(g){return null!=g&&("object"==typeof g||"function"==typeof g)}function ai(g){if(null==g){throw aF()}return ae(g)}function aj(g){if(null==g){throw new TypeError("Value cannot be converted to an Object")}return g}function ag(h,g){h.Symbol||(h.Symbol=g,Object.getOwnPropertySymbols=az),h.Symbol.iterator||(h.Symbol.iterator=g("Symbol.iterator"))}function aD(g){ag(g,at),g.Reflect=g.Reflect||{},g.Reflect.global=g.Reflect.global||g}if(!aA.$traceurRuntime){var ae=Object,aF=TypeError,J=ae.create,G=ae.defineProperties,ac=ae.defineProperty,B=ae.freeze,X=ae.getOwnPropertyDescriptor,Q=ae.getOwnPropertyNames,au=ae.keys,aa=Object.isExtensible,ad=al,af=0,ah=aq(),K=aq(),U=aq(),Y=J(null),q=J(null);ac(at.prototype,"constructor",al(at)),ac(at.prototype,"toString",ad(function(){var h=this[U];if(!ao("symbols")){return h[ah]}if(!h){throw TypeError("Conversion from symbol to string")}var g=h[K];return void 0===g&&(g=""),"Symbol("+g+")"})),ac(at.prototype,"valueOf",ad(function(){var g=this[U];if(!g){throw TypeError("Conversion from symbol to string")}return ao("symbols")?g:g[ah]})),ac(aE.prototype,"constructor",al(at)),ac(aE.prototype,"toString",{value:at.prototype.toString,enumerable:!1}),ac(aE.prototype,"valueOf",{value:at.prototype.valueOf,enumerable:!1});var Z=an(),av={value:void 0},z={hash:{value:void 0},self:{value:void 0}},ab=0;aC(aE.prototype),aD(aA),aA.$traceurRuntime={checkObjectCoercible:aj,createPrivateName:an,defineProperties:G,defineProperty:ac,exportStar:ay,getOwnHashObject:ak,getOwnPropertyDescriptor:X,getOwnPropertyNames:Q,isObject:ar,isPrivateName:ap,isSymbolString:ax,keys:au,setupGlobals:aD,toObject:ai,toProperty:aB,"typeof":am}}}(window),function(){function h(){for(var m,q=[],p=0,l=0;l<arguments.length;l++){var j=$traceurRuntime.checkObjectCoercible(arguments[l]);"function"!=typeof j[g(Symbol.iterator)]&&(j[g(Symbol.iterator)]=function(){var o=this,i=o.length,r=0;return{next:function(){var e={done:!0};return i>r&&(e.done=!1,e.value=o[r],++r),e}}});for(var k=j[g(Symbol.iterator)]();!(m=k.next()).done;){q[p++]=m.value}}return q}var g=$traceurRuntime.toProperty;$traceurRuntime.spread=h}(),function(){function L(h,g){var l=J(h);do{var i=C(l,g);if(i){return i}l=J(l)}while(l)}function z(g){return g.__proto__}function E(i,g,l,h){return D(i,g,l).apply(i,h)}function D(e,i,h){var g=L(i,h);return g?g.get?g.get.call(e):g.value:void 0}function B(g,m,l,h){var e=L(m,l);if(e&&e.set){return e.set.call(g,h),h}throw N("super has no setter '"+l+"'.")}function H(p){for(var h={},v=q(p),u=0;u<v.length;u++){var m=v[u];h[m]=C(p,m)}for(var g=j(p),u=0;u<g.length;u++){var l=g[u];h[F(l)]=C(p,F(l))}return h}function A(h,g,l,i){return K(g,"constructor",{value:h,configurable:!0,enumerable:!1,writable:!0}),arguments.length>3?("function"==typeof i&&(h.__proto__=i),h.prototype=I(G(i),H(g))):h.prototype=g,K(h,"prototype",{configurable:!1,writable:!1}),M(h,H(l))}function G(h){if("function"==typeof h){var g=h.prototype;if(x(g)===g||null===g){return h.prototype}throw new N("super prototype must be an Object or null")}if(null===h){return null}throw new N("Super expression must either be null or a function, not "+typeof h+".")}function O(h,g,i){null!==J(g)&&E(h,g,"constructor",i)}var x=Object,N=TypeError,I=x.create,M=$traceurRuntime.defineProperties,K=$traceurRuntime.defineProperty,C=$traceurRuntime.getOwnPropertyDescriptor,J=Object.getPrototypeOf,F=$traceurRuntime.toProperty,k=Object,q=k.getOwnPropertyNames,j=k.getOwnPropertySymbols;$traceurRuntime.createClass=A,$traceurRuntime.defaultSuperCall=O,$traceurRuntime.superCall=E,$traceurRuntime.superConstructor=z,$traceurRuntime.superGet=D,$traceurRuntime.superSet=B}()},{}],101:[function(Z,H,P){function N(m){var u=this,f=this;this.eventManager=ae(m),this.instance=m,this.settings=m.getSettings(),this.selectionMouseDown=!1;var d=m.rootElement.getAttribute("style");d&&m.rootElement.setAttribute("data-originalstyle",d),Y(m.rootElement,"handsontable");var c=document.createElement("TABLE");Y(c,"htCore"),m.getSettings().tableClassName&&Y(c,m.getSettings().tableClassName),this.THEAD=document.createElement("THEAD"),c.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),c.appendChild(this.TBODY),m.table=c,m.container.insertBefore(c,m.container.firstChild),this.eventManager.addEventListener(m.rootElement,"mousedown",function(i){this.selectionMouseDown=!0,f.isTextSelectionAllowed(i.target)||(v(),i.preventDefault(),window.focus())}),this.eventManager.addEventListener(m.rootElement,"mouseup",function(i){this.selectionMouseDown=!1}),this.eventManager.addEventListener(m.rootElement,"mousemove",function(i){this.selectionMouseDown&&!f.isTextSelectionAllowed(i.target)&&(v(),i.preventDefault())}),this.eventManager.addEventListener(document.documentElement,"keyup",function(e){m.selection.isInProgress()&&!e.shiftKey&&m.selection.finish()});var h;this.isMouseDown=function(){return h},this.eventManager.addEventListener(document.documentElement,"mouseup",function(e){m.selection.isInProgress()&&1===e.which&&m.selection.finish(),h=!1,J(document.activeElement)&&m.unlisten()}),this.eventManager.addEventListener(document.documentElement,"mousedown",function(w){var E=w.target,C=w.target,y=w.x||w.clientX,i=w.y||w.clientY;if(!h&&m.rootElement){if(C===m.view.wt.wtTable.holder){var e=B();if(document.elementFromPoint(y+e,i)!==m.view.wt.wtTable.holder||document.elementFromPoint(y,i+e)!==m.view.wt.wtTable.holder){return}}else{for(;C!==document.documentElement;){if(null===C){if(w.isTargetWebComponent){break}return}if(C===m.rootElement){return}C=C.parentNode}}var n="function"==typeof f.settings.outsideClickDeselects?f.settings.outsideClickDeselects(E):f.settings.outsideClickDeselects;n?m.deselectCell():m.destroyEditor()}}),this.eventManager.addEventListener(c,"selectstart",function(i){f.settings.fragmentSelection||ac(i.target)||i.preventDefault()});var v=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},g=[new z({className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return f.settings.fillHandle&&!f.isCellEdited()&&!m.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return !f.isCellEdited()&&!m.selection.isMultiple()}}}),new z({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return f.settings.fillHandle&&!f.isCellEdited()&&m.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return !f.isCellEdited()&&m.selection.isMultiple()}}}),new z({className:"highlight",highlightRowClassName:f.settings.currentRowClassName,highlightColumnClassName:f.settings.currentColClassName}),new z({className:"fill",border:{width:1,color:"red"}})];g.current=g[0],g.area=g[1],g.highlight=g[2],g.fill=g[3];var p={debug:function(){return f.settings.debug},externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:c,preventOverflow:function(){return u.settings.preventOverflow},stretchH:function(){return f.settings.stretchH},data:m.getDataAtCell,totalRows:function(){return m.countRows()},totalColumns:function(){return m.countCols()},fixedColumnsLeft:function(){return f.settings.fixedColumnsLeft},fixedRowsTop:function(){return f.settings.fixedRowsTop},fixedRowsBottom:function(){return f.settings.fixedRowsBottom},minSpareRows:function(){return f.settings.minSpareRows},renderAllRows:f.settings.renderAllRows,rowHeaders:function(){var e=[];return m.hasRowHeaders()&&e.push(function(l,i){f.appendRowHeader(l,i)}),W.hooks.run(m,"afterGetRowHeaderRenderers",e),e},columnHeaders:function(){var e=[];return m.hasColHeaders()&&e.push(function(l,i){f.appendColHeader(l,i)}),W.hooks.run(m,"afterGetColumnHeaderRenderers",e),e},columnWidth:m.getColWidth,rowHeight:m.getRowHeight,cellRenderer:function(C,n,E){var y=f.instance.getCellMeta(C,n),l=f.instance.colToProp(n),w=f.instance.getDataAtRowProp(C,l);W.hooks.run(f.instance,"beforeRenderer",E,C,n,l,w,y),f.instance.getCellRenderer(y)(f.instance,E,C,n,l,w,y),W.hooks.run(f.instance,"afterRenderer",E,C,n,l,w,y)},selections:g,hideBorderOnMouseDownOver:function(){return f.settings.fragmentSelection},onCellMouseDown:function(aj,n,e,ak){if(m.listen(),f.activeWt=ak,h=!0,W.hooks.run(m,"beforeOnCellMouseDown",aj,n,e),!G(aj)){var E=m.getSelectedRange(),af=m.selection,ai=af.selectedHeader;if(aj.shiftKey&&E){n.row>=0&&n.col>=0?(af.setRangeEnd(n),af.setSelectedHeaders(!1,!1)):(ai.cols||ai.rows)&&n.row>=0&&n.col>=0?(af.setRangeEnd(new j(n.row,n.col)),af.setSelectedHeaders(!1,!1)):ai.cols&&n.row<0?af.setRangeEnd(new j(E.to.row,n.col)):ai.rows&&n.col<0?af.setRangeEnd(new j(n.row,E.to.col)):!ai.cols&&!ai.rows&&n.col<0||ai.cols&&n.col<0?(af.setRangeStartOnly(new j(E.from.row,0)),af.setRangeEnd(new j(n.row,m.countCols()-1)),af.setSelectedHeaders(!0,!1)):(!ai.cols&&!ai.rows&&n.row<0||ai.rows&&n.row<0)&&(af.setRangeStartOnly(new j(0,E.from.col)),af.setRangeEnd(new j(m.countRows()-1,n.col)),af.setSelectedHeaders(!1,!0))}else{var S=!0;if(E){var R=E,O=R.from,i=R.to,M=!af.inInSelection(n);if(n.row<0&&ai.cols){var C=Math.min(O.col,i.col),ag=Math.max(O.col,i.col);S=n.col<C||n.col>ag}else{if(n.col<0&&ai.rows){var ah=Math.min(O.row,i.row),T=Math.max(O.row,i.row);S=n.row<ah||n.row>T}else{S=M}}}(0===aj.button||2===aj.button&&S)&&(n.row<0&&n.col>=0?(af.setSelectedHeaders(!1,!0),af.setRangeStartOnly(new j(0,n.col)),af.setRangeEnd(new j(m.countRows()-1,n.col),!1)):n.col<0&&n.row>=0?(af.setSelectedHeaders(!0,!1),af.setRangeStartOnly(new j(n.row,0)),af.setRangeEnd(new j(n.row,m.countCols()-1),!1)):(n.row=n.row<0?0:n.row,n.col=n.col<0?0:n.col,af.setSelectedHeaders(!1,!1),af.setRangeStart(n)))}W.hooks.run(m,"afterOnCellMouseDown",aj,n,e),f.activeWt=f.wt}},onCellMouseOver:function(i,y,w,n){var e={row:!1,column:!1};f.activeWt=n,W.hooks.run(m,"beforeOnCellMouseOver",i,y,w,e),0===i.button&&(y.row>=0&&y.col>=0?h&&m.selection.setRangeEnd(y):h&&(y.row<0&&!e.column&&(m.selection.selectedHeader.cols?(m.selection.setRangeEnd(new j(m.countRows()-1,y.col),!1),m.selection.setSelectedHeaders(!1,!0)):m.selection.setRangeEnd(new j(y.row,y.col),!1)),y.col<0&&!e.row&&(m.selection.selectedHeader.rows?(m.selection.setRangeEnd(new j(y.row,m.countCols()-1),!1),m.selection.setSelectedHeaders(!0,!1)):m.selection.setRangeEnd(new j(y.row,y.col),!1)))),W.hooks.run(m,"afterOnCellMouseOver",i,y,w),f.activeWt=f.wt},onCellCornerMouseDown:function(e){e.preventDefault(),W.hooks.run(m,"afterOnCellCornerMouseDown",e)},beforeDraw:function(i){f.beforeRender(i)},onDraw:function(i){f.onDraw(i)},onScrollVertically:function(){m.runHooks("afterScrollVertically")},onScrollHorizontally:function(){m.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(e,i){m.runHooks("beforeDrawBorders",e,i)},onBeforeTouchScroll:function(){m.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){m.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(e,i){return m.runHooks("beforeStretchingColumnWidth",e,i)},viewportRowCalculatorOverride:function(l){var y=m.countRows(),w=f.settings.viewportRowRenderingOffset;if("auto"===w&&f.settings.fixedRowsTop&&(w=10),"number"==typeof w&&(l.startRow=Math.max(l.startRow-w,0),l.endRow=Math.min(l.endRow+w,y-1)),"auto"===w){var e=l.startRow+l.endRow-l.startRow,n=Math.ceil(e/y*12);l.startRow=Math.max(l.startRow-n,0),l.endRow=Math.min(l.endRow+n,y-1)}m.runHooks("afterViewportRowCalculatorOverride",l)},viewportColumnCalculatorOverride:function(l){var y=m.countCols(),w=f.settings.viewportColumnRenderingOffset;if("auto"===w&&f.settings.fixedColumnsLeft&&(w=10),"number"==typeof w&&(l.startColumn=Math.max(l.startColumn-w,0),l.endColumn=Math.min(l.endColumn+w,y-1)),"auto"===w){var e=l.startColumn+l.endColumn-l.startColumn,n=Math.ceil(e/y*12);l.startRow=Math.max(l.startColumn-n,0),l.endColumn=Math.min(l.endColumn+n,y-1)}m.runHooks("afterViewportColumnCalculatorOverride",l)},rowHeaderWidth:function(){return f.settings.rowHeaderWidth},columnHeaderHeight:function(){var e=m.runHooks("modifyColumnHeaderHeight");return f.settings.columnHeaderHeight||e}};W.hooks.run(m,"beforeInitWalkontable",p),this.wt=new x(p),this.activeWt=this.wt,this.eventManager.addEventListener(f.wt.wtTable.spreader,"mousedown",function(i){i.target===f.wt.wtTable.spreader&&3===i.which&&k(i)}),this.eventManager.addEventListener(f.wt.wtTable.spreader,"contextmenu",function(i){i.target===f.wt.wtTable.spreader&&3===i.which&&k(i)}),this.eventManager.addEventListener(document.documentElement,"click",function(){f.settings.observeDOMVisibility&&f.wt.drawInterrupted&&(f.instance.forceFullRender=!0,f.render())})}Object.defineProperties(P,{TableView:{get:function(){return N}},__esModule:{value:!0}});var K,V,I,U,ad,F,ab,W=(K=Z("browser"),K&&K.__esModule&&K||{"default":K})["default"],aa=(V=Z("helpers/dom/element"),V&&V.__esModule&&V||{"default":V}),Y=aa.addClass,L=aa.empty,X=aa.fastInnerHTML,Q=aa.fastInnerText,B=aa.getScrollbarWidth,D=aa.hasClass,A=aa.isChildOf,ac=aa.isInput,J=aa.isOutsideInput,ae=(I=Z("eventManager"),I&&I.__esModule&&I||{"default":I}).eventManager,q=(U=Z("helpers/dom/event"),U&&U.__esModule&&U||{"default":U}),k=q.stopPropagation,G=q.isImmediatePropagationStopped,j=(ad=Z("3rdparty/walkontable/src/cell/coords"),ad&&ad.__esModule&&ad||{"default":ad}).WalkontableCellCoords,z=(F=Z("3rdparty/walkontable/src/selection"),F&&F.__esModule&&F||{"default":F}).WalkontableSelection,x=(ab=Z("3rdparty/walkontable/src/core"),ab&&ab.__esModule&&ab||{"default":ab}).Walkontable;W.TableView=N,N.prototype.isTextSelectionAllowed=function(d){if(ac(d)){return !0}var c=A(d,this.instance.view.wt.wtTable.spreader);return this.settings.fragmentSelection===!0&&c?!0:"cell"===this.settings.fragmentSelection&&this.isSelectedOnlyCell()&&c?!0:!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell())},N.prototype.isSelectedOnlyCell=function(){var f=this.instance.getSelected()||[],c=f[0],h=f[1],g=f[2],d=f[3];return void 0!==c&&c===g&&h===d},N.prototype.isCellEdited=function(){var c=this.instance.getActiveEditor();return c&&c.isOpened()},N.prototype.beforeRender=function(c){c&&W.hooks.run(this.instance,"beforeRender",this.instance.forceFullRender)},N.prototype.onDraw=function(c){c&&W.hooks.run(this.instance,"afterRender",this.instance.forceFullRender)},N.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1},N.prototype.getCellAtCoords=function(d,c){var f=this.wt.getCell(d,c);return 0>f?null:f},N.prototype.scrollViewport=function(c){this.wt.scrollViewport(c)},N.prototype.appendRowHeader=function(f,c){if(c.firstChild){var h=c.firstChild;if(!D(h,"relative")){return L(c),void this.appendRowHeader(f,c)}this.updateCellHeader(h.querySelector(".rowHeader"),f,this.instance.getRowHeader)}else{var g=document.createElement("div"),d=document.createElement("span");g.className="relative",d.className="rowHeader",this.updateCellHeader(d,f,this.instance.getRowHeader),g.appendChild(d),c.appendChild(g)}W.hooks.run(this.instance,"afterGetRowHeader",f,c)},N.prototype.appendColHeader=function(f,c){if(c.firstChild){var h=c.firstChild;D(h,"relative")?this.updateCellHeader(h.querySelector(".colHeader"),f,this.instance.getColHeader):(L(c),this.appendColHeader(f,c))}else{var g=document.createElement("div"),d=document.createElement("span");g.className="relative",d.className="colHeader",this.updateCellHeader(d,f,this.instance.getColHeader),g.appendChild(d),c.appendChild(g)}W.hooks.run(this.instance,"afterGetColHeader",f,c)},N.prototype.updateCellHeader=function(f,c,h){var g=c,d=this.wt.wtOverlays.getParentOverlay(f)||this.wt;f.parentNode&&(D(f,"colHeader")?g=d.wtTable.columnFilter.sourceToRendered(c):D(f,"rowHeader")&&(g=d.wtTable.rowFilter.sourceToRendered(c))),g>-1?X(f,h(c)):(Q(f,String.fromCharCode(160)),Y(f,"cornerHeader"))},N.prototype.maximumVisibleElementWidth=function(d){var c=this.wt.wtViewport.getWorkspaceWidth(),f=c-d;return f>0?f:0},N.prototype.maximumVisibleElementHeight=function(d){var c=this.wt.wtViewport.getWorkspaceHeight(),f=c-d;return f>0?f:0},N.prototype.mainViewIsActive=function(){return this.wt===this.activeWt},N.prototype.destroy=function(){this.wt.destroy(),this.eventManager.destroy()}},{"3rdparty/walkontable/src/cell/coords":5,"3rdparty/walkontable/src/core":7,"3rdparty/walkontable/src/selection":18,browser:23,eventManager:41,"helpers/dom/element":46,"helpers/dom/event":47}],102:[function(A,F,q){Object.defineProperties(q,{GhostTable:{get:function(){return y}},__esModule:{value:!0}});var m,j,w,G,v,D,E=(m=A("browser"),m&&m.__esModule&&m||{"default":m})["default"],C=(j=A("helpers/dom/element"),j&&j.__esModule&&j||{"default":j}),x=C.addClass,B=C.outerHeight,z=C.outerWidth,k=(w=A("helpers/array"),w&&w.__esModule&&w||{"default":w}).arrayEach,y=((G=A("helpers/object"),G&&G.__esModule&&G||{"default":G}).objectEach,(v=A("helpers/number"),v&&v.__esModule&&v||{"default":v}).rangeEach,(D=A("helpers/mixed"),D&&D.__esModule&&D||{"default":D}).stringify,function(c){this.hot=c,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}});$traceurRuntime.createClass(y,{addRow:function(d,c){if(this.columns.length){throw new Error("Doesn't support multi-dimensional table")}this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var f={row:d};this.rows.push(f),this.samples=c,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(d)),this.container.container.appendChild(this.table.fragment),f.table=this.table.table},addColumnHeadersRow:function(d){if(null!=this.hot.getColHeader(0)){var c={row:-1};this.rows.push(c),this.container=this.createContainer(this.hot.rootElement.className),this.samples=d,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tHead.appendChild(this.createColumnHeadersRow()),this.container.container.appendChild(this.table.fragment),c.table=this.table.table}},addColumn:function(d,c){if(this.rows.length){throw new Error("Doesn't support multi-dimensional table")}this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var f={col:d};this.columns.push(f),this.samples=c,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(d)&&this.hot.view.appendColHeader(d,this.table.th),this.table.tBody.appendChild(this.createCol(d)),this.container.container.appendChild(this.table.fragment),f.table=this.table.table},getHeights:function(c){this.injected||this.injectTable(),k(this.rows,function(d){c(d.row,B(d.table)-1)})},getWidths:function(c){this.injected||this.injectTable(),k(this.columns,function(d){c(d.col,z(d.table))})},setSettings:function(c){this.settings=c},setSetting:function(d,c){this.settings||(this.settings={}),this.settings[d]=c},getSettings:function(){return this.settings},getSetting:function(c){return this.settings?this.settings[c]:null},createColGroupsCol:function(){var d=this,c=document,f=c.createDocumentFragment();return this.hot.hasRowHeaders()&&f.appendChild(this.createColElement(-1)),this.samples.forEach(function(e){k(e.strings,function(g){f.appendChild(d.createColElement(g.col))})}),f},createRow:function(f){var c=this,h=document,g=h.createDocumentFragment(),d=h.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(f,d),g.appendChild(d)),this.samples.forEach(function(e){k(e.strings,function(u){var p=u.col,t=c.hot.getCellMeta(f,p);t.col=p,t.row=f;var o=c.hot.getCellRenderer(t),n=h.createElement("td");o(c.hot,n,f,p,c.hot.colToProp(p),u.value,t),g.appendChild(n)})}),g},createColumnHeadersRow:function(){var d=this,c=document,g=c.createDocumentFragment();if(this.hot.hasRowHeaders()){var f=c.createElement("th");this.hot.view.appendColHeader(-1,f),g.appendChild(f)}return this.samples.forEach(function(e){k(e.strings,function(n){var l=n.col,h=c.createElement("th");d.hot.view.appendColHeader(l,h),g.appendChild(h)})}),g},createCol:function(d){var c=this,g=document,f=g.createDocumentFragment();return this.samples.forEach(function(e){k(e.strings,function(H){var p=H.row,t=c.hot.getCellMeta(p,d);t.col=d,t.row=p;var n=c.hot.getCellRenderer(t),h=g.createElement("td"),o=g.createElement("tr");n(c.hot,h,p,d,c.hot.colToProp(d),H.value,t),o.appendChild(h),f.appendChild(o)})}),f},clean:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()},injectTable:function(){var c=void 0!==arguments[0]?arguments[0]:null;this.injected||((c||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)},removeTable:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)},createColElement:function(d){var c=document,f=c.createElement("col");return f.style.width=this.hot.view.wt.wtTable.getStretchedColumnWidth(d)+"px",f},createTable:function(){var p=void 0!==arguments[0]?arguments[0]:"",H=document,f=H.createDocumentFragment(),d=H.createElement("table"),c=H.createElement("thead"),h=H.createElement("tbody"),I=H.createElement("colgroup"),g=H.createElement("tr"),u=H.createElement("th");return this.isVertical()&&d.appendChild(I),this.isHorizontal()&&(g.appendChild(u),c.appendChild(g),d.style.tableLayout="auto",d.style.width="auto"),d.appendChild(c),this.isVertical()&&h.appendChild(g),d.appendChild(h),x(d,p),f.appendChild(d),{fragment:f,table:d,tHead:c,tBody:h,colGroup:I,tr:g,th:u}},createContainer:function(){var d=void 0!==arguments[0]?arguments[0]:"",c=document,g=c.createDocumentFragment(),f=c.createElement("div");return d="htGhostTable htAutoSize "+d.trim(),x(f,d),g.appendChild(f),{fragment:g,container:f}},isVertical:function(){return !(!this.rows.length||this.columns.length)},isHorizontal:function(){return !(!this.columns.length||this.rows.length)}},{}),E.utils.GhostTable=y},{browser:23,"helpers/array":42,"helpers/dom/element":46,"helpers/mixed":50,"helpers/number":51,"helpers/object":52}],103:[function(A,F,q){function m(c){return"string"==typeof c&&/fps$/.test(c)&&(c=1000/parseInt(c.replace("fps","")||0,10)),c}Object.defineProperties(q,{Interval:{get:function(){return k}},__esModule:{value:!0}});var j,w,G,v,D,E,C=(j=A("browser"),j&&j.__esModule&&j||{"default":j})["default"],x=(w=A("helpers/feature"),w&&w.__esModule&&w||{"default":w}),B=x.requestAnimationFrame,z=x.cancelAnimationFrame,k=((G=A("helpers/array"),G&&G.__esModule&&G||{"default":G}).arrayEach,(v=A("helpers/object"),v&&v.__esModule&&v||{"default":v}).objectEach,(D=A("helpers/number"),D&&D.__esModule&&D||{"default":D}).rangeEach,(E=A("helpers/mixed"),E&&E.__esModule&&E||{"default":E}).stringify,function(d,c){var f=this;this.timer=null,this.func=d,this.delay=m(c),this.stopped=!0,this._then=null,this._callback=function(){return f.__callback()}}),y=k;$traceurRuntime.createClass(k,{start:function(){return this.stopped&&(this._then=Date.now(),this.stopped=!1,this.timer=B(this._callback)),this},stop:function(){return this.stopped||(this.stopped=!0,z(this.timer),this.timer=null),this},__callback:function(){if(this.timer=B(this._callback),this.delay){var d=Date.now(),c=d-this._then;c>this.delay&&(this._then=d-c%this.delay,this.func())}else{this.func()}}},{create:function(d,c){return new y(d,c)}}),C.utils.Interval=k},{browser:23,"helpers/array":42,"helpers/feature":48,"helpers/mixed":50,"helpers/number":51,"helpers/object":52}],104:[function(H,q,A){var z;Object.defineProperties(A,{SamplesGenerator:{get:function(){return B}},__esModule:{value:!0}});var x,D,v,C,K,k,J=(x=H("browser"),x&&x.__esModule&&x||{"default":x})["default"],E=(D=H("helpers/dom/element"),D&&D.__esModule&&D||{"default":D}),I=(E.addClass,E.outerHeight,E.outerWidth,(v=H("helpers/array"),v&&v.__esModule&&v||{"default":v}).arrayEach,C=H("helpers/object"),C&&C.__esModule&&C||{"default":C}),G=(I.objectEach,I.isObject),y=(K=H("helpers/number"),K&&K.__esModule&&K||{"default":K}).rangeEach,F=(k=H("helpers/mixed"),k&&k.__esModule&&k||{"default":k}).stringify,B=function(c){this.samples=null,this.dataFactory=c,this.customSampleCount=null},j=B;$traceurRuntime.createClass(B,(z={},Object.defineProperty(z,"getSampleCount",{value:function(){return this.customSampleCount?this.customSampleCount:j.SAMPLE_COUNT},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(z,"generateRowSamples",{value:function(d,c){return this.generateSamples("row",c,d)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(z,"generateColumnSamples",{value:function(d,c){return this.generateSamples("col",c,d)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(z,"generateSamples",{value:function(f,c,h){var g=this,d=new Map;return"number"==typeof h&&(h={from:h,to:h}),y(h.from,h.to,function(l){var e=g.generateSample(f,c,l);d.set(l,e)}),d},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(z,"generateSample",{value:function(h,d,m){var l,g=this,c=new Map,f=[];return y(d.from,d.to,function(o){var i,e;if("row"===h){e=g.dataFactory(m,o)}else{if("col"!==h){throw new Error("Unsupported sample type")}e=g.dataFactory(o,m)}l=G(e)?Object.keys(e).length:Array.isArray(e)?e.length:F(e).length,c.has(l)||c.set(l,{needed:g.getSampleCount(),strings:[]});var n=c.get(l);if(n.needed){var r=f.indexOf(e)>-1;if(!r){var p="row"===h?"col":"row";n.strings.push((i={},Object.defineProperty(i,"value",{value:e,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(i,p,{value:o,configurable:!0,enumerable:!0,writable:!0}),i)),f.push(e),n.needed--}}}),c},configurable:!0,enumerable:!0,writable:!0}),z),{get SAMPLE_COUNT(){return 3}}),J.utils.SamplesGenerator=B},{browser:23,"helpers/array":42,"helpers/dom/element":46,"helpers/mixed":50,"helpers/number":51,"helpers/object":52}],105:[function(j,f,m){function k(l,i){var q=l,p="string"==typeof q?q.toLowerCase():null;return function(u){for(var t=!1,n=0,o=u.length;o>n;n++){if(q===u[n]){t=!0;break}if(p===c(u[n]).toLowerCase()){t=!0;break}}i(t)}}var h,d,g=(h=j("browser"),h&&h.__esModule&&h||{"default":h})["default"],c=(d=j("helpers/mixed"),d&&d.__esModule&&d||{"default":d}).stringify;g.AutocompleteValidator=function(l,i){return null==l&&(l=""),this.allowEmpty&&""===l?void i(!0):void (this.strict&&this.source?"function"==typeof this.source?this.source(l,k(l,i)):k(l,i)(this.source):i(!0))}},{browser:23,"helpers/mixed":50}],106:[function(p,x,g){var f,d,k,y,j=(f=p("browser"),f&&f.__esModule&&f||{"default":f})["default"],v=(d=p("moment"),d&&d.__esModule&&d||{"default":d})["default"],w=(k=p("../helpers/date"),k&&k.__esModule&&k||{"default":k}).getNormalizedDate,q=(y=p("editors"),y&&y.__esModule&&y||{"default":y}).getEditor;j.DateValidator=function(z,h){var B=!0,A=q("date",this.instance);null==z&&(z="");var u=v(new Date(z)).isValid(),c=v(z,this.dateFormat||A.defaultDateFormat,!0).isValid();if(this.allowEmpty&&""===z&&(u=!0,c=!0),u||(B=!1),!u&&c&&(B=!0),u&&!c){if(this.correctFormat===!0){var l=m(z,this.dateFormat);this.instance.setDataAtCell(this.row,this.col,l,"dateValidator"),B=!0}else{B=!1}}h(B)};var m=function(i,c){var s=v(w(i)),l=s.format("YYYY"),h=v().format("YYYY");return l.substr(0,2)!==h.substr(0,2)?i.match(new RegExp(l))||s.year(l.replace(l.substr(0,2),h.substr(0,2))):l.length>4&&s.year((s.year()+"").substr(0,4)),s.format(c)}},{"../helpers/date":45,browser:23,editors:29,moment:"moment"}],107:[function(f,c,h){var g,d=(g=f("browser"),g&&g.__esModule&&g||{"default":g})["default"];d.NumericValidator=function(j,i){null==j&&(j=""),i(this.allowEmpty&&""===j?!0:""===j?!1:/^-?\d*(\.|\,)?\d*$/.test(j))}},{browser:23}],108:[function(j,f,m){var k,h,d=(k=j("browser"),k&&k.__esModule&&k||{"default":k})["default"],g=(h=j("moment"),h&&h.__esModule&&h||{"default":h})["default"],c=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];d.TimeValidator=function(v,z){var q=!0,p=this.timeFormat||"h:mm:ss a";null===v&&(v=""),v=/^\d{3,}$/.test(v)?parseInt(v,10):v;var l=/^\d{1,2}$/.test(v);l&&(v+=":00");var s=g(v,c,!0).isValid()?g(v):g(v,p),x=s.isValid(),y=g(v,p,!0).isValid()&&!l;if(this.allowEmpty&&""===v&&(x=!0,y=!0),x||(q=!1),!x&&y&&(q=!0),x&&!y){if(this.correctFormat===!0){var w=s.format(p);this.instance.setDataAtCell(this.row,this.col,w,"timeValidator"),q=!0}else{q=!1}}z(q)}},{browser:23,moment:"moment"}],SheetClip:[function(d,c,f){!function(h){function g(j){return j.split('"').length-1}var i={parse:function(t){var m,k,j,q,y,p,w,x=[],v=0;for(j=t.split("\n"),j.length>1&&""===j[j.length-1]&&j.pop(),m=0,k=j.length;k>m;m+=1){for(j[m]=j[m].split("	"),q=0,y=j[m].length;y>q;q+=1){x[v]||(x[v]=[]),p&&0===q?(w=x[v].length-1,x[v][w]=x[v][w]+"\n"+j[m][0],p&&1&g(j[m][0])&&(p=!1,x[v][w]=x[v][w].substring(0,x[v][w].length-1).replace(/""/g,'"'))):q===y-1&&0===j[m][q].indexOf('"')&&1&g(j[m][q])?(x[v].push(j[m][q].substring(1).replace(/""/g,'"')),p=!0):(x[v].push(j[m][q].replace(/""/g,'"')),p=!1)}p||(v+=1)}return x},stringify:function(p){var k,u,q,m,j,l="";for(k=0,u=p.length;u>k;k+=1){for(m=p[k].length,q=0;m>q;q+=1){q>0&&(l+="	"),j=p[k][q],l+="string"==typeof j?j.indexOf("\n")>-1?'"'+j.replace(/"/g,'""')+'"':j:null===j||void 0===j?"":j}l+="\n"}return l}};"undefined"!=typeof f?(f.parse=i.parse,f.stringify=i.stringify):h.SheetClip=i}(window)},{}],autoResize:[function(d,c,g){function f(){function w(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}var A,m={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},k=document.body,j=document.createTextNode(""),q=document.createElement("SPAN"),B=function(i,h,l){window.attachEvent?i.attachEvent("on"+h,l):i.addEventListener(h,l,!1)},p=function(i,h,l){window.removeEventListener?i.removeEventListener(h,l,!1):i.detachEvent("on"+h,l)},y=function(i){var h,e;i?/^[a-zA-Z \.,\\\/\|0-9]$/.test(i)||(i="."):i="",void 0!==j.textContent?j.textContent=A.value+i:j.data=A.value+i,q.style.fontSize=w(A).fontSize,q.style.fontFamily=w(A).fontFamily,q.style.whiteSpace="pre",k.appendChild(q),h=q.clientWidth+2,k.removeChild(q),A.style.height=m.minHeight+"px",m.minWidth>h?A.style.width=m.minWidth+"px":h>m.maxWidth?A.style.width=m.maxWidth+"px":A.style.width=h+"px",e=A.scrollHeight?A.scrollHeight-1:0,m.minHeight>e?A.style.height=m.minHeight+"px":m.maxHeight<e?(A.style.height=m.maxHeight+"px",A.style.overflowY="visible"):A.style.height=e+"px"},z=function(){window.setTimeout(y,0)},x=function(r){if(r&&r.minHeight){if("inherit"==r.minHeight){m.minHeight=A.clientHeight}else{var t=parseInt(r.minHeight);isNaN(t)||(m.minHeight=t)}}if(r&&r.maxHeight){if("inherit"==r.maxHeight){m.maxHeight=A.clientHeight}else{var n=parseInt(r.maxHeight);isNaN(n)||(m.maxHeight=n)}}if(r&&r.minWidth){if("inherit"==r.minWidth){m.minWidth=A.clientWidth}else{var i=parseInt(r.minWidth);isNaN(i)||(m.minWidth=i)}}if(r&&r.maxWidth){if("inherit"==r.maxWidth){m.maxWidth=A.clientWidth}else{var h=parseInt(r.maxWidth);isNaN(h)||(m.maxWidth=h)}}q.firstChild||(q.className="autoResize",q.style.display="inline-block",q.appendChild(j))},v=function(i,l,h){A=i,x(l),"TEXTAREA"==A.nodeName&&(A.style.resize="none",A.style.overflowY="",A.style.height=m.minHeight+"px",A.style.minWidth=m.minWidth+"px",A.style.maxWidth=m.maxWidth+"px",A.style.overflowY="hidden"),h&&(B(A,"change",y),B(A,"cut",z),B(A,"paste",z),B(A,"drop",z),B(A,"keydown",z),B(A,"focus",y)),y()};return{init:function(i,h,l){v(i,h,l)},unObserve:function(){p(A,"change",y),p(A,"cut",z),p(A,"paste",z),p(A,"drop",z),p(A,"keydown",z),p(A,"focus",y)},resize:y}}"undefined"!=typeof g&&(c.exports=f)},{}],copyPaste:[function(g,d,j){function h(){return c?c.hasBeenDestroyed()&&c.init():c=new f,c.refCounter++,c}function f(){this.refCounter=0,this.init()}var c;"undefined"!=typeof j&&(d.exports=h),f.prototype.init=function(){var k,i;this.copyCallbacks=[],this.cutCallbacks=[],this.pasteCallbacks=[],i=document.body,document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("div"),this.elDiv.id="CopyPasteDiv",k=this.elDiv.style,k.position="fixed",k.top="-10000px",k.left="-10000px",i.appendChild(this.elDiv),this.elTextarea=document.createElement("textarea"),this.elTextarea.className="copyPaste",this.elTextarea.onpaste=function(m){var l,o;"WebkitAppearance" in document.documentElement.style&&(l=m.clipboardData.getData("Text"),-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&(o=l.split("\n"),""===o[o.length-1]&&o.pop(),l=o.join("\n")),this.value=l,m.preventDefault())},k=this.elTextarea.style,k.width="10000px",k.height="10000px",k.overflow="hidden",this.elDiv.appendChild(this.elTextarea),"undefined"!=typeof k.opacity&&(k.opacity=0)),this.onKeyDownRef=this.onKeyDown.bind(this),document.documentElement.addEventListener("keydown",this.onKeyDownRef,!1)},f.prototype.onKeyDown=function(k){function i(){var n=document.activeElement;return n.shadowRoot&&n.shadowRoot.activeElement&&(n=n.shadowRoot.activeElement),["INPUT","SELECT","TEXTAREA"].indexOf(n.nodeName)>-1||"true"===n.contentEditable}var m=this,l=!1;if(k.metaKey?l=!0:k.ctrlKey&&-1===navigator.userAgent.indexOf("Mac")&&(l=!0),l){if(document.activeElement!==this.elTextarea&&(""!==this.getSelectionText()||i())){return}this.selectNodeText(this.elTextarea),setTimeout(function(){document.activeElement!==m.elTextarea&&m.selectNodeText(m.elTextarea)},0)}k.isImmediatePropagationEnabled===!1||!l||67!==k.keyCode&&86!==k.keyCode&&88!==k.keyCode||(88===k.keyCode?setTimeout(function(){m.triggerCut(k)},0):86===k.keyCode&&setTimeout(function(){m.triggerPaste(k)},0))},f.prototype.selectNodeText=function(i){i&&i.select()},f.prototype.getSelectionText=function(){var i="";return window.getSelection?i=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(i=document.selection.createRange().text),i},f.prototype.copyable=function(i){if("string"!=typeof i&&void 0===i.toString){throw new Error("copyable requires string parameter")}this.elTextarea.value=i,this.selectNodeText(this.elTextarea)},f.prototype.onCut=function(i){this.cutCallbacks.push(i)},f.prototype.onPaste=function(i){this.pasteCallbacks.push(i)},f.prototype.removeCallback=function(k){var i,l;for(i=0,l=this.copyCallbacks.length;l>i;i++){if(this.copyCallbacks[i]===k){return this.copyCallbacks.splice(i,1),!0}}for(i=0,l=this.cutCallbacks.length;l>i;i++){if(this.cutCallbacks[i]===k){return this.cutCallbacks.splice(i,1),!0}}for(i=0,l=this.pasteCallbacks.length;l>i;i++){if(this.pasteCallbacks[i]===k){return this.pasteCallbacks.splice(i,1),!0}}return !1},f.prototype.triggerCut=function(k){var i=this;i.cutCallbacks&&setTimeout(function(){for(var l=0,e=i.cutCallbacks.length;e>l;l++){i.cutCallbacks[l](k)}},50)},f.prototype.triggerPaste=function(k,i){var l=this;l.pasteCallbacks&&setTimeout(function(){for(var n=i||l.elTextarea.value,m=0,e=l.pasteCallbacks.length;e>m;m++){l.pasteCallbacks[m](n,k)}},50)},f.prototype.destroy=function(){this.hasBeenDestroyed()||0!==--this.refCounter||(this.elDiv&&this.elDiv.parentNode&&(this.elDiv.parentNode.removeChild(this.elDiv),this.elDiv=null,this.elTextarea=null),document.documentElement.removeEventListener("keydown",this.onKeyDownRef),this.onKeyDownRef=null)},f.prototype.hasBeenDestroyed=function(){return !this.refCounter}},{}],es6collections:[function(d,c,f){
/*!
 * Copyright (C) 2011 by Andrea Giammarchi, @WebReflection
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
;!function(L){function z(h,g){function i(l){return this&&this.constructor===i?(this._keys=[],this._values=[],this._itp=[],this.objectOnly=g,void (l&&E.call(this,l))):new i(l)}return g||j(h,"size",{get:F}),h.constructor=i,i.prototype=h,i}function E(g){this.add?g.forEach(this.add,this):g.forEach(function(h){this.set(h[0],h[1])},this)}function D(g){return this.has(g)&&(this._keys.splice(q,1),this._values.splice(q,1),this._itp.forEach(function(h){q<h[0]&&h[0]--})),q>-1}function B(g){return this.has(g)?this._values[q]:void 0}function H(h,g){if(this.objectOnly&&g!==Object(g)){throw new TypeError("Invalid value used as weak collection key")}if(g!=g||0===g){for(q=h.length;q--&&!O(h[q],g);){}}else{q=h.indexOf(g)}return q>-1}function A(g){return H.call(this,this._values,g)}function G(g){return H.call(this,this._keys,g)}function P(h,g){return this.has(h)?this._values[q]=g:this._values[this._keys.push(h)-1]=g,this}function x(g){return this.has(g)||this._values.push(g),this}function N(){this._values.length=0}function I(){return J(this._itp,this._keys)}function M(){return J(this._itp,this._values)}function K(){return J(this._itp,this._keys,this._values)}function C(){return J(this._itp,this._values,this._values)}function J(i,g,m){var l=[0],h=!1;return i.push(l),{next:function(){var e,n=l[0];return !h&&n<g.length?(e=m?[g[n],m[n]]:g[n],l[0]++):(h=!0,i.splice(i.indexOf(l),1)),{done:h,value:e}}}}function F(){return this._values.length}function k(h,g){for(var l=this.entries();;){var i=l.next();if(i.done){break}h.call(g,i.value[1],i.value[0],this)}}var q,j=Object.defineProperty,O=function(h,g){return isNaN(h)?isNaN(g):h===g};"undefined"==typeof WeakMap&&(L.WeakMap=z({"delete":D,clear:N,get:B,has:G,set:P},!0)),"undefined"==typeof Map&&(L.Map=z({"delete":D,has:G,get:B,set:P,keys:I,values:M,entries:K,forEach:k,clear:N})),"undefined"==typeof Set&&(L.Set=z({has:A,add:x,"delete":D,clear:N,keys:M,values:M,entries:C,forEach:k})),"undefined"==typeof WeakSet&&(L.WeakSet=z({"delete":D,add:x,clear:N,has:A},!0))}("undefined"!=typeof f&&"undefined"!=typeof global?global:window)},{}],jsonpatch:[function(g,d,j){
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * json-patch-duplex.js version: 0.5.7
 * (c) 2013 Joachim Wester
 * MIT license
 */
;var h,f=this&&this.__extends||function(k,i){function m(){this.constructor=k}for(var l in i){i.hasOwnProperty(l)&&(k[l]=i[l])}k.prototype=null===i?Object.create(i):(m.prototype=i.prototype,new m)},c=Error;!function(U){function F(t,v){switch(typeof t){case"undefined":case"boolean":case"string":case"number":return t===v;case"object":if(null===t){return null===v}if(i(t)){if(!i(v)||t.length!==v.length){return !1}for(var u=0,p=t.length;p>u;u++){if(!F(t[u],v[u])){return !1}}return !0}var l=x(v),m=l.length;if(x(t).length!==m){return !1}for(var u=0;m>u;u++){if(!F(t[u],v[u])){return !1}}return !0;default:return !1}}function K(l){return -1===l.indexOf("/")&&-1===l.indexOf("~")?l:l.replace(/~/g,"~0").replace(/\//g,"~1")}function J(m){for(var l=0,o=q.length;o>l;l++){if(q[l].obj===m){return q[l]}}}function G(m,l){for(var s=0,p=m.observers.length;p>s;s++){if(m.observers[s].callback===l){return m.observers[s].observer}}}function N(m,l){for(var s=0,p=m.observers.length;p>s;s++){if(m.observers[s].observer===l){return void m.observers.splice(s,1)}}}function Y(m,l){l.unobserve()}function B(l){return"object"==typeof l?JSON.parse(JSON.stringify(l)):l}function W(v,E){var o,l=[],C=J(v);if(C?o=G(C,E):(C=new k(v),q.push(C)),o){return o}if(o={},C.value=B(v),E){o.callback=E,o.next=null;var y=this.intervals||[100,1000,10000,60000];if(void 0===y.push){throw new c("jsonpatch.intervals must be an array")}var w=0,u=function(){O(o)},m=function(){clearTimeout(o.next),o.next=setTimeout(function(){u(),w=0,o.next=setTimeout(s,y[w++])},0)},s=function(){u(),w==y.length&&(w=y.length-1),o.next=setTimeout(s,y[w++])};"undefined"!=typeof window&&(window.addEventListener?(window.addEventListener("mousedown",m),window.addEventListener("mouseup",m),window.addEventListener("keydown",m)):(document.documentElement.attachEvent("onmousedown",m),document.documentElement.attachEvent("onmouseup",m),document.documentElement.attachEvent("onkeydown",m))),o.next=setTimeout(s,y[w++])}return o.patches=l,o.object=v,o.unobserve=function(){O(o),clearTimeout(o.next),N(C,o),"undefined"!=typeof window&&(window.removeEventListener?(window.removeEventListener("mousedown",m),window.removeEventListener("mouseup",m),window.removeEventListener("keydown",m)):(document.documentElement.detachEvent("onmousedown",m),document.documentElement.detachEvent("onmouseup",m),document.documentElement.detachEvent("onkeydown",m)))},C.observers.push(new D(E,o)),o}function O(p){for(var l,u=0,s=q.length;s>u;u++){if(q[u].obj===p.object){l=q[u];break}}V(l.value,p.object,p.patches,""),p.patches.length&&I(l.value,p.patches);var m=p.patches;return m.length>0&&(p.patches=[],p.callback&&p.callback(m)),m}function V(E,S,u,m){for(var w=x(S),T=x(E),v=!1,R=!1,M=T.length-1;M>=0;M--){var y=T[M],C=E[y];if(S.hasOwnProperty(y)){var n=S[y];"object"==typeof C&&null!=C&&"object"==typeof n&&null!=n?V(C,n,u,m+"/"+K(y)):C!=n&&(v=!0,u.push({op:"replace",path:m+"/"+K(y),value:B(n)}))}else{u.push({op:"remove",path:m+"/"+K(y)}),R=!0}}if(R||w.length!=T.length){for(var M=0;M<w.length;M++){var y=w[M];E.hasOwnProperty(y)||u.push({op:"add",path:m+"/"+K(y),value:B(S[y])})}}}function Q(m){for(var l,s=0,p=m.length;p>s;){l=m.charCodeAt(s);if(!(l>=48&&57>=l)){return !1}s++}return !0}function I(R,ac,y){for(var w,m,E=!1,ad=0,C=ac.length;C>ad;){w=ac[ad],ad++;for(var aa=w.path||"",ab=aa.split("/"),T=R,M=1,S=ab.length,v=void 0;;){if(m=ab[M],y&&void 0===v&&(void 0===T[m]?v=ab.slice(0,M).join("/"):M==S-1&&(v=w.path),void 0!==v&&this.validator(w,ad-1,R,v)),M++,void 0===m&&M>=S){E=Z[w.op].call(w,T,m,R);break}if(i(T)){if("-"===m){m=T.length}else{if(y&&!Q(m)){throw new r("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",ad-1,w.path,w)}m=parseInt(m,10)}if(M>=S){if(y&&"add"===w.op&&m>T.length){throw new r("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",ad-1,w.path,w)}E=H[w.op].call(w,T,m,R);break}}else{if(m&&-1!=m.indexOf("~")&&(m=m.replace(/~1/g,"/").replace(/~0/g,"~")),M>=S){E=X[w.op].call(w,T,m,R);break}}T=T[m]}}return E}function P(m,l){var o=[];return V(m,l,o,""),o}function L(m){if(void 0===m){return !0}if("array"==typeof m||"object"==typeof m){for(var l in m){if(L(m[l])){return !0}}}return !1}function z(u,C,y,w){if("object"!=typeof u||null===u||i(u)){throw new r("Operation is not an object","OPERATION_NOT_AN_OBJECT",C,u,y)}if(!X[u.op]){throw new r("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",C,u,y)}if("string"!=typeof u.path){throw new r("Operation `path` property is not a string","OPERATION_PATH_INVALID",C,u,y)}if(("move"===u.op||"copy"===u.op)&&"string"!=typeof u.from){throw new r("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",C,u,y)}if(("add"===u.op||"replace"===u.op||"test"===u.op)&&void 0===u.value){throw new r("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",C,u,y)}if(("add"===u.op||"replace"===u.op||"test"===u.op)&&L(u.value)){throw new r("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",C,u,y)}if(y){if("add"==u.op){var p=u.path.split("/").length,v=w.split("/").length;if(p!==v+1&&p!==v){throw new r("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",C,u,y)}}else{if("replace"===u.op||"remove"===u.op||"_get"===u.op){if(u.path!==w){throw new r("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",C,u,y)}}else{if("move"===u.op||"copy"===u.op){var m={op:"_get",path:u.from,value:void 0},e=U.validate([m],y);if(e&&"OPERATION_PATH_UNRESOLVABLE"===e.name){throw new r("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",C,u,y)}}}}}}function A(m,l){try{if(!i(m)){throw new r("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY")}if(l){l=JSON.parse(JSON.stringify(l)),I.call(this,l,m,!0)}else{for(var s=0;s<m.length;s++){this.validator(m[s],s)}}}catch(p){if(p instanceof r){return p}throw p}}var x=function(m){if(i(m)){for(var l=new Array(m.length),s=0;s<l.length;s++){l[s]=""+s}return l}if(Object.keys){return Object.keys(m)}var l=[];for(var p in m){m.hasOwnProperty(p)&&l.push(p)}return l},X={add:function(m,l){return m[l]=this.value,!0},remove:function(m,l){return delete m[l],!0},replace:function(m,l){return m[l]=this.value,!0},move:function(m,l,s){var p={op:"_get",path:this.from};return I(s,[p]),I(s,[{op:"remove",path:this.from}]),I(s,[{op:"add",path:this.path,value:p.value}]),!0},copy:function(m,l,s){var p={op:"_get",path:this.from};return I(s,[p]),I(s,[{op:"add",path:this.path,value:p.value}]),!0},test:function(l,m){return F(l[m],this.value)},_get:function(m,l){this.value=m[l]}},H={add:function(m,l){return m.splice(l,0,this.value),!0},remove:function(m,l){return m.splice(l,1),!0},replace:function(m,l){return m[l]=this.value,!0},move:X.move,copy:X.copy,test:X.test,_get:X._get},Z={add:function(m){Z.remove.call(this,m);for(var l in this.value){this.value.hasOwnProperty(l)&&(m[l]=this.value[l])}return !0},remove:function(m){for(var l in m){m.hasOwnProperty(l)&&X.remove.call(this,m,l)}return !0},replace:function(l){return I(l,[{op:"remove",path:this.path}]),I(l,[{op:"add",path:this.path,value:this.value}]),!0},move:X.move,copy:X.copy,test:function(l){return JSON.stringify(l)===JSON.stringify(this.value)},_get:function(l){this.value=l}},q=[],k=function(){function l(m){this.observers=[],this.obj=m}return l}(),D=function(){function l(n,m){this.callback=n,this.observer=m}return l}();U.unobserve=Y,U.observe=W,U.generate=O;var i;i=Array.isArray?Array.isArray:function(l){return l.push&&"number"==typeof l.length},U.apply=I,U.compare=P;var r=function(m){function l(p,v,u,s,e){m.call(this,p),this.message=p,this.name=v,this.index=u,this.operation=s,this.tree=e}return f(l,m),l}(c);U.JsonPatchError=r,U.Error=r,U.validator=z,U.validate=A}(h||(h={})),"undefined"!=typeof j&&(j.apply=h.apply,j.observe=h.observe,j.unobserve=h.unobserve,j.generate=h.generate,j.compare=h.compare,j.validate=h.validate,j.validator=h.validator,j.JsonPatchError=h.JsonPatchError,j.Error=h.Error)},{}],moment:[function(c,e,d){!function(f,g){"object"==typeof d&&"undefined"!=typeof e?e.exports=g():"function"==typeof b&&b.amd?b(g):f.moment=g()}(this,function(){function eu(){return dI.apply(null,arguments)}function eb(f){dI=f}function d7(f){return f instanceof Array||"[object Array]"===Object.prototype.toString.call(f)}function ej(f){return f instanceof Date||"[object Date]"===Object.prototype.toString.call(f)}function d5(g,f){var i,h=[];for(i=0;i<g.length;++i){h.push(f(g[i],i))}return h}function eg(g,f){return Object.prototype.hasOwnProperty.call(g,f)}function ey(g,f){for(var h in f){eg(f,h)&&(g[h]=f[h])}return eg(f,"toString")&&(g.toString=f.toString),eg(f,"valueOf")&&(g.valueOf=f.valueOf),g}function d3(g,f,i,h){return dP(g,f,i,h,!0).utc()}function ew(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function ek(f){return null==f._pf&&(f._pf=ew()),f._pf}function ev(g){if(null==g._isValid){var f=ek(g);g._isValid=!(isNaN(g._d.getTime())||!(f.overflow<0)||f.empty||f.invalidMonth||f.invalidWeekday||f.nullInput||f.invalidFormat||f.userInvalidated),g._strict&&(g._isValid=g._isValid&&0===f.charsLeftOver&&0===f.unusedTokens.length&&void 0===f.bigHour)}return g._isValid}function eq(g){var f=d3(NaN);return null!=g?ey(ek(f),g):ek(f).userInvalidated=!0,f}function d9(f){return void 0===f}function em(h,f){var j,i,g;if(d9(f._isAMomentObject)||(h._isAMomentObject=f._isAMomentObject),d9(f._i)||(h._i=f._i),d9(f._f)||(h._f=f._f),d9(f._l)||(h._l=f._l),d9(f._strict)||(h._strict=f._strict),d9(f._tzm)||(h._tzm=f._tzm),d9(f._isUTC)||(h._isUTC=f._isUTC),d9(f._offset)||(h._offset=f._offset),d9(f._pf)||(h._pf=ek(f)),d9(f._locale)||(h._locale=f._locale),aY.length>0){for(j in aY){i=aY[j],g=f[i],d9(g)||(h[i]=g)}}return h}function ed(f){em(this,f),this._d=new Date(null!=f._d?f._d.getTime():NaN),b7===!1&&(b7=!0,eu.updateOffset(this),b7=!1)}function d1(f){return f instanceof ed||null!=f&&null!=f._isAMomentObject}function d2(f){return 0>f?Math.ceil(f):Math.floor(f)}function dZ(g){var f=+g,h=0;return 0!==f&&isFinite(f)&&(h=d2(f)),h}function ex(k,g,m){var l,j=Math.min(k.length,g.length),f=Math.abs(k.length-g.length),h=0;for(l=0;j>l;l++){(m&&k[l]!==g[l]||!m&&dZ(k[l])!==dZ(g[l]))&&h++}return h+f}function e7(f){eu.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+f)}function ez(g,f){var h=!0;return ey(function(){return h&&(e7(g+"\nArguments: "+Array.prototype.slice.call(arguments).join(", ")+"\n"+(new Error).stack),h=!1),f.apply(this,arguments)},f)}function eL(g,f){bT[g]||(e7(f),bT[g]=!0)}function eK(f){return f instanceof Function||"[object Function]"===Object.prototype.toString.call(f)}function e5(f){return"[object Object]"===Object.prototype.toString.call(f)}function eI(g){var f,h;for(h in g){f=g[h],eK(f)?this[h]=f:this["_"+h]=f}this._config=g,this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function eT(g,f){var i,h=ey({},g);for(i in f){eg(f,i)&&(e5(g[i])&&e5(f[i])?(h[i]={},ey(h[i],g[i]),ey(h[i],f[i])):null!=f[i]?h[i]=f[i]:delete h[i])}return h}function eQ(f){null!=f&&this.set(f)}function eh(f){return f?f.toLowerCase().replace("_","-"):f}function e0(j){for(var g,l,k,h,f=0;f<j.length;){for(h=eh(j[f]).split("-"),g=h.length,l=eh(j[f+1]),l=l?l.split("-"):null;g>0;){if(k=e6(h.slice(0,g).join("-"))){return k}if(l&&l.length>=g&&ex(h,l,!0)>=g-1){break}g--}f++}return null}function e6(g){var h=null;if(!c0[g]&&"undefined"!=typeof e&&e&&e.exports){try{h=bp._abbr,c("./locale/"+g),e9(h)}catch(f){}}return c0[g]}function e9(g,f){var h;return g&&(h=d9(f)?eR(g):d0(g,f),h&&(bp=h)),bp._abbr}function d0(g,f){return null!==f?(f.abbr=g,null!=c0[g]?(eL("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale"),f=eT(c0[g]._config,f)):null!=f.parentLocale&&(null!=c0[f.parentLocale]?f=eT(c0[f.parentLocale]._config,f):eL("parentLocaleUndefined","specified parentLocale is not defined yet")),c0[g]=new eQ(f),e9(g),c0[g]):(delete c0[g],null)}function eO(g,f){if(null!=f){var h;null!=c0[g]&&(f=eT(c0[g]._config,f)),h=new eQ(f),h.parentLocale=c0[g],c0[g]=h,e9(g)}else{null!=c0[g]&&(null!=c0[g].parentLocale?c0[g]=c0[g].parentLocale:null!=c0[g]&&delete c0[g])}return c0[g]}function eR(g){var f;if(g&&g._locale&&g._locale._abbr&&(g=g._locale._abbr),!g){return bp}if(!d7(g)){if(f=e6(g)){return f}g=[g]}return e0(g)}function eV(){return Object.keys(c0)}function eE(g,f){var h=g.toLowerCase();a8[h]=a8[h+"s"]=a8[f]=g}function eY(f){return"string"==typeof f?a8[f]||a8[f.toLowerCase()]:void 0}function ei(g){var f,i,h={};for(i in g){eg(g,i)&&(f=eY(i),f&&(h[f]=g[i]))}return h}function eF(f,g){return function(h){return null!=h?(e8(this,f,h),eu.updateOffset(this,g),this):e4(this,f)}}function e4(g,f){return g.isValid()?g._d["get"+(g._isUTC?"UTC":"")+f]():NaN}function e8(g,f,h){g.isValid()&&g._d["set"+(g._isUTC?"UTC":"")+f](h)}function dY(g,f){var h;if("object"==typeof g){for(h in g){this.set(h,g[h])}}else{if(g=eY(g),eK(this[g])){return this[g](f)}}return this}function eC(j,g,l){var k=""+Math.abs(j),h=g-k.length,f=j>=0;return(f?l?"+":"":"-")+Math.pow(10,Math.max(0,h)).toString().substr(1)+k}function eH(h,f,j,i){var g=i;"string"==typeof i&&(g=function(){return this[i]()}),h&&(ea[h]=g),f&&(ea[f[0]]=function(){return eC(g.apply(this,arguments),f[1],f[2])}),j&&(ea[j]=function(){return this.localeData().ordinal(g.apply(this,arguments),h)})}function e2(f){return f.match(/\[[\s\S]/)?f.replace(/^\[|\]$/g,""):f.replace(/\\/g,"")}function fu(g){var f,i,h=g.match(cx);for(f=0,i=h.length;i>f;f++){ea[h[f]]?h[f]=ea[h[f]]:h[f]=e2(h[f])}return function(k){var j="";for(f=0;i>f;f++){j+=h[f] instanceof Function?h[f].call(k,g):h[f]}return j}}function eD(g,f){return g.isValid()?(f=eW(f,g.localeData()),aO[f]=aO[f]||fu(f),aO[f](g)):g.localeData().invalidDate()}function eW(g,f){function i(j){return f.longDateFormat(j)||j}var h=5;for(fi.lastIndex=0;h>=0&&fi.test(g);){g=g.replace(fi,i),fi.lastIndex=0,h-=1}return g}function d8(g,f,h){cH[g]=eK(f)?f:function(i,j){return i&&h?h:f}}function eB(g,f){return eg(cH,g)?cH[g](f._strict,f._locale):new RegExp(eX(g))}function eX(f){return eM(f.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(i,g,k,j,h){return g||k||j||h}))}function eM(f){return f.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function dO(g,f){var i,h=f;for("string"==typeof g&&(g=[g]),"number"==typeof f&&(h=function(j,k){k[f]=dZ(j)}),i=0;i<g.length;i++){fp[g[i]]=h}}function a0(g,f){dO(g,function(i,k,j,h){j._w=j._w||{},f(i,j._w,j,h)})}function cf(g,f,h){null!=f&&eg(fp,g)&&fp[g](f,h._a,h,g)}function bZ(g,f){return new Date(Date.UTC(g,f+1,0)).getUTCDate()}function bx(g,f){return d7(this._months)?this._months[g.month()]:this._months[bX.test(f)?"format":"standalone"][g.month()]}function c5(g,f){return d7(this._monthsShort)?this._monthsShort[g.month()]:this._monthsShort[bX.test(f)?"format":"standalone"][g.month()]}function bd(j,g,l){var k,h,f;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),k=0;12>k;k++){if(h=d3([2000,k]),l&&!this._longMonthsParse[k]&&(this._longMonthsParse[k]=new RegExp("^"+this.months(h,"").replace(".","")+"$","i"),this._shortMonthsParse[k]=new RegExp("^"+this.monthsShort(h,"").replace(".","")+"$","i")),l||this._monthsParse[k]||(f="^"+this.months(h,"")+"|^"+this.monthsShort(h,""),this._monthsParse[k]=new RegExp(f.replace(".",""),"i")),l&&"MMMM"===g&&this._longMonthsParse[k].test(j)){return k}if(l&&"MMM"===g&&this._shortMonthsParse[k].test(j)){return k}if(!l&&this._monthsParse[k].test(j)){return k}}}function cD(g,f){var h;if(!g.isValid()){return g}if("string"==typeof f){if(/^\d+$/.test(f)){f=dZ(f)}else{if(f=g.localeData().monthsParse(f),"number"!=typeof f){return g}}}return h=Math.min(g.date(),bZ(g.year(),f)),g._d["set"+(g._isUTC?"UTC":"")+"Month"](f,h),g}function fs(f){return null!=f?(cD(this,f),eu.updateOffset(this,!0),this):e4(this,"Month")}function aQ(){return bZ(this.year(),this.month())}function es(f){return this._monthsParseExact?(eg(this,"_monthsRegex")||dW.call(this),f?this._monthsShortStrictRegex:this._monthsShortRegex):this._monthsShortStrictRegex&&f?this._monthsShortStrictRegex:this._monthsShortRegex}function dg(f){return this._monthsParseExact?(eg(this,"_monthsRegex")||dW.call(this),f?this._monthsStrictRegex:this._monthsRegex):this._monthsStrictRegex&&f?this._monthsStrictRegex:this._monthsRegex}function dW(){function j(m,i){return i.length-m.length}var g,l,k=[],h=[],f=[];for(g=0;12>g;g++){l=d3([2000,g]),k.push(this.monthsShort(l,"")),h.push(this.months(l,"")),f.push(this.months(l,"")),f.push(this.monthsShort(l,""))}for(k.sort(j),h.sort(j),f.sort(j),g=0;12>g;g++){k[g]=eM(k[g]),h[g]=eM(h[g]),f[g]=eM(f[g])}this._monthsRegex=new RegExp("^("+f.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+h.join("|")+")$","i"),this._monthsShortStrictRegex=new RegExp("^("+k.join("|")+")$","i")}function dE(g){var f,h=g._a;return h&&-2===ek(g).overflow&&(f=h[bh]<0||h[bh]>11?bh:h[t]<1||h[t]>bZ(h[aJ],h[bh])?t:h[c3]<0||h[c3]>24||24===h[c3]&&(0!==h[dq]||0!==h[dM]||0!==h[bN])?c3:h[dq]<0||h[dq]>59?dq:h[dM]<0||h[dM]>59?dM:h[bN]<0||h[bN]>999?bN:-1,ek(g)._overflowDayOfYear&&(aJ>f||f>t)&&(f=t),ek(g)._overflowWeeks&&-1===f&&(f=eZ),ek(g)._overflowWeekday&&-1===f&&(f=cR),ek(g).overflow=f),g}function bP(m){var q,h,g,f,k,u,j=m._i,p=cc.exec(j)||fD.exec(j);if(p){for(ek(m).iso=!0,q=0,h=bD.length;h>q;q++){if(bD[q][1].exec(p[1])){f=bD[q][0],g=bD[q][2]!==!1;break}}if(null==f){return void (m._isValid=!1)}if(p[3]){for(q=0,h=dU.length;h>q;q++){if(dU[q][1].exec(p[3])){k=(p[2]||" ")+dU[q][0];break}}if(null==k){return void (m._isValid=!1)}}if(!g&&null!=k){return void (m._isValid=!1)}if(p[4]){if(!b3.exec(p[4])){return void (m._isValid=!1)}u="Z"}m._f=f+(k||"")+(u||""),cN(m)}else{m._isValid=!1}}function du(f){var g=bA.exec(f._i);return null!==g?void (f._d=new Date(+g[1])):(bP(f),void (f._isValid===!1&&(delete f._isValid,eu.createFromInputFallback(f))))}function cs(m,h,q,p,k,g,j){var f=new Date(m,h,q,p,k,g,j);return 100>m&&m>=0&&isFinite(f.getFullYear())&&f.setFullYear(m),f}function aw(g){var f=new Date(Date.UTC.apply(null,arguments));return 100>g&&g>=0&&isFinite(f.getUTCFullYear())&&f.setUTCFullYear(g),f}function aG(f){return fA(f)?366:365}function fA(f){return f%4===0&&f%100!==0||f%400===0}function e3(){return fA(this.year())}function aV(h,f,j){var i=7+f-j,g=(7+aw(h,0,i).getUTCDay()-f)%7;return -g+i-1}function al(m,v,h,g,f){var k,w,j=(7+h-g)%7,p=aV(m,g,f),q=1+7*(v-1)+j+p;return 0>=q?(k=m-1,w=aG(k)+q):q>aG(m)?(k=m+1,w=q-aG(m)):(k=m,w=q),{year:k,dayOfYear:w}}function cO(k,g,m){var l,j,f=aV(k.year(),g,m),h=Math.floor((k.dayOfYear()-f-1)/7)+1;return 1>h?(j=k.year()-1,l=h+cE(j,g,m)):h>cE(k.year(),g,m)?(l=h-cE(k.year(),g,m),j=k.year()+1):(j=k.year(),l=h),{week:l,year:j}}function cE(h,f,j){var i=aV(h,f,j),g=aV(h+1,f,j);return(aG(h)-i+g)/7}function aB(g,f,h){return null!=g?g:null!=f?f:h}function cu(f){var g=new Date(eu.now());return f._useUTC?[g.getUTCFullYear(),g.getUTCMonth(),g.getUTCDate()]:[g.getFullYear(),g.getMonth(),g.getDate()]}function dF(j){var g,l,k,h,f=[];if(!j._d){for(k=cu(j),j._w&&null==j._a[t]&&null==j._a[bh]&&dh(j),j._dayOfYear&&(h=aB(j._a[aJ],k[aJ]),j._dayOfYear>aG(h)&&(ek(j)._overflowDayOfYear=!0),l=aw(h,0,j._dayOfYear),j._a[bh]=l.getUTCMonth(),j._a[t]=l.getUTCDate()),g=0;3>g&&null==j._a[g];++g){j._a[g]=f[g]=k[g]}for(;7>g;g++){j._a[g]=f[g]=null==j._a[g]?2===g?1:0:j._a[g]}24===j._a[c3]&&0===j._a[dq]&&0===j._a[dM]&&0===j._a[bN]&&(j._nextDay=!0,j._a[c3]=0),j._d=(j._useUTC?aw:cs).apply(null,f),null!=j._tzm&&j._d.setUTCMinutes(j._d.getUTCMinutes()-j._tzm),j._nextDay&&(j._a[c3]=24)}}function dh(m){var q,h,g,f,k,u,j,p;q=m._w,null!=q.GG||null!=q.W||null!=q.E?(k=1,u=4,h=aB(q.GG,m._a[aJ],cO(bQ(),1,4).year),g=aB(q.W,1),f=aB(q.E,1),(1>f||f>7)&&(p=!0)):(k=m._locale._week.dow,u=m._locale._week.doy,h=aB(q.gg,m._a[aJ],cO(bQ(),k,u).year),g=aB(q.w,1),null!=q.d?(f=q.d,(0>f||f>6)&&(p=!0)):null!=q.e?(f=q.e+k,(q.e<0||q.e>6)&&(p=!0)):f=k),1>g||g>cE(h,k,u)?ek(m)._overflowWeeks=!0:null!=p?ek(m)._overflowWeekday=!0:(j=al(h,g,f,k,u),m._a[aJ]=j.year,m._dayOfYear=j.dayOfYear)}function cN(q){if(q._f===eu.ISO_8601){return void bP(q)}q._a=[],ek(q).empty=!0;var h,g,f,k,v,j=""+q._i,m=j.length,p=0;for(f=eW(q._f,q._locale).match(cx)||[],h=0;h<f.length;h++){k=f[h],g=(j.match(eB(k,q))||[])[0],g&&(v=j.substr(0,j.indexOf(g)),v.length>0&&ek(q).unusedInput.push(v),j=j.slice(j.indexOf(g)+g.length),p+=g.length),ea[k]?(g?ek(q).empty=!1:ek(q).unusedTokens.push(k),cf(k,g,q)):q._strict&&!g&&ek(q).unusedTokens.push(k)}ek(q).charsLeftOver=m-p,j.length>0&&ek(q).unusedInput.push(j),ek(q).bigHour===!0&&q._a[c3]<=12&&q._a[c3]>0&&(ek(q).bigHour=void 0),q._a[c3]=fv(q._locale,q._a[c3],q._meridiem),dF(q),dE(q)}function fv(g,f,i){var h;return null==i?f:null!=g.meridiemHour?g.meridiemHour(f,i):null!=g.isPM?(h=g.isPM(i),h&&12>f&&(f+=12),h||12!==f||(f=0),f):f}function aL(j){var g,l,k,h,f;if(0===j._f.length){return ek(j).invalidFormat=!0,void (j._d=new Date(NaN))}for(h=0;h<j._f.length;h++){f=0,g=em({},j),null!=j._useUTC&&(g._useUTC=j._useUTC),g._f=j._f[h],cN(g),ev(g)&&(f+=ek(g).charsLeftOver,f+=10*ek(g).unusedTokens.length,ek(g).score=f,(null==k||k>f)&&(k=f,l=g))}ey(j,l||g)}function bk(g){if(!g._d){var f=ei(g._i);g._a=d5([f.year,f.month,f.day||f.date,f.hour,f.minute,f.second,f.millisecond],function(h){return h&&parseInt(h,10)}),dF(g)}}function ag(g){var f=new ed(dE(c6(g)));return f._nextDay&&(f.add(1,"d"),f._nextDay=void 0),f}function c6(g){var f=g._i,h=g._f;return g._locale=g._locale||eR(g._l),null===f||void 0===h&&""===f?eq({nullInput:!0}):("string"==typeof f&&(g._i=f=g._locale.preparse(f)),d1(f)?new ed(dE(f)):(d7(h)?aL(g):h?cN(g):ej(f)?g._d=f:dv(g),ev(g)||(g._d=null),g))}function dv(f){var g=f._i;void 0===g?f._d=new Date(eu.now()):ej(g)?f._d=new Date(+g):"string"==typeof g?du(f):d7(g)?(f._a=d5(g.slice(0),function(h){return parseInt(h,10)}),dF(f)):"object"==typeof g?bk(f):"number"==typeof g?f._d=new Date(g):eu.createFromInputFallback(f)}function dP(j,g,l,k,h){var f={};return"boolean"==typeof l&&(k=l,l=void 0),f._isAMomentObject=!0,f._useUTC=f._isUTC=h,f._l=l,f._i=j,f._f=g,f._strict=k,ag(f)}function bQ(g,f,i,h){return dP(g,f,i,h,!1)}function fa(g,f){var i,h;if(1===f.length&&d7(f[0])&&(f=f[0]),!f.length){return bQ()}for(i=f[0],h=1;h<f.length;++h){f[h].isValid()&&!f[h][g](i)||(i=f[h])}return i}function cW(){var f=[].slice.call(arguments,0);return fa("isBefore",f)}function b0(){var f=[].slice.call(arguments,0);return fa("isAfter",f)}function am(m){var w=ei(m),h=w.year||0,g=w.quarter||0,f=w.month||0,k=w.week||0,x=w.day||0,j=w.hour||0,q=w.minute||0,v=w.second||0,p=w.millisecond||0;this._milliseconds=+p+1000*v+60000*q+3600000*j,this._days=+x+7*k,this._months=+f+3*g+12*h,this._data={},this._locale=eR(),this._bubble()}function a5(f){return f instanceof am}function fk(g,f){eH(g,0,0,function(){var h=this.utcOffset(),i="+";return 0>h&&(h=-h,i="-"),i+eC(~~(h/60),2)+f+eC(~~h%60,2)})}function by(j,g){var l=(g||"").match(j)||[],k=l[l.length-1]||[],h=(k+"").match(aX)||["-",0,0],f=+(60*h[1])+dZ(h[2]);return"+"===h[0]?f:-f}function cg(f,i){var h,g;return i._isUTC?(h=i.clone(),g=(d1(f)||ej(f)?+f:+bQ(f))-+h,h._d.setTime(+h._d+g),eu.updateOffset(h,!1),h):bQ(f).local()}function fF(f){return 15*-Math.round(f._d.getTimezoneOffset()/15)}function b9(f,i){var h,g=this._offset||0;return this.isValid()?null!=f?("string"==typeof f?f=by(cp,f):Math.abs(f)<16&&(f=60*f),!this._isUTC&&i&&(h=fF(this)),this._offset=f,this._isUTC=!0,null!=h&&this.add(h,"m"),g!==f&&(!i||this._changeInProgress?d4(this,bl(f-g,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,eu.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?g:fF(this):null!=f?this:NaN}function bG(g,f){return null!=g?("string"!=typeof g&&(g=-g),this.utcOffset(g,f),this):-this.utcOffset()}function dX(f){return this.utcOffset(0,f)}function bF(f){return this._isUTC&&(this.utcOffset(0,f),this._isUTC=!1,f&&this.subtract(fF(this),"m")),this}function bj(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(by(az,this._i)),this}function eA(f){return this.isValid()?(f=f?bQ(f).utcOffset():0,(this.utcOffset()-f)%60===0):!1}function cX(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function dG(){if(!d9(this._isDSTShifted)){return this._isDSTShifted}var g={};if(em(g,this),g=c6(g),g._a){var f=g._isUTC?d3(g._a):bQ(g._a);this._isDSTShifted=this.isValid()&&ex(g._a,f.toArray())>0}else{this._isDSTShifted=!1}return this._isDSTShifted}function aW(){return this.isValid()?!this._isUTC:!1}function b5(){return this.isValid()?this._isUTC:!1}function bR(){return this.isValid()?this._isUTC&&0===this._offset:!1}function bl(k,g){var m,l,j,f=k,h=null;return a5(k)?f={ms:k._milliseconds,d:k._days,M:k._months}:"number"==typeof k?(f={},g?f[g]=k:f.milliseconds=k):(h=b6.exec(k))?(m="-"===h[1]?-1:1,f={y:0,d:dZ(h[t])*m,h:dZ(h[c3])*m,m:dZ(h[dq])*m,s:dZ(h[dM])*m,ms:dZ(h[bN])*m}):(h=bS.exec(k))?(m="-"===h[1]?-1:1,f={y:cY(h[2],m),M:cY(h[3],m),w:cY(h[4],m),d:cY(h[5],m),h:cY(h[6],m),m:cY(h[7],m),s:cY(h[8],m)}):null==f?f={}:"object"==typeof f&&("from" in f||"to" in f)&&(j=cv(bQ(f.from),bQ(f.to)),f={},f.ms=j.milliseconds,f.M=j.months),l=new am(f),a5(k)&&eg(k,"_locale")&&(l._locale=k._locale),l}function cY(g,f){var h=g&&parseFloat(g.replace(",","."));return(isNaN(h)?0:h)*f}function a6(g,f){var h={milliseconds:0,months:0};return h.months=f.month()-g.month()+12*(f.year()-g.year()),g.clone().add(h.months,"M").isAfter(f)&&--h.months,h.milliseconds=+f-+g.clone().add(h.months,"M"),h}function cv(g,f){var h;return g.isValid()&&f.isValid()?(f=cg(f,g),g.isBefore(f)?h=a6(g,f):(h=a6(f,g),h.milliseconds=-h.milliseconds,h.months=-h.months),h):{milliseconds:0,months:0}}function fg(f){return 0>f?-1*Math.round(-1*f):Math.round(f)}function aM(g,f){return function(l,k){var j,h;return null===k||isNaN(+k)||(eL(f,"moment()."+f+"(period, number) is deprecated. Please use moment()."+f+"(number, period)."),h=l,l=k,k=h),l="string"==typeof l?+l:l,j=bl(l,k),d4(this,j,g),this}}function d4(h,p,m,k){var g=p._milliseconds,j=fg(p._days),f=fg(p._months);h.isValid()&&(k=null==k?!0:k,g&&h._d.setTime(+h._d+g*m),j&&e8(h,"Date",e4(h,"Date")+j*m),f&&cD(h,e4(h,"Month")+f*m),k&&eu.updateOffset(h,j||f))}function c7(k,g){var m=k||bQ(),l=cg(m,this).startOf("day"),j=this.diff(l,"days",!0),f=-6>j?"sameElse":-1>j?"lastWeek":0>j?"lastDay":1>j?"sameDay":2>j?"nextDay":7>j?"nextWeek":"sameElse",h=g&&(eK(g[f])?g[f]():g[f]);return this.format(h||this.localeData().calendar(f,this,bQ(m)))}function dQ(){return new ed(this)}function dw(g,f){var h=d1(g)?g:bQ(g);return this.isValid()&&h.isValid()?(f=eY(d9(f)?"millisecond":f),"millisecond"===f?+this>+h:+h<+this.clone().startOf(f)):!1}function bH(g,f){var h=d1(g)?g:bQ(g);return this.isValid()&&h.isValid()?(f=eY(d9(f)?"millisecond":f),"millisecond"===f?+h>+this:+this.clone().endOf(f)<+h):!1}function di(g,f,h){return this.isAfter(g,h)&&this.isBefore(f,h)}function ch(g,f){var i,h=d1(g)?g:bQ(g);return this.isValid()&&h.isValid()?(f=eY(f||"millisecond"),"millisecond"===f?+this===+h:(i=+h,+this.clone().startOf(f)<=i&&i<=+this.clone().endOf(f))):!1}function ap(g,f){return this.isSame(g,f)||this.isAfter(g,f)}function aC(g,f){return this.isSame(g,f)||this.isBefore(g,f)}function fw(k,g,m){var l,j,f,h;return this.isValid()?(l=cg(k,this),l.isValid()?(j=60000*(l.utcOffset()-this.utcOffset()),g=eY(g),"year"===g||"month"===g||"quarter"===g?(h=eG(this,l),"quarter"===g?h/=3:"year"===g&&(h/=12)):(f=this-l,h="second"===g?f/1000:"minute"===g?f/60000:"hour"===g?f/3600000:"day"===g?(f-j)/86400000:"week"===g?(f-j)/604800000:f),m?h:d2(h)):NaN):NaN}function eG(j,g){var l,k,h=12*(g.year()-j.year())+(g.month()-j.month()),f=j.clone().add(h,"months");return 0>g-f?(l=j.clone().add(h-1,"months"),k=(g-f)/(f-l)):(l=j.clone().add(h+1,"months"),k=(g-f)/(l-f)),-(h+k)}function aR(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function ab(){var f=this.clone().utc();return 0<f.year()&&f.year()<=9999?eK(Date.prototype.toISOString)?this.toDate().toISOString():eD(f,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):eD(f,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function cJ(f){var g=eD(this,f||eu.defaultFormat);return this.localeData().postformat(g)}function cz(g,f){return this.isValid()&&(d1(g)&&g.isValid()||bQ(g).isValid())?bl({to:this,from:g}).locale(this.locale()).humanize(!f):this.localeData().invalidDate()}function ax(f){return this.from(bQ(),f)}function cl(g,f){return this.isValid()&&(d1(g)&&g.isValid()||bQ(g).isValid())?bl({from:this,to:g}).locale(this.locale()).humanize(!f):this.localeData().invalidDate()}function dA(f){return this.to(bQ(),f)}function db(g){var f;return void 0===g?this._locale._abbr:(f=eR(g),null!=f&&(this._locale=f),this)}function cF(){return this._locale}function fl(f){switch(f=eY(f)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===f&&this.weekday(0),"isoWeek"===f&&this.isoWeekday(1),"quarter"===f&&this.month(3*Math.floor(this.month()/3)),this}function aH(f){return f=eY(f),void 0===f||"millisecond"===f?this:this.startOf(f).add(1,"isoWeek"===f?"week":f).subtract(1,"ms")}function bf(){return +this._d-60000*(this._offset||0)}function fG(){return Math.floor(+this/1000)}function c1(){return this._offset?new Date(+this):this._d}function dm(){var f=this;return[f.year(),f.month(),f.date(),f.hour(),f.minute(),f.second(),f.millisecond()]}function dK(){var f=this;return{years:f.year(),months:f.month(),date:f.date(),hours:f.hours(),minutes:f.minutes(),seconds:f.seconds(),milliseconds:f.milliseconds()}}function bL(){return this.isValid()?this.toISOString():null}function eS(){return ev(this)}function cP(){return ey({},ek(this))}function bV(){return ek(this).overflow}function ah(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function a1(g,f){eH(0,[g,g.length],0,f)}function fb(f){return b1.call(this,f,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function bs(f){return b1.call(this,f,this.isoWeek(),this.isoWeekday(),1,4)}function ca(){return cE(this.year(),1,4)}function fB(){var f=this.localeData()._week;return cE(this.year(),f.dow,f.doy)}function b1(j,g,l,k,h){var f;return null==j?cO(this,k,h).year:(f=cE(j,k,h),g>f&&(g=f),bC.call(this,j,g,l,k,h))}function bC(k,g,m,l,j){var f=al(k,g,m,l,j),h=aw(f.year,0,f.dayOfYear);return this.year(h.getUTCFullYear()),this.month(h.getUTCMonth()),this.date(h.getUTCDate()),this}function dT(f){return null==f?Math.ceil((this.month()+1)/3):this.month(3*(f-1)+this.month()%3)}function bz(f){return cO(f,this._week.dow,this._week.doy).week}function ba(){return this._week.dow}function ef(){return this._week.doy}function cT(g){var f=this.localeData().week(this);return null==g?f:this.add(7*(g-f),"d")}function dJ(g){var f=cO(this,1,4).week;return null==g?f:this.add(7*(g-f),"d")}function aZ(g,f){return"string"!=typeof g?g:isNaN(g)?(g=f.weekdaysParse(g),"number"==typeof g?g:null):parseInt(g,10)}function b8(g,f){return d7(this._weekdays)?this._weekdays[g.day()]:this._weekdays[this._weekdays.isFormat.test(f)?"format":"standalone"][g.day()]}function bU(f){return this._weekdaysShort[f.day()]}function bq(f){return this._weekdaysMin[f.day()]}function a9(j,g,l){var k,h,f;for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),k=0;7>k;k++){if(h=bQ([2000,1]).day(k),l&&!this._fullWeekdaysParse[k]&&(this._fullWeekdaysParse[k]=new RegExp("^"+this.weekdays(h,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[k]=new RegExp("^"+this.weekdaysShort(h,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[k]=new RegExp("^"+this.weekdaysMin(h,"").replace(".",".?")+"$","i")),this._weekdaysParse[k]||(f="^"+this.weekdays(h,"")+"|^"+this.weekdaysShort(h,"")+"|^"+this.weekdaysMin(h,""),this._weekdaysParse[k]=new RegExp(f.replace(".",""),"i")),l&&"dddd"===g&&this._fullWeekdaysParse[k].test(j)){return k}if(l&&"ddd"===g&&this._shortWeekdaysParse[k].test(j)){return k}if(l&&"dd"===g&&this._minWeekdaysParse[k].test(j)){return k}if(!l&&this._weekdaysParse[k].test(j)){return k}}}function cy(g){if(!this.isValid()){return null!=g?this:NaN}var f=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=g?(g=aZ(g,this.localeData()),this.add(g-f,"d")):f}function fj(g){if(!this.isValid()){return null!=g?this:NaN}var f=(this.day()+7-this.localeData()._week.dow)%7;return null==g?f:this.add(g-f,"d")}function aP(f){return this.isValid()?null==f?this.day()||7:this.day(this.day()%7?f:f-7):null!=f?this:NaN}function ec(g){var f=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/86400000)+1;return null==g?f:this.add(g-f,"d")}function da(){return this.hours()%12||12}function dS(g,f){eH(g,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),f)})}function dz(g,f){return f._meridiemParse}function bK(f){return"p"===(f+"").toLowerCase().charAt(0)}function dl(g,f,h){return g>11?h?"pm":"PM":h?"am":"AM"}function ck(g,f){f[bN]=dZ(1000*("0."+g))}function av(){return this._isUTC?"UTC":""}function aF(){return this._isUTC?"Coordinated Universal Time":""}function fz(f){return bQ(1000*f)}function eP(){return bQ.apply(null,arguments).parseZone()}function aU(g,f,i){var h=this._calendar[g];return eK(h)?h.call(f,i):h}function af(g){var f=this._longDateFormat[g],h=this._longDateFormat[g.toUpperCase()];return f||!h?f:(this._longDateFormat[g]=h.replace(/MMMM|MM|DD|dddd/g,function(i){return i.slice(1)}),this._longDateFormat[g])}function cM(){return this._invalidDate}function cC(f){return this._ordinal.replace("%d",f)}function aA(f){return f}function cq(h,f,j,i){var g=this._relativeTime[j];return eK(g)?g(h,f,j,i):g.replace(/%d/i,h)}function dD(g,f){var h=this._relativeTime[g>0?"future":"past"];return eK(h)?h(f):h.replace(/%s/i,f)}function df(j,g,l,k){var h=eR(),f=d3().set(k,g);return h[l](f,j)}function cI(k,g,m,l,j){if("number"==typeof k&&(g=k,k=void 0),k=k||"",null!=g){return df(k,g,m,j)}var f,h=[];for(f=0;l>f;f++){h[f]=df(k,f,m,j)}return h}function fq(g,f){return cI(g,f,"months",12,"month")}function aK(g,f){return cI(g,f,"monthsShort",12,"month")}function bi(g,f){return cI(g,f,"weekdays",7,"day")}function aa(g,f){return cI(g,f,"weekdaysShort",7,"day")}function c4(g,f){return cI(g,f,"weekdaysMin",7,"day")}function ds(){var f=this._data;return this._milliseconds=dB(this._milliseconds),this._days=dB(this._days),this._months=dB(this._months),f.milliseconds=dB(f.milliseconds),f.seconds=dB(f.seconds),f.minutes=dB(f.minutes),f.hours=dB(f.hours),f.months=dB(f.months),f.years=dB(f.years),this}function dN(h,f,j,i){var g=bl(f,j);return h._milliseconds+=i*g._milliseconds,h._days+=i*g._days,h._months+=i*g._months,h._bubble()}function bO(g,f){return dN(this,g,f,1)}function e1(g,f){return dN(this,g,f,-1)}function cS(f){return 0>f?Math.floor(f):Math.ceil(f)}function bY(){var m,q,h,g,f,k=this._milliseconds,u=this._days,j=this._months,p=this._data;return k>=0&&u>=0&&j>=0||0>=k&&0>=u&&0>=j||(k+=86400000*cS(a4(j)+u),u=0,j=0),p.milliseconds=k%1000,m=d2(k/1000),p.seconds=m%60,q=d2(m/60),p.minutes=q%60,h=d2(q/60),p.hours=h%24,u+=d2(h/24),f=d2(ak(u)),j+=f,u-=cS(a4(f)),g=d2(j/12),j%=12,p.days=u,p.months=j,p.years=g,this}function ak(f){return 4800*f/146097}function a4(f){return 146097*f/4800}function ff(g){var f,i,h=this._milliseconds;if(g=eY(g),"month"===g||"year"===g){return f=this._days+h/86400000,i=this._months+ak(f),"month"===g?i:i/12}switch(f=this._days+Math.round(a4(this._months)),g){case"week":return f/7+h/604800000;case"day":return f+h/86400000;case"hour":return 24*f+h/3600000;case"minute":return 1440*f+h/60000;case"second":return 86400*f+h/1000;case"millisecond":return Math.floor(86400000*f)+h;default:throw new Error("Unknown unit "+g)}}function bw(){return this._milliseconds+86400000*this._days+this._months%12*2592000000+31536000000*dZ(this._months/12)}function cd(f){return function(){return this.as(f)}}function fE(f){return f=eY(f),this[f+"s"]()}function b4(f){return function(){return this._data[f]}}function bE(){return d2(this.days()/7)}function dV(h,f,j,i,g){return g.relativeTime(f||1,!!j,h,i)}function bB(m,w,h){var g=bl(m).abs(),f=fc(g.as("s")),k=fc(g.as("m")),x=fc(g.as("h")),j=fc(g.as("d")),q=fc(g.as("M")),v=fc(g.as("y")),p=f<bu.s&&["s",f]||1>=k&&["m"]||k<bu.m&&["mm",k]||1>=x&&["h"]||x<bu.h&&["hh",x]||1>=j&&["d"]||j<bu.d&&["dd",j]||1>=q&&["M"]||q<bu.M&&["MM",q]||1>=v&&["y"]||["yy",v];return p[2]=w,p[3]=+m>0,p[4]=h,dV.apply(null,p)}function bc(g,f){return void 0===bu[g]?!1:void 0===f?bu[g]:(bu[g]=f,!0)}function ep(g){var f=this.localeData(),h=bB(this,!g,f);return g&&(h=f.pastFuture(+this,h)),f.postformat(h)}function cV(){var q,z,j,g=cb(this._milliseconds)/1000,f=cb(this._days),m=cb(this._months);q=d2(g/60),z=d2(q/60),g%=60,q%=60,j=d2(m/12),m%=12;var A=j,k=m,x=f,y=z,w=q,p=g,v=this.asSeconds();return v?(0>v?"-":"")+"P"+(A?A+"Y":"")+(k?k+"M":"")+(x?x+"D":"")+(y||w||p?"T":"")+(y?y+"H":"")+(w?w+"M":"")+(p?p+"S":""):"P0D"}var dI,aY=eu.momentProperties=[],b7=!1,bT={};eu.suppressDeprecationWarnings=!1;var bp,c0={},a8={},cx=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,fi=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,aO={},ea={},c9=/\d/,dy=/\d\d/,bJ=/\d{3}/,dk=/\d{4}/,cj=/[+-]?\d{6}/,au=/\d\d?/,aE=/\d\d\d\d?/,fy=/\d\d\d\d\d\d?/,eN=/\d{1,3}/,aT=/\d{1,4}/,ad=/[+-]?\d{1,6}/,cL=/\d+/,cB=/[+-]?\d+/,az=/Z|[+-]\d\d:?\d\d/gi,cp=/Z|[+-]\d\d(?::?\d\d)?/gi,dC=/[+-]?\d+(\.\d{1,3})?/,dd=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,cH={},fp={},aJ=0,bh=1,t=2,c3=3,dq=4,dM=5,bN=6,eZ=7,cR=8;eH("M",["MM",2],"Mo",function(){return this.month()+1}),eH("MMM",0,0,function(f){return this.localeData().monthsShort(this,f)}),eH("MMMM",0,0,function(f){return this.localeData().months(this,f)}),eE("month","M"),d8("M",au),d8("MM",au,dy),d8("MMM",function(g,f){return f.monthsShortRegex(g)}),d8("MMMM",function(g,f){return f.monthsRegex(g)}),dO(["M","MM"],function(g,f){f[bh]=dZ(g)-1}),dO(["MMM","MMMM"],function(h,f,j,i){var g=j._locale.monthsParse(h,i,j._strict);null!=g?f[bh]=g:ek(j).invalidMonth=h});var bX=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/,aj="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),a3="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),fd=dd,bv=dd,cc=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,fD=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,b3=/Z|[+-]\d\d(?::?\d\d)?/,bD=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],dU=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],bA=/^\/?Date\((\-?\d+)/i;eu.createFromInputFallback=ez("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(f){f._d=new Date(f._i+(f._useUTC?" UTC":""))}),eH("Y",0,0,function(){var f=this.year();return 9999>=f?""+f:"+"+f}),eH(0,["YY",2],0,function(){return this.year()%100}),eH(0,["YYYY",4],0,"year"),eH(0,["YYYYY",5],0,"year"),eH(0,["YYYYYY",6,!0],0,"year"),eE("year","y"),d8("Y",cB),d8("YY",au,dy),d8("YYYY",aT,dk),d8("YYYYY",ad,cj),d8("YYYYYY",ad,cj),dO(["YYYYY","YYYYYY"],aJ),dO("YYYY",function(f,g){g[aJ]=2===f.length?eu.parseTwoDigitYear(f):dZ(f)}),dO("YY",function(f,g){g[aJ]=eu.parseTwoDigitYear(f)}),dO("Y",function(g,f){f[aJ]=parseInt(g,10)}),eu.parseTwoDigitYear=function(f){return dZ(f)+(dZ(f)>68?1900:2000)};var bb=eF("FullYear",!1);eu.ISO_8601=function(){};var el=ez("moment().min is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var f=bQ.apply(null,arguments);return this.isValid()&&f.isValid()?this>f?this:f:eq()}),cU=ez("moment().max is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var f=bQ.apply(null,arguments);return this.isValid()&&f.isValid()?f>this?this:f:eq()}),dH=function(){return Date.now?Date.now():+new Date};fk("Z",":"),fk("ZZ",""),d8("Z",cp),d8("ZZ",cp),dO(["Z","ZZ"],function(g,f,h){h._useUTC=!0,h._tzm=by(cp,g)});var aX=/([\+\-]|\d\d)/gi;eu.updateOffset=function(){};var b6=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?\d*)?$/,bS=/^(-)?P(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)W)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?$/;bl.fn=am.prototype;var bm=aM(1,"add"),cZ=aM(-1,"subtract");eu.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var a7=ez("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(f){return void 0===f?this.localeData():this.locale(f)});eH(0,["gg",2],0,function(){return this.weekYear()%100}),eH(0,["GG",2],0,function(){return this.isoWeekYear()%100}),a1("gggg","weekYear"),a1("ggggg","weekYear"),a1("GGGG","isoWeekYear"),a1("GGGGG","isoWeekYear"),eE("weekYear","gg"),eE("isoWeekYear","GG"),d8("G",cB),d8("g",cB),d8("GG",au,dy),d8("gg",au,dy),d8("GGGG",aT,dk),d8("gggg",aT,dk),d8("GGGGG",ad,cj),d8("ggggg",ad,cj),a0(["gggg","ggggg","GGGG","GGGGG"],function(g,f,i,h){f[h.substr(0,2)]=dZ(g)}),a0(["gg","GG"],function(f,i,h,g){i[g]=eu.parseTwoDigitYear(f)}),eH("Q",0,"Qo","quarter"),eE("quarter","Q"),d8("Q",c9),dO("Q",function(g,f){f[bh]=3*(dZ(g)-1)}),eH("w",["ww",2],"wo","week"),eH("W",["WW",2],"Wo","isoWeek"),eE("week","w"),eE("isoWeek","W"),d8("w",au),d8("ww",au,dy),d8("W",au),d8("WW",au,dy),a0(["w","ww","W","WW"],function(g,f,i,h){f[h.substr(0,1)]=dZ(g)});var cw={dow:0,doy:6};eH("D",["DD",2],"Do","date"),eE("date","D"),d8("D",au),d8("DD",au,dy),d8("Do",function(g,f){return g?f._ordinalParse:f._ordinalParseLenient}),dO(["D","DD"],t),dO("Do",function(g,f){f[t]=dZ(g.match(au)[0],10)});var fh=eF("Date",!0);eH("d",0,"do","day"),eH("dd",0,0,function(f){return this.localeData().weekdaysMin(this,f)}),eH("ddd",0,0,function(f){return this.localeData().weekdaysShort(this,f)}),eH("dddd",0,0,function(f){return this.localeData().weekdays(this,f)}),eH("e",0,0,"weekday"),eH("E",0,0,"isoWeekday"),eE("day","d"),eE("weekday","e"),eE("isoWeekday","E"),d8("d",au),d8("e",au),d8("E",au),d8("dd",dd),d8("ddd",dd),d8("dddd",dd),a0(["dd","ddd","dddd"],function(h,f,j,i){var g=j._locale.weekdaysParse(h,i,j._strict);null!=g?f.d=g:ek(j).invalidWeekday=h}),a0(["d","e","E"],function(g,f,i,h){f[h]=dZ(g)});var aN="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),d6="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),c8="Su_Mo_Tu_We_Th_Fr_Sa".split("_");eH("DDD",["DDDD",3],"DDDo","dayOfYear"),eE("dayOfYear","DDD"),d8("DDD",eN),d8("DDDD",bJ),dO(["DDD","DDDD"],function(g,f,h){h._dayOfYear=dZ(g)}),eH("H",["HH",2],0,"hour"),eH("h",["hh",2],0,da),eH("hmm",0,0,function(){return""+da.apply(this)+eC(this.minutes(),2)}),eH("hmmss",0,0,function(){return""+da.apply(this)+eC(this.minutes(),2)+eC(this.seconds(),2)}),eH("Hmm",0,0,function(){return""+this.hours()+eC(this.minutes(),2)}),eH("Hmmss",0,0,function(){return""+this.hours()+eC(this.minutes(),2)+eC(this.seconds(),2)}),dS("a",!0),dS("A",!1),eE("hour","h"),d8("a",dz),d8("A",dz),d8("H",au),d8("h",au),d8("HH",au,dy),d8("hh",au,dy),d8("hmm",aE),d8("hmmss",fy),d8("Hmm",aE),d8("Hmmss",fy),dO(["H","HH"],c3),dO(["a","A"],function(g,f,h){h._isPm=h._locale.isPM(g),h._meridiem=g}),dO(["h","hh"],function(g,f,h){f[c3]=dZ(g),ek(h).bigHour=!0}),dO("hmm",function(g,f,i){var h=g.length-2;f[c3]=dZ(g.substr(0,h)),f[dq]=dZ(g.substr(h)),ek(i).bigHour=!0}),dO("hmmss",function(h,f,j){var i=h.length-4,g=h.length-2;f[c3]=dZ(h.substr(0,i)),f[dq]=dZ(h.substr(i,2)),f[dM]=dZ(h.substr(g)),ek(j).bigHour=!0}),dO("Hmm",function(g,f,i){var h=g.length-2;f[c3]=dZ(g.substr(0,h)),f[dq]=dZ(g.substr(h))}),dO("Hmmss",function(h,f,j){var i=h.length-4,g=h.length-2;f[c3]=dZ(h.substr(0,i)),f[dq]=dZ(h.substr(i,2)),f[dM]=dZ(h.substr(g))});var dR=/[ap]\.?m?\.?/i,dx=eF("Hours",!0);eH("m",["mm",2],0,"minute"),eE("minute","m"),d8("m",au),d8("mm",au,dy),dO(["m","mm"],dq);var bI=eF("Minutes",!1);eH("s",["ss",2],0,"second"),eE("second","s"),d8("s",au),d8("ss",au,dy),dO(["s","ss"],dM);var dj=eF("Seconds",!1);eH("S",0,0,function(){return ~~(this.millisecond()/100)}),eH(0,["SS",2],0,function(){return ~~(this.millisecond()/10)}),eH(0,["SSS",3],0,"millisecond"),eH(0,["SSSS",4],0,function(){return 10*this.millisecond()}),eH(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),eH(0,["SSSSSS",6],0,function(){return 1000*this.millisecond()}),eH(0,["SSSSSSS",7],0,function(){return 10000*this.millisecond()}),eH(0,["SSSSSSSS",8],0,function(){return 100000*this.millisecond()}),eH(0,["SSSSSSSSS",9],0,function(){return 1000000*this.millisecond()}),eE("millisecond","ms"),d8("S",eN,c9),d8("SS",eN,dy),d8("SSS",eN,bJ);var ci;for(ci="SSSS";ci.length<=9;ci+="S"){d8(ci,cL)}for(ci="S";ci.length<=9;ci+="S"){dO(ci,ck)}var aq=eF("Milliseconds",!1);eH("z",0,0,"zoneAbbr"),eH("zz",0,0,"zoneName");var aD=ed.prototype;aD.add=bm,aD.calendar=c7,aD.clone=dQ,aD.diff=fw,aD.endOf=aH,aD.format=cJ,aD.from=cz,aD.fromNow=ax,aD.to=cl,aD.toNow=dA,aD.get=dY,aD.invalidAt=bV,aD.isAfter=dw,aD.isBefore=bH,aD.isBetween=di,aD.isSame=ch,aD.isSameOrAfter=ap,aD.isSameOrBefore=aC,aD.isValid=eS,aD.lang=a7,aD.locale=db,aD.localeData=cF,aD.max=cU,aD.min=el,aD.parsingFlags=cP,aD.set=dY,aD.startOf=fl,aD.subtract=cZ,aD.toArray=dm,aD.toObject=dK,aD.toDate=c1,aD.toISOString=ab,aD.toJSON=bL,aD.toString=aR,aD.unix=fG,aD.valueOf=bf,aD.creationData=ah,aD.year=bb,aD.isLeapYear=e3,aD.weekYear=fb,aD.isoWeekYear=bs,aD.quarter=aD.quarters=dT,aD.month=fs,aD.daysInMonth=aQ,aD.week=aD.weeks=cT,aD.isoWeek=aD.isoWeeks=dJ,aD.weeksInYear=fB,aD.isoWeeksInYear=ca,aD.date=fh,aD.day=aD.days=cy,aD.weekday=fj,aD.isoWeekday=aP,aD.dayOfYear=ec,aD.hour=aD.hours=dx,aD.minute=aD.minutes=bI,aD.second=aD.seconds=dj,aD.millisecond=aD.milliseconds=aq,aD.utcOffset=b9,aD.utc=dX,aD.local=bF,aD.parseZone=bj,aD.hasAlignedHourOffset=eA,aD.isDST=cX,aD.isDSTShifted=dG,aD.isLocal=aW,aD.isUtcOffset=b5,aD.isUtc=bR,aD.isUTC=bR,aD.zoneAbbr=av,aD.zoneName=aF,aD.dates=ez("dates accessor is deprecated. Use date instead.",fh),aD.months=ez("months accessor is deprecated. Use month instead",fs),aD.years=ez("years accessor is deprecated. Use year instead",bb),aD.zone=ez("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",bG);var fx=aD,eJ={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},aS={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},ac="Invalid date",cK="%d",cA=/\d{1,2}/,ay={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},cm=eQ.prototype;cm._calendar=eJ,cm.calendar=aU,cm._longDateFormat=aS,cm.longDateFormat=af,cm._invalidDate=ac,cm.invalidDate=cM,cm._ordinal=cK,cm.ordinal=cC,cm._ordinalParse=cA,cm.preparse=aA,cm.postformat=aA,cm._relativeTime=ay,cm.relativeTime=cq,cm.pastFuture=dD,cm.set=eI,cm.months=bx,cm._months=aj,cm.monthsShort=c5,cm._monthsShort=a3,cm.monthsParse=bd,cm._monthsRegex=bv,cm.monthsRegex=dg,cm._monthsShortRegex=fd,cm.monthsShortRegex=es,cm.week=bz,cm._week=cw,cm.firstDayOfYear=ef,cm.firstDayOfWeek=ba,cm.weekdays=b8,cm._weekdays=aN,cm.weekdaysMin=bq,cm._weekdaysMin=c8,cm.weekdaysShort=bU,cm._weekdaysShort=d6,cm.weekdaysParse=a9,cm.isPM=bK,cm._meridiemParse=dR,cm.meridiem=dl,e9("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(g){var f=g%10,h=1===dZ(g%100/10)?"th":1===f?"st":2===f?"nd":3===f?"rd":"th";return g+h}}),eu.lang=ez("moment.lang is deprecated. Use moment.locale instead.",e9),eu.langData=ez("moment.langData is deprecated. Use moment.localeData instead.",eR);var dB=Math.abs,dc=cd("ms"),cG=cd("s"),fm=cd("m"),aI=cd("h"),bg=cd("d"),n=cd("w"),c2=cd("M"),dp=cd("y"),dL=b4("milliseconds"),bM=b4("seconds"),eU=b4("minutes"),cQ=b4("hours"),bW=b4("days"),ai=b4("months"),a2=b4("years"),fc=Math.round,bu={s:45,m:45,h:22,d:26,M:11},cb=Math.abs,fC=am.prototype;fC.abs=ds,fC.add=bO,fC.subtract=e1,fC.as=ff,fC.asMilliseconds=dc,fC.asSeconds=cG,fC.asMinutes=fm,fC.asHours=aI,fC.asDays=bg,fC.asWeeks=n,fC.asMonths=c2,fC.asYears=dp,fC.valueOf=bw,fC._bubble=bY,fC.get=fE,fC.milliseconds=dL,fC.seconds=bM,fC.minutes=eU,fC.hours=cQ,fC.days=bW,fC.weeks=bE,fC.months=ai,fC.years=a2,fC.humanize=ep,fC.toISOString=cV,fC.toString=cV,fC.toJSON=cV,fC.locale=db,fC.localeData=cF,fC.toIsoString=ez("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",cV),fC.lang=a7,eH("X",0,0,"unix"),eH("x",0,0,"valueOf"),d8("x",cB),d8("X",dC),dO("X",function(g,f,h){h._d=new Date(1000*parseFloat(g,10))}),dO("x",function(g,f,h){h._d=new Date(dZ(g))}),eu.version="2.12.0",eb(bQ),eu.fn=fx,eu.min=cW,eu.max=b0,eu.now=dH,eu.utc=d3,eu.unix=fz,eu.months=fq,eu.isDate=ej,eu.locale=e9,eu.invalid=eq,eu.duration=bl,eu.isMoment=d1,eu.weekdays=bi,eu.parseZone=eP,eu.localeData=eR,eu.isDuration=a5,eu.monthsShort=aK,eu.weekdaysMin=c4,eu.defineLocale=d0,eu.updateLocale=eO,eu.locales=eV,eu.weekdaysShort=aa,eu.normalizeUnits=eY,eu.relativeTimeThreshold=bc,eu.prototype=fx;var b2=eu;return b2})},{}],numeral:[function(c,e,d){
/*!
 * numeral.js
 * version : 1.5.3
 * author : Adam Draper
 * license : MIT
 * http://adamwdraper.github.com/Numeral-js/
 */
(function(){function x(f){this._value=f}function C(m,g,u,p){var l,f,h=Math.pow(10,g);return f=(u(m*h)/h).toFixed(g),p&&(l=new RegExp("0{1,"+p+"}$"),f=f.replace(l,"")),f}function A(g,f,i){var h;return h=f.indexOf("$")>-1?z(g,f,i):f.indexOf("%")>-1?E(g,f,i):f.indexOf(":")>-1?M(g,f):K(g._value,f,i)}function F(u,y){var h,g,f,p,N,m=y,w=["KB","MB","GB","TB","PB","EB","ZB","YB"],v=!1;if(y.indexOf(":")>-1){u._value=q(y)}else{if(y===n){u._value=0}else{for("."!==D[k].delimiters.decimal&&(y=y.replace(/\./g,"").replace(D[k].delimiters.decimal,".")),h=new RegExp("[^a-zA-Z]"+D[k].abbreviations.thousand+"(?:\\)|(\\"+D[k].currency.symbol+")?(?:\\))?)?$"),g=new RegExp("[^a-zA-Z]"+D[k].abbreviations.million+"(?:\\)|(\\"+D[k].currency.symbol+")?(?:\\))?)?$"),f=new RegExp("[^a-zA-Z]"+D[k].abbreviations.billion+"(?:\\)|(\\"+D[k].currency.symbol+")?(?:\\))?)?$"),p=new RegExp("[^a-zA-Z]"+D[k].abbreviations.trillion+"(?:\\)|(\\"+D[k].currency.symbol+")?(?:\\))?)?$"),N=0;N<=w.length&&!(v=y.indexOf(w[N])>-1?Math.pow(1024,N+1):!1);N++){}u._value=(v?v:1)*(m.match(h)?Math.pow(10,3):1)*(m.match(g)?Math.pow(10,6):1)*(m.match(f)?Math.pow(10,9):1)*(m.match(p)?Math.pow(10,12):1)*(y.indexOf("%")>-1?0.01:1)*((y.split("-").length+Math.min(y.split("(").length-1,y.split(")").length-1))%2?1:-1)*Number(y.replace(/[^0-9\.]+/g,"")),u._value=v?Math.ceil(u._value):u._value}}return u._value}function z(u,w,h){var g,f,p=w.indexOf("$"),y=w.indexOf("("),m=w.indexOf("-"),v="";return w.indexOf(" $")>-1?(v=" ",w=w.replace(" $","")):w.indexOf("$ ")>-1?(v=" ",w=w.replace("$ ","")):w=w.replace("$",""),f=K(u._value,w,h),1>=p?f.indexOf("(")>-1||f.indexOf("-")>-1?(f=f.split(""),g=1,(y>p||m>p)&&(g=0),f.splice(g,0,D[k].currency.symbol+v),f=f.join("")):f=D[k].currency.symbol+v+f:f.indexOf(")")>-1?(f=f.split(""),f.splice(-1,0,v+D[k].currency.symbol),f=f.join("")):f=f+v+D[k].currency.symbol,f}function E(l,g,p){var m,h="",f=100*l._value;return g.indexOf(" %")>-1?(h=" ",g=g.replace(" %","")):g=g.replace("%",""),m=K(f,g,p),m.indexOf(")")>-1?(m=m.split(""),m.splice(-1,0,h+"%"),m=m.join("")):m=m+h+"%",m}function M(g){var f=Math.floor(g._value/60/60),i=Math.floor((g._value-60*f*60)/60),h=Math.round(g._value-60*f*60-60*i);return f+":"+(10>i?"0"+i:i)+":"+(10>h?"0"+h:h)}function q(g){var f=g.split(":"),h=0;return 3===f.length?(h+=60*Number(f[0])*60,h+=60*Number(f[1]),h+=Number(f[2])):2===f.length&&(h+=60*Number(f[0]),h+=Number(f[1])),Number(h)}function K(ae,Q,Y){var W,aa,U,Z,ai,O,ag=!1,ab=!1,af=!1,ad="",X=!1,ac=!1,N=!1,ah=!1,V=!1,aj="",v="",o=Math.abs(ae),P=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],m="",w=!1;if(0===ae&&null!==n){return n}if(Q.indexOf("(")>-1?(ag=!0,Q=Q.slice(1,-1)):Q.indexOf("+")>-1&&(ab=!0,Q=Q.replace(/\+/g,"")),Q.indexOf("a")>-1&&(X=Q.indexOf("aK")>=0,ac=Q.indexOf("aM")>=0,N=Q.indexOf("aB")>=0,ah=Q.indexOf("aT")>=0,V=X||ac||N||ah,Q.indexOf(" a")>-1?(ad=" ",Q=Q.replace(" a","")):Q=Q.replace("a",""),o>=Math.pow(10,12)&&!V||ah?(ad+=D[k].abbreviations.trillion,ae/=Math.pow(10,12)):o<Math.pow(10,12)&&o>=Math.pow(10,9)&&!V||N?(ad+=D[k].abbreviations.billion,ae/=Math.pow(10,9)):o<Math.pow(10,9)&&o>=Math.pow(10,6)&&!V||ac?(ad+=D[k].abbreviations.million,ae/=Math.pow(10,6)):(o<Math.pow(10,6)&&o>=Math.pow(10,3)&&!V||X)&&(ad+=D[k].abbreviations.thousand,ae/=Math.pow(10,3))),Q.indexOf("b")>-1){for(Q.indexOf(" b")>-1?(aj=" ",Q=Q.replace(" b","")):Q=Q.replace("b",""),U=0;U<=P.length;U++){if(W=Math.pow(1024,U),aa=Math.pow(1024,U+1),ae>=W&&aa>ae){aj+=P[U],W>0&&(ae/=W);break}}}return Q.indexOf("o")>-1&&(Q.indexOf(" o")>-1?(v=" ",Q=Q.replace(" o","")):Q=Q.replace("o",""),v+=D[k].ordinal(ae)),Q.indexOf("[.]")>-1&&(af=!0,Q=Q.replace("[.]",".")),Z=ae.toString().split(".")[0],ai=Q.split(".")[1],O=Q.indexOf(","),ai?(ai.indexOf("[")>-1?(ai=ai.replace("]",""),ai=ai.split("["),m=C(ae,ai[0].length+ai[1].length,Y,ai[1].length)):m=C(ae,ai.length,Y),Z=m.split(".")[0],m=m.split(".")[1].length?D[k].delimiters.decimal+m.split(".")[1]:"",af&&0===Number(m.slice(1))&&(m="")):Z=C(ae,null,Y),Z.indexOf("-")>-1&&(Z=Z.slice(1),w=!0),O>-1&&(Z=Z.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+D[k].delimiters.thousands)),0===Q.indexOf(".")&&(Z=""),(ag&&w?"(":"")+(!ag&&w?"-":"")+(!w&&ab?"+":"")+Z+m+(v?v:"")+(ad?ad:"")+(aj?aj:"")+(ag&&w?")":"")}function G(g,f){D[g]=f}function J(g){var f=g.toString().split(".");return f.length<2?1:Math.pow(10,f[1].length)}function I(){var f=Array.prototype.slice.call(arguments);return f.reduce(function(h,g){var l=J(h),i=J(g);return l>i?l:i},-(1/0))}var B,H="1.5.3",D={},k="en",n=null,j="0,0",L="undefined"!=typeof e&&e.exports;B=function(f){return B.isNumeral(f)?f=f.value():0===f||"undefined"==typeof f?f=0:Number(f)||(f=B.fn.unformat(f)),new x(Number(f))},B.version=H,B.isNumeral=function(f){return f instanceof x},B.language=function(g,f){if(!g){return k}if(g&&!f){if(!D[g]){throw new Error("Unknown language : "+g)}k=g}return !f&&D[g]||G(g,f),B},B.languageData=function(f){if(!f){return D[k]}if(!D[f]){throw new Error("Unknown language : "+f)}return D[f]},B.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(g){var f=g%10;return 1===~~(g%100/10)?"th":1===f?"st":2===f?"nd":3===f?"rd":"th"},currency:{symbol:"$"}}),B.zeroFormat=function(f){n="string"==typeof f?f:null},B.defaultFormat=function(f){j="string"==typeof f?f:"0.0"},B.validate=function(v,O){var h,g,f,p,P,m,y,N;if("string"!=typeof v&&(v+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",v)),v=v.trim(),""===v){return !1}v=v.replace(/^[+-]?/,"");try{y=B.languageData(O)}catch(w){y=B.languageData(B.language())}return f=y.currency.symbol,P=y.abbreviations,h=y.delimiters.decimal,g="."===y.delimiters.thousands?"\\.":y.delimiters.thousands,N=v.match(/^[^\d\.\,]+/),null!==N&&(v=v.substr(1),N[0]!==f)?!1:(N=v.match(/[^\d]+$/),null!==N&&(v=v.slice(0,-1),N[0]!==P.thousand&&N[0]!==P.million&&N[0]!==P.billion&&N[0]!==P.trillion)?!1:v.match(/^\d+$/)?!0:(m=new RegExp(g+"{2}"),v.match(/[^\d.,]/g)?!1:(p=v.split(h),p.length>2?!1:p.length<2?!!p[0].match(/^\d+.*\d$/)&&!p[0].match(m):""===p[0]?!p[0].match(m)&&!!p[1].match(/^\d+$/):1===p[0].length?!!p[0].match(/^\d+$/)&&!p[0].match(m)&&!!p[1].match(/^\d+$/):!!p[0].match(/^\d+.*\d$/)&&!p[0].match(m)&&!!p[1].match(/^\d+$/))))},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(l,g){if(null===this||"undefined"==typeof this){throw new TypeError("Array.prototype.reduce called on null or undefined")}if("function"!=typeof l){throw new TypeError(l+" is not a function")}var p,m,h=this.length>>>0,f=!1;for(1<arguments.length&&(m=g,f=!0),p=0;h>p;++p){this.hasOwnProperty(p)&&(f?m=l(m,this[p],p,this):(m=this[p],f=!0))}if(!f){throw new TypeError("Reduce of empty array with no initial value")}return m}),B.fn=x.prototype={clone:function(){return B(this)},format:function(g,f){return A(this,g?g:j,void 0!==f?f:Math.round)},unformat:function(f){return"[object Number]"===Object.prototype.toString.call(f)?f:F(this,f?f:j)},value:function(){return this._value},valueOf:function(){return this._value},set:function(f){return this._value=Number(f),this},add:function(g){function f(m,i,p,l){return m+h*i}var h=I.call(null,this._value,g);return this._value=[this._value,g].reduce(f,0)/h,this},subtract:function(g){function f(m,i,p,l){return m-h*i}var h=I.call(null,this._value,g);return this._value=[g].reduce(f,this._value*h)/h,this},multiply:function(g){function f(l,h,p,m){var i=I(l,h);return l*i*(h*i)/(i*i)}return this._value=[this._value,g].reduce(f,1),this},divide:function(g){function f(l,h,p,m){var i=I(l,h);return l*i/(h*i)}return this._value=[this._value,g].reduce(f),this},difference:function(f){return Math.abs(B(this._value).subtract(f).value())}},L&&(e.exports=B),"undefined"==typeof ender&&(this.numeral=B),"function"==typeof b&&b.amd&&b([],function(){return B})}).call(window)},{}],pikaday:[function(c,e,d){
/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday
 */
;!function(j,g){var h;if("object"==typeof d){try{h=c("moment")}catch(f){}e.exports=g(h)}else{"function"==typeof b&&b.amd?b(function(k){var i="moment";try{h=k(i)}catch(l){}return g(h)}):j.Pikaday=g(j.moment)}}(this,function(ad){var K="function"==typeof ad,V=!!window.addEventListener,U=window.document,P=window.setTimeout,Z=function(h,f,i,g){V?h.addEventListener(f,i,!!g):h.attachEvent("on"+f,i)},L=function(h,f,i,g){V?h.removeEventListener(f,i,!!g):h.detachEvent("on"+f,i)},X=function(h,f,i){var g;U.createEvent?(g=U.createEvent("HTMLEvents"),g.initEvent(f,!0,!1),g=B(g,i),h.dispatchEvent(g)):U.createEventObject&&(g=U.createEventObject(),g=B(g,i),h.fireEvent("on"+f,g))},ah=function(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")},I=function(g,f){return -1!==(" "+g.className+" ").indexOf(" "+f+" ")},af=function(g,f){I(g,f)||(g.className=""===g.className?f:g.className+" "+f)},aa=function(g,f){g.className=ah((" "+g.className+" ").replace(" "+f+" "," "))},ae=function(f){return/Array/.test(Object.prototype.toString.call(f))},ac=function(f){return/Date/.test(Object.prototype.toString.call(f))&&!isNaN(f.getTime())},Q=function(g){var f=g.getDay();return 0===f||6===f},ab=function(f){return f%4===0&&f%100!==0||f%400===0},W=function(g,f){return[31,ab(g)?29:28,31,30,31,30,31,31,30,31,30,31][f]},F=function(f){ac(f)&&f.setHours(0,0,0,0)},G=function(g,f){return g.getTime()===f.getTime()},B=function(h,f,k){var i,g;for(i in f){g=void 0!==h[i],g&&"object"==typeof f[i]&&null!==f[i]&&void 0===f[i].nodeName?ac(f[i])?k&&(h[i]=new Date(f[i].getTime())):ae(f[i])?k&&(h[i]=f[i].slice(0)):h[i]=B({},f[i],k):!k&&g||(h[i]=f[i])}return h},ag=function(f){return f.month<0&&(f.year-=Math.ceil(Math.abs(f.month)/12),f.month+=12),f.month>11&&(f.year+=Math.floor(Math.abs(f.month)/12),f.month-=12),f},N={field:null,bound:void 0,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,onSelect:null,onOpen:null,onClose:null,onDraw:null},ai=function(g,f,h){for(f+=g.firstDay;f>=7;){f-=7}return h?g.i18n.weekdaysShort[f]:g.i18n.weekdays[f]},x=function(g){if(g.isEmpty){return'<td class="is-empty"></td>'}var f=[];return g.isDisabled&&f.push("is-disabled"),g.isToday&&f.push("is-today"),g.isSelected&&f.push("is-selected"),g.isInRange&&f.push("is-inrange"),g.isStartRange&&f.push("is-startrange"),g.isEndRange&&f.push("is-endrange"),'<td data-day="'+g.day+'" class="'+f.join(" ")+'"><button class="pika-button pika-day" type="button" data-pika-year="'+g.year+'" data-pika-month="'+g.month+'" data-pika-day="'+g.day+'">'+g.day+"</button></td>"},q=function(h,f,k){var i=new Date(k,0,1),g=Math.ceil(((new Date(k,f,h)-i)/86400000+i.getDay()+1)/7);return'<td class="pika-week">'+g+"</td>"},J=function(g,f){return"<tr>"+(f?g.reverse():g).join("")+"</tr>"},j=function(f){return"<tbody>"+f.join("")+"</tbody>"},A=function(g){var f,h=[];for(g.showWeekNumber&&h.push("<th></th>"),f=0;7>f;f++){h.push('<th scope="col"><abbr title="'+ai(g,f)+'">'+ai(g,f,!0)+"</abbr></th>")}return"<thead>"+(g.isRTL?h.reverse():h).join("")+"</thead>"},z=function(S,al,y,w,k){var H,am,E,aj,ak,T=S._o,M=y===T.minYear,R=y===T.maxYear,v='<div class="pika-title">',O=!0,C=!0;for(E=[],H=0;12>H;H++){E.push('<option value="'+(y===k?H-al:12+H-al)+'"'+(H===w?" selected":"")+(M&&H<T.minMonth||R&&H>T.maxMonth?"disabled":"")+">"+T.i18n.months[H]+"</option>")}for(aj='<div class="pika-label">'+T.i18n.months[w]+'<select class="pika-select pika-select-month" tabindex="-1">'+E.join("")+"</select></div>",ae(T.yearRange)?(H=T.yearRange[0],am=T.yearRange[1]+1):(H=y-T.yearRange,am=1+y+T.yearRange),E=[];am>H&&H<=T.maxYear;H++){H>=T.minYear&&E.push('<option value="'+H+'"'+(H===y?" selected":"")+">"+H+"</option>")}return ak='<div class="pika-label">'+y+T.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+E.join("")+"</select></div>",v+=T.showMonthAfterYear?ak+aj:aj+ak,M&&(0===w||T.minMonth>=w)&&(O=!1),R&&(11===w||T.maxMonth<=w)&&(C=!1),0===al&&(v+='<button class="pika-prev'+(O?"":" is-disabled")+'" type="button">'+T.i18n.previousMonth+"</button>"),al===S._o.numberOfMonths-1&&(v+='<button class="pika-next'+(C?"":" is-disabled")+'" type="button">'+T.i18n.nextMonth+"</button>"),v+="</div>"},Y=function(g,f){return'<table cellpadding="0" cellspacing="0" class="pika-table">'+A(g)+j(f)+"</table>"},D=function(h){var g=this,f=g.config(h);g._onMouseDown=function(l){if(g._v){l=l||window.event;var k=l.target||l.srcElement;if(k){if(I(k,"is-disabled")||(I(k,"pika-button")&&!I(k,"is-empty")?(g.setDate(new Date(k.getAttribute("data-pika-year"),k.getAttribute("data-pika-month"),k.getAttribute("data-pika-day"))),f.bound&&P(function(){g.hide(),f.field&&f.field.blur()},100)):I(k,"pika-prev")?g.prevMonth():I(k,"pika-next")&&g.nextMonth()),I(k,"pika-select")){g._c=!0}else{if(!l.preventDefault){return l.returnValue=!1,!1}l.preventDefault()}}}},g._onChange=function(l){l=l||window.event;var k=l.target||l.srcElement;k&&(I(k,"pika-select-month")?g.gotoMonth(k.value):I(k,"pika-select-year")&&g.gotoYear(k.value))},g._onInputChange=function(l){var k;l.firedBy!==g&&(K?(k=ad(f.field.value,f.format),k=k&&k.isValid()?k.toDate():null):k=new Date(Date.parse(f.field.value)),ac(k)&&g.setDate(k),g._v||g.show())},g._onInputFocus=function(){g.show()},g._onInputClick=function(){g.show()},g._onInputBlur=function(){var k=U.activeElement;do{if(I(k,"pika-single")){return}}while(k=k.parentNode);g._c||(g._b=P(function(){g.hide()},50)),g._c=!1},g._onClick=function(l){l=l||window.event;var k=l.target||l.srcElement,m=k;if(k){!V&&I(k,"pika-select")&&(k.onchange||(k.setAttribute("onchange","return;"),Z(k,"change",g._onChange)));do{if(I(m,"pika-single")||m===f.trigger){return}}while(m=m.parentNode);g._v&&k!==f.trigger&&m!==f.trigger&&g.hide()}},g.el=U.createElement("div"),g.el.className="pika-single"+(f.isRTL?" is-rtl":"")+(f.theme?" "+f.theme:""),Z(g.el,"mousedown",g._onMouseDown,!0),Z(g.el,"touchend",g._onMouseDown,!0),Z(g.el,"change",g._onChange),f.field&&(f.container?f.container.appendChild(g.el):f.bound?U.body.appendChild(g.el):f.field.parentNode.insertBefore(g.el,f.field.nextSibling),Z(f.field,"change",g._onInputChange),f.defaultDate||(K&&f.field.value?f.defaultDate=ad(f.field.value,f.format).toDate():f.defaultDate=new Date(Date.parse(f.field.value)),f.setDefaultDate=!0));var i=f.defaultDate;ac(i)?f.setDefaultDate?g.setDate(i,!0):g.gotoDate(i):g.gotoDate(new Date),f.bound?(this.hide(),g.el.className+=" is-bound",Z(f.trigger,"click",g._onInputClick),Z(f.trigger,"focus",g._onInputFocus),Z(f.trigger,"blur",g._onInputBlur)):this.show()};return D.prototype={config:function(g){this._o||(this._o=B({},N,!0));var f=B(this._o,g,!0);f.isRTL=!!f.isRTL,f.field=f.field&&f.field.nodeName?f.field:null,f.theme="string"==typeof f.theme&&f.theme?f.theme:null,f.bound=!!(void 0!==f.bound?f.field&&f.bound:f.field),f.trigger=f.trigger&&f.trigger.nodeName?f.trigger:f.field,f.disableWeekends=!!f.disableWeekends,f.disableDayFn="function"==typeof f.disableDayFn?f.disableDayFn:null;var i=parseInt(f.numberOfMonths,10)||1;if(f.numberOfMonths=i>4?4:i,ac(f.minDate)||(f.minDate=!1),ac(f.maxDate)||(f.maxDate=!1),f.minDate&&f.maxDate&&f.maxDate<f.minDate&&(f.maxDate=f.minDate=!1),f.minDate&&this.setMinDate(f.minDate),f.maxDate&&this.setMaxDate(f.maxDate),ae(f.yearRange)){var h=(new Date).getFullYear()-10;f.yearRange[0]=parseInt(f.yearRange[0],10)||h,f.yearRange[1]=parseInt(f.yearRange[1],10)||h}else{f.yearRange=Math.abs(parseInt(f.yearRange,10))||N.yearRange,f.yearRange>100&&(f.yearRange=100)}return f},toString:function(f){return ac(this._d)?K?ad(this._d).format(f||this._o.format):this._d.toDateString():""},getMoment:function(){return K?ad(this._d):null},setMoment:function(g,f){K&&ad.isMoment(g)&&this.setDate(g.toDate(),f)},getDate:function(){return ac(this._d)?new Date(this._d.getTime()):null},setDate:function(g,f){if(!g){return this._d=null,this._o.field&&(this._o.field.value="",X(this._o.field,"change",{firedBy:this})),this.draw()}if("string"==typeof g&&(g=new Date(Date.parse(g))),ac(g)){var i=this._o.minDate,h=this._o.maxDate;ac(i)&&i>g?g=i:ac(h)&&g>h&&(g=h),this._d=new Date(g.getTime()),F(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),X(this._o.field,"change",{firedBy:this})),f||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(h){var f=!0;if(ac(h)){if(this.calendars){var k=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),g=h.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),f=g<k.getTime()||i.getTime()<g}f&&(this.calendars=[{month:h.getMonth(),year:h.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustCalendars:function(){this.calendars[0]=ag(this.calendars[0]);for(var f=1;f<this._o.numberOfMonths;f++){this.calendars[f]=ag({month:this.calendars[0].month+f,year:this.calendars[0].year})}this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(f){isNaN(f)||(this.calendars[0].month=parseInt(f,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(f){isNaN(f)||(this.calendars[0].year=parseInt(f,10),this.adjustCalendars())},setMinDate:function(f){F(f),this._o.minDate=f,this._o.minYear=f.getFullYear(),this._o.minMonth=f.getMonth(),this.draw()},setMaxDate:function(f){F(f),this._o.maxDate=f,this._o.maxYear=f.getFullYear(),this._o.maxMonth=f.getMonth(),this.draw()},setStartRange:function(f){this._o.startRange=f},setEndRange:function(f){this._o.endRange=f},draw:function(m){if(this._v||m){var v=this._o,g=v.minYear,f=v.maxYear,k=v.minMonth,w=v.maxMonth,h="";this._y<=g&&(this._y=g,!isNaN(k)&&this._m<k&&(this._m=k)),this._y>=f&&(this._y=f,!isNaN(w)&&this._m>w&&(this._m=w));for(var p=0;p<v.numberOfMonths;p++){h+='<div class="pika-lendar">'+z(this,p,this.calendars[p].year,this.calendars[p].month,this.calendars[0].year)+this.render(this.calendars[p].year,this.calendars[p].month)+"</div>"}if(this.el.innerHTML=h,v.bound&&"hidden"!==v.field.type&&P(function(){v.trigger.focus()},1),"function"==typeof this._o.onDraw){var r=this;P(function(){r._o.onDraw.call(r)},0)}}},adjustPosition:function(){var m,w,g,f,k,y,h,p,v,o;if(!this._o.container){if(this.el.style.position="absolute",m=this._o.trigger,w=m,g=this.el.offsetWidth,f=this.el.offsetHeight,k=window.innerWidth||U.documentElement.clientWidth,y=window.innerHeight||U.documentElement.clientHeight,h=window.pageYOffset||U.body.scrollTop||U.documentElement.scrollTop,"function"==typeof m.getBoundingClientRect){o=m.getBoundingClientRect(),p=o.left+window.pageXOffset,v=o.bottom+window.pageYOffset}else{for(p=w.offsetLeft,v=w.offsetTop+w.offsetHeight;w=w.offsetParent;){p+=w.offsetLeft,v+=w.offsetTop}}(this._o.reposition&&p+g>k||this._o.position.indexOf("right")>-1&&p-g+m.offsetWidth>0)&&(p=p-g+m.offsetWidth),(this._o.reposition&&v+f>y+h||this._o.position.indexOf("top")>-1&&v-f-m.offsetHeight>0)&&(v=v-f-m.offsetHeight),this.el.style.left=p+"px",this.el.style.top=v+"px"}},render:function(ao,w){var aj=this._o,S=new Date,R=W(ao,w),al=new Date(ao,w,1).getDay(),E=[],ak=[];F(S),aj.firstDay>0&&(al-=aj.firstDay,0>al&&(al+=7));for(var at=R+al,v=at;v>7;){v-=7}at+=7-v;for(var aq=0,am=0;at>aq;aq++){var ap=new Date(ao,w,1+(aq-al)),an=ac(this._d)?G(ap,this._d):!1,p=G(ap,S),ar=al>aq||aq>=R+al,H=aj.startRange&&G(aj.startRange,ap),au=aj.endRange&&G(aj.endRange,ap),f=aj.startRange&&aj.endRange&&aj.startRange<ap&&ap<aj.endRange,m=aj.minDate&&ap<aj.minDate||aj.maxDate&&ap>aj.maxDate||aj.disableWeekends&&Q(ap)||aj.disableDayFn&&aj.disableDayFn(ap),k={day:1+(aq-al),month:w,year:ao,isSelected:an,isToday:p,isDisabled:m,isEmpty:ar,isStartRange:H,isEndRange:au,isInRange:f};ak.push(x(k)),7===++am&&(aj.showWeekNumber&&ak.unshift(q(aq-al,w,ao)),E.push(J(ak,aj.isRTL)),ak=[],am=0)}return Y(aj,E)},isVisible:function(){return this._v},show:function(){this._v||(aa(this.el,"is-hidden"),this._v=!0,this.draw(),this._o.bound&&(Z(U,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var f=this._v;f!==!1&&(this._o.bound&&L(U,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",af(this.el,"is-hidden"),this._v=!1,void 0!==f&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){this.hide(),L(this.el,"mousedown",this._onMouseDown,!0),L(this.el,"touchend",this._onMouseDown,!0),L(this.el,"change",this._onChange),this._o.field&&(L(this._o.field,"change",this._onInputChange),this._o.bound&&(L(this._o.trigger,"click",this._onInputClick),L(this._o.trigger,"focus",this._onInputFocus),L(this._o.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},D})},{moment:"moment"}],zeroclipboard:[function(c,e,d){
/*!
 * ZeroClipboard
 * The ZeroClipboard library provides an easy way to copy text to the clipboard using an invisible Adobe Flash movie and a JavaScript interface.
 * Copyright (c) 2009-2014 Jon Rohan, James M. Greene
 * Licensed MIT
 * http://zeroclipboard.org/
 * v2.2.0
 */
;!function(aF,aM){var aI,aT,aG,aQ=aF,a4=aQ.document,aE=aQ.navigator,a0=aQ.setTimeout,aU=aQ.clearTimeout,aZ=aQ.setInterval,aY=aQ.clearInterval,aL=aQ.getComputedStyle,aX=aQ.encodeURIComponent,aN=aQ.ActiveXObject,aC=aQ.Error,aD=aQ.Number.parseInt||aQ.parseInt,az=aQ.Number.parseFloat||aQ.parseFloat,a3=aQ.Number.isNaN||aQ.isNaN,bH=aQ.Date.now,a5=aQ.Object.keys,bk=aQ.Object.defineProperty,bj=aQ.Object.prototype.hasOwnProperty,bC=aQ.Array.prototype.slice,bg=function(){var g=function(j){return j};if("function"==typeof aQ.wrap&&"function"==typeof aQ.unwrap){try{var f=a4.createElement("div"),i=aQ.unwrap(f);1===f.nodeType&&i&&1===i.nodeType&&(g=aQ.unwrap)}catch(h){}}return g}(),br=function(f){return bC.call(f,0)},bn=function(){var o,j,p,m,h,k,g=br(arguments),f=g[0]||{};for(o=1,j=g.length;j>o;o++){if(null!=(p=g[o])){for(m in p){bj.call(p,m)&&(h=f[m],k=p[m],f!==k&&k!==aM&&(f[m]=k))}}}return f},aR=function(h){var f,j,i,g;if("object"!=typeof h||null==h||"number"==typeof h.nodeType){f=h}else{if("number"==typeof h.length){for(f=[],j=0,i=h.length;i>j;j++){bj.call(h,j)&&(f[j]=aR(h[j]))}}else{f={};for(g in h){bj.call(h,g)&&(f[g]=aR(h[g]))}}}return f},by=function(h,f){for(var j={},i=0,g=f.length;g>i;i++){f[i] in h&&(j[f[i]]=h[f[i]])}return j},bD=function(g,f){var i={};for(var h in g){-1===f.indexOf(h)&&(i[h]=g[h])}return i},bJ=function(g){if(g){for(var f in g){bj.call(g,f)&&delete g[f]}}return g},aA=function(g,f){if(g&&1===g.nodeType&&g.ownerDocument&&f&&(1===f.nodeType&&f.ownerDocument&&f.ownerDocument===g.ownerDocument||9===f.nodeType&&!f.ownerDocument&&f===g.ownerDocument)){do{if(g===f){return !0}g=g.parentNode}while(g)}return !1},bm=function(g){var f;return"string"==typeof g&&g&&(f=g.split("#")[0].split("?")[0],f=g.slice(0,g.lastIndexOf("/")+1)),f},bp=function(g){var f,h;return"string"==typeof g&&g&&(h=g.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),h&&h[1]?f=h[1]:(h=g.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),h&&h[1]&&(f=h[1]))),f},bs=function(){var g,f;try{throw new aC}catch(h){f=h}return f&&(g=f.sourceURL||f.fileName||bp(f.stack)),g},bc=function(){var g,f,h;if(a4.currentScript&&(g=a4.currentScript.src)){return g}if(f=a4.getElementsByTagName("script"),1===f.length){return f[0].src||aM}if("readyState" in f[0]){for(h=f.length;h--;){if("interactive"===f[h].readyState&&(g=f[h].src)){return g}}}return"loading"===a4.readyState&&(g=f[f.length-1].src)?g:(g=bs())?g:aM},bv=function(){var h,f,i,g=a4.getElementsByTagName("script");for(h=g.length;h--;){if(!(i=g[h].src)){f=null;break}if(i=bm(i),null==f){f=i}else{if(f!==i){f=null;break}}}return f||aM},aS=function(){var f=bm(bc())||bv()||"";return f+"ZeroClipboard.swf"},bd=function(){return null==aF.opener&&(!!aF.top&&aF!=aF.top||!!aF.parent&&aF!=aF.parent)}(),bB={bridge:null,version:"0.0.0",pluginType:"unknown",disabled:null,outdated:null,sandboxed:null,unavailable:null,degraded:null,deactivated:null,overdue:null,ready:null},bI="11.0.0",ay={},a9={},bf=null,bA=0,bU=0,bb={ready:"Flash communication is established",error:{"flash-disabled":"Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-sandboxed":"Attempting to run Flash in a sandboxed iframe, which is impossible","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-degraded":"Flash is unable to preserve data fidelity when communicating with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-overdue":"Flash communication was established but NOT within the acceptable time limit","version-mismatch":"ZeroClipboard JS version number does not match ZeroClipboard SWF version number","clipboard-error":"At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard","config-mismatch":"ZeroClipboard configuration does not match Flash's reality","swf-not-found":"The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity"}},bt=["flash-unavailable","flash-degraded","flash-overdue","version-mismatch","config-mismatch","clipboard-error"],aK=["flash-disabled","flash-outdated","flash-sandboxed","flash-unavailable","flash-degraded","flash-deactivated","flash-overdue"],a8=new RegExp("^flash-("+aK.map(function(f){return f.replace(/^flash-/,"")}).join("|")+")$"),bu=new RegExp("^flash-("+aK.slice(1).map(function(f){return f.replace(/^flash-/,"")}).join("|")+")$"),bl={swfPath:aS(),trustedDomains:aF.location.host?[aF.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:30000,autoActivate:!0,bubbleEvents:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999},ab=function(g){if("object"==typeof g&&null!==g){for(var f in g){if(bj.call(g,f)){if(/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(f)){bl[f]=g[f]}else{if(null==bB.bridge){if("containerId"===f||"swfObjectId"===f){if(!bO(g[f])){throw new Error("The specified `"+f+"` value is not valid as an HTML4 Element ID")}bl[f]=g[f]}else{bl[f]=g[f]}}}}}}if("string"!=typeof g||!g){return aR(bl)}if(bj.call(bl,g)){return bl[g]}},bE=function(){return bz(),{browser:by(aE,["userAgent","platform","appName"]),flash:bD(bB,["bridge"]),zeroclipboard:{version:aq.version,config:aq.config()}}},bw=function(){return !!(bB.disabled||bB.outdated||bB.sandboxed||bB.unavailable||bB.degraded||bB.deactivated)},aV=function(k,h){var m,g,j,f={};if("string"==typeof k&&k){j=k.toLowerCase().split(/\s+/)}else{if("object"==typeof k&&k&&"undefined"==typeof h){for(m in k){bj.call(k,m)&&"string"==typeof m&&m&&"function"==typeof k[m]&&aq.on(m,k[m])}}}if(j&&j.length){for(m=0,g=j.length;g>m;m++){k=j[m].replace(/^on/,""),f[k]=!0,ay[k]||(ay[k]=[]),ay[k].push(h)}if(f.ready&&bB.ready&&aq.emit({type:"ready"}),f.error){for(m=0,g=aK.length;g>m;m++){if(bB[aK[m].replace(/^flash-/,"")]===!0){aq.emit({type:"error",name:aK[m]});break}}aI!==aM&&aq.version!==aI&&aq.emit({type:"error",name:"version-mismatch",jsVersion:aq.version,swfVersion:aI})}}return aq},b5=function(k,g){var m,l,j,f,h;if(0===arguments.length){f=a5(ay)}else{if("string"==typeof k&&k){f=k.split(/\s+/)}else{if("object"==typeof k&&k&&"undefined"==typeof g){for(m in k){bj.call(k,m)&&"string"==typeof m&&m&&"function"==typeof k[m]&&aq.off(m,k[m])}}}}if(f&&f.length){for(m=0,l=f.length;l>m;m++){if(k=f[m].toLowerCase().replace(/^on/,""),h=ay[k],h&&h.length){if(g){for(j=h.indexOf(g);-1!==j;){h.splice(j,1),j=h.indexOf(g,j)}}else{h.length=0}}}}return aq},aO=function(g){var f;return f="string"==typeof g&&g?aR(ay[g])||null:aR(ay)},bS=function(g){var f,i,h;return g=bQ(g),g&&!aj(g)?"ready"===g.type&&bB.overdue===!0?aq.emit({type:"error",name:"flash-overdue"}):(f=bn({},g),bq.call(this,f),"copy"===g.type&&(h=aP(a9),i=h.data,bf=h.formatMap),i):void 0},b3=function(){var g=bB.sandboxed;if(bz(),"boolean"!=typeof bB.ready&&(bB.ready=!1),bB.sandboxed!==g&&bB.sandboxed===!0){bB.ready=!1,aq.emit({type:"error",name:"flash-sandboxed"})}else{if(!aq.isFlashUnusable()&&null===bB.bridge){var f=bl.flashLoadTimeout;"number"==typeof f&&f>=0&&(bA=a0(function(){"boolean"!=typeof bB.deactivated&&(bB.deactivated=!0),bB.deactivated===!0&&aq.emit({type:"error",name:"flash-deactivated"})},f)),bB.overdue=!1,ac()}}},bN=function(){aq.clearData(),aq.blur(),aq.emit("destroy"),bR(),aq.off()},a1=function(g,f){var i;if("object"==typeof g&&g&&"undefined"==typeof f){i=g,aq.clearData()}else{if("string"!=typeof g||!g){return}i={},i[g]=f}for(var h in i){"string"==typeof h&&h&&bj.call(i,h)&&"string"==typeof i[h]&&i[h]&&(a9[h]=i[h])}},aJ=function(f){"undefined"==typeof f?(bJ(a9),bf=null):"string"==typeof f&&bj.call(a9,f)&&delete a9[f]},bo=function(f){return"undefined"==typeof f?aR(a9):"string"==typeof f&&bj.call(a9,f)?a9[f]:void 0},am=function(g){if(g&&1===g.nodeType){aT&&(an(aT,bl.activeClass),aT!==g&&an(aT,bl.hoverClass)),aT=g,bx(g,bl.hoverClass);var f=g.getAttribute("title")||bl.title;if("string"==typeof f&&f){var i=bG(bB.bridge);i&&i.setAttribute("title",f)}var h=bl.forceHandCursor===!0||"pointer"===a7(g,"cursor");bL(h),n()}},b1=function(){var f=bG(bB.bridge);f&&(f.removeAttribute("title"),f.style.left="0px",f.style.top="-9999px",f.style.width="1px",f.style.height="1px"),aT&&(an(aT,bl.hoverClass),an(aT,bl.activeClass),aT=null)},ap=function(){return aT||null},bO=function(f){return"string"==typeof f&&f&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(f)},bQ=function(g){var f;if("string"==typeof g&&g?(f=g,g={}):"object"==typeof g&&g&&"string"==typeof g.type&&g.type&&(f=g.type),f){f=f.toLowerCase(),!g.target&&(/^(copy|aftercopy|_click)$/.test(f)||"error"===f&&"clipboard-error"===g.name)&&(g.target=aG),bn(g,{type:f,target:g.target||aT||null,relatedTarget:g.relatedTarget||null,currentTarget:bB&&bB.bridge||null,timeStamp:g.timeStamp||bH()||null});var h=bb[g.type];return"error"===g.type&&g.name&&h&&(h=h[g.name]),h&&(g.message=h),"ready"===g.type&&bn(g,{target:null,version:bB.version}),"error"===g.type&&(a8.test(g.name)&&bn(g,{target:null,minimumVersion:bI}),bu.test(g.name)&&bn(g,{version:bB.version})),"copy"===g.type&&(g.clipboardData={setData:aq.setData,clearData:aq.clearData}),"aftercopy"===g.type&&(g=b2(g,bf)),g.target&&!g.relatedTarget&&(g.relatedTarget=ah(g.target)),ar(g)}},ah=function(g){var f=g&&g.getAttribute&&g.getAttribute("data-clipboard-target");return f?a4.getElementById(f):null},ar=function(B){if(B&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(B.type)){var I=B.target,l="_mouseover"===B.type&&B.relatedTarget?B.relatedTarget:aM,j="_mouseout"===B.type&&B.relatedTarget?B.relatedTarget:aM,q=ad(I),J=aQ.screenLeft||aQ.screenX||0,H=aQ.screenTop||aQ.screenY||0,D=a4.body.scrollLeft+a4.documentElement.scrollLeft,x=a4.body.scrollTop+a4.documentElement.scrollTop,C=q.left+("number"==typeof B._stageX?B._stageX:0),A=q.top+("number"==typeof B._stageY?B._stageY:0),k=C-D,z=A-x,o=J+k,F=H+z,G="number"==typeof B.movementX?B.movementX:0,E="number"==typeof B.movementY?B.movementY:0;delete B._stageX,delete B._stageY,bn(B,{srcElement:I,fromElement:l,toElement:j,screenX:o,screenY:F,pageX:C,pageY:A,clientX:k,clientY:z,x:k,y:z,movementX:G,movementY:E,offsetX:0,offsetY:0,layerX:0,layerY:0})}return B},bV=function(g){var f=g&&"string"==typeof g.type&&g.type||"";return !/^(?:(?:before)?copy|destroy)$/.test(f)},bi=function(g,f,i,h){h?a0(function(){g.apply(f,i)},0):g.apply(f,i)},bq=function(m){if("object"==typeof m&&m&&m.type){var w=bV(m),j=ay["*"]||[],g=ay[m.type]||[],f=j.concat(g);if(f&&f.length){var k,x,q,v,p,l=this;for(k=0,x=f.length;x>k;k++){q=f[k],v=l,"string"==typeof q&&"function"==typeof aQ[q]&&(q=aQ[q]),"object"==typeof q&&q&&"function"==typeof q.handleEvent&&(v=q,q=q.handleEvent),"function"==typeof q&&(p=bn({},m),bi(q,v,[p],w))}}return this}},aa=function(g){var f=null;return(bd===!1||g&&"error"===g.type&&g.name&&-1!==bt.indexOf(g.name))&&(f=!1),f},aj=function(j){var i=j.target||aT||null,p="swf"===j._source;switch(delete j._source,j.type){case"error":var k="flash-sandboxed"===j.name||aa(j);"boolean"==typeof k&&(bB.sandboxed=k),-1!==aK.indexOf(j.name)?bn(bB,{disabled:"flash-disabled"===j.name,outdated:"flash-outdated"===j.name,unavailable:"flash-unavailable"===j.name,degraded:"flash-degraded"===j.name,deactivated:"flash-deactivated"===j.name,overdue:"flash-overdue"===j.name,ready:!1}):"version-mismatch"===j.name&&(aI=j.swfVersion,bn(bB,{disabled:!1,outdated:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1})),bK();break;case"ready":aI=j.swfVersion;var g=bB.deactivated===!0;bn(bB,{disabled:!1,outdated:!1,sandboxed:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:g,ready:!g}),bK();break;case"beforecopy":aG=i;break;case"copy":var f,h,m=j.relatedTarget;!a9["text/html"]&&!a9["text/plain"]&&m&&(h=m.value||m.outerHTML||m.innerHTML)&&(f=m.value||m.textContent||m.innerText)?(j.clipboardData.clearData(),j.clipboardData.setData("text/plain",f),h!==f&&j.clipboardData.setData("text/html",h)):!a9["text/plain"]&&j.target&&(f=j.target.getAttribute("data-clipboard-text"))&&(j.clipboardData.clearData(),j.clipboardData.setData("text/plain",f));break;case"aftercopy":b9(j),aq.clearData(),i&&i!==ax()&&i.focus&&i.focus();break;case"_mouseover":aq.focus(i),bl.bubbleEvents===!0&&p&&(i&&i!==j.relatedTarget&&!aA(j.relatedTarget,i)&&ao(bn({},j,{type:"mouseenter",bubbles:!1,cancelable:!1})),ao(bn({},j,{type:"mouseover"})));break;case"_mouseout":aq.blur(),bl.bubbleEvents===!0&&p&&(i&&i!==j.relatedTarget&&!aA(j.relatedTarget,i)&&ao(bn({},j,{type:"mouseleave",bubbles:!1,cancelable:!1})),ao(bn({},j,{type:"mouseout"})));break;case"_mousedown":bx(i,bl.activeClass),bl.bubbleEvents===!0&&p&&ao(bn({},j,{type:j.type.slice(1)}));break;case"_mouseup":an(i,bl.activeClass),bl.bubbleEvents===!0&&p&&ao(bn({},j,{type:j.type.slice(1)}));break;case"_click":aG=null,bl.bubbleEvents===!0&&p&&ao(bn({},j,{type:j.type.slice(1)}));break;case"_mousemove":bl.bubbleEvents===!0&&p&&ao(bn({},j,{type:j.type.slice(1)}))}return/^_(?:click|mouse(?:over|out|down|up|move))$/.test(j.type)?!0:void 0},b9=function(g){if(g.errors&&g.errors.length>0){var f=aR(g);bn(f,{type:"error",name:"clipboard-error"}),delete f.success,a0(function(){aq.emit(f)},0)}},ao=function(j){if(j&&"string"==typeof j.type&&j){var g,l=j.target||null,k=l&&l.ownerDocument||a4,h={view:k.defaultView||aQ,canBubble:!0,cancelable:!0,detail:"click"===j.type?1:0,button:"number"==typeof j.which?j.which-1:"number"==typeof j.button?j.button:k.createEvent?0:1},f=bn(h,j);l&&k.createEvent&&l.dispatchEvent&&(f=[f.type,f.canBubble,f.cancelable,f.view,f.detail,f.screenX,f.screenY,f.clientX,f.clientY,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey,f.button,f.relatedTarget],g=k.createEvent("MouseEvents"),g.initMouseEvent&&(g.initMouseEvent.apply(g,f),g._source="js",l.dispatchEvent(g)))}},bX=function(){var g=bl.flashLoadTimeout;if("number"==typeof g&&g>=0){var f=Math.min(1000,g/10),h=bl.swfObjectId+"_fallbackContent";bU=aZ(function(){var i=a4.getElementById(h);bP(i)&&(bK(),bB.deactivated=null,aq.emit({type:"error",name:"swf-not-found"}))},f)}},b6=function(){var f=a4.createElement("div");return f.id=bl.containerId,f.className=bl.containerClass,f.style.position="absolute",f.style.left="0px",f.style.top="-9999px",f.style.width="1px",f.style.height="1px",f.style.zIndex=""+b4(bl.zIndex),f},bG=function(g){for(var f=g&&g.parentNode;f&&"OBJECT"===f.nodeName&&f.parentNode;){f=f.parentNode}return f||null},ac=function(){var m,v=bB.bridge,j=bG(v);if(!v){var g=ag(aQ.location.host,bl),f="never"===g?"none":"all",k=a2(bn({jsVersion:aq.version},bl)),w=bl.swfPath+b7(bl.swfPath,bl);j=b6();var q=a4.createElement("div");j.appendChild(q),a4.body.appendChild(j);var p=a4.createElement("div"),l="activex"===bB.pluginType;p.innerHTML='<object id="'+bl.swfObjectId+'" name="'+bl.swfObjectId+'" width="100%" height="100%" '+(l?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+w+'"')+">"+(l?'<param name="movie" value="'+w+'"/>':"")+'<param name="allowScriptAccess" value="'+g+'"/><param name="allowNetworking" value="'+f+'"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="'+k+'"/><div id="'+bl.swfObjectId+'_fallbackContent">&nbsp;</div></object>',v=p.firstChild,p=null,bg(v).ZeroClipboard=aq,j.replaceChild(v,q),bX()}return v||(v=a4[bl.swfObjectId],v&&(m=v.length)&&(v=v[m-1]),!v&&j&&(v=j.firstChild)),bB.bridge=v||null,v},bR=function(){var g=bB.bridge;if(g){var f=bG(g);f&&("activex"===bB.pluginType&&"readyState" in g?(g.style.display="none",function h(){if(4===g.readyState){for(var i in g){"function"==typeof g[i]&&(g[i]=null)}g.parentNode&&g.parentNode.removeChild(g),f.parentNode&&f.parentNode.removeChild(f)}else{a0(h,10)}}()):(g.parentNode&&g.parentNode.removeChild(g),f.parentNode&&f.parentNode.removeChild(f))),bK(),bB.ready=null,bB.bridge=null,bB.deactivated=null,aI=aM}},aP=function(g){var f={},i={};if("object"==typeof g&&g){for(var h in g){if(h&&bj.call(g,h)&&"string"==typeof g[h]&&g[h]){switch(h.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":f.text=g[h],i.text=h;break;case"text/html":case"html":case"air:html":case"flash:html":f.html=g[h],i.html=h;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":f.rtf=g[h],i.rtf=h}}}return{data:f,formatMap:i}}},b2=function(m,h){if("object"!=typeof m||!m||"object"!=typeof h||!h){return m}var q={};for(var p in m){if(bj.call(m,p)){if("errors"===p){q[p]=m[p]?m[p].slice():[];for(var k=0,g=q[p].length;g>k;k++){q[p][k].format=h[q[p][k].format]}}else{if("success"!==p&&"data"!==p){q[p]=m[p]}else{q[p]={};var j=m[p];for(var f in j){f&&bj.call(j,f)&&bj.call(h,f)&&(q[p][h[f]]=j[f])}}}}}return q},b7=function(g,f){var h=null==f||f&&f.cacheBust===!0;return h?(-1===g.indexOf("?")?"?":"&")+"noCache="+bH():""},a2=function(k){var g,m,l,j,f="",h=[];if(k.trustedDomains&&("string"==typeof k.trustedDomains?j=[k.trustedDomains]:"object"==typeof k.trustedDomains&&"length" in k.trustedDomains&&(j=k.trustedDomains)),j&&j.length){for(g=0,m=j.length;m>g;g++){if(bj.call(j,g)&&j[g]&&"string"==typeof j[g]){if(l=bT(j[g]),!l){continue}if("*"===l){h.length=0,h.push(l);break}h.push.apply(h,[l,"//"+l,aQ.location.protocol+"//"+l])}}}return h.length&&(f+="trustedOrigins="+aX(h.join(","))),k.forceEnhancedClipboard===!0&&(f+=(f?"&":"")+"forceEnhancedClipboard=true"),"string"==typeof k.swfObjectId&&k.swfObjectId&&(f+=(f?"&":"")+"swfObjectId="+aX(k.swfObjectId)),"string"==typeof k.jsVersion&&k.jsVersion&&(f+=(f?"&":"")+"jsVersion="+aX(k.jsVersion)),f},bT=function(g){if(null==g||""===g){return null}if(g=g.replace(/^\s+|\s+$/g,""),""===g){return null}var f=g.indexOf("//");g=-1===f?g:g.slice(f+2);var h=g.indexOf("/");return g=-1===h?g:-1===f||0===h?null:g.slice(0,h),g&&".swf"===g.slice(-4).toLowerCase()?null:g||null},ag=function(){var f=function(i){var g,k,j,h=[];if("string"==typeof i&&(i=[i]),"object"!=typeof i||!i||"number"!=typeof i.length){return h}for(g=0,k=i.length;k>g;g++){if(bj.call(i,g)&&(j=bT(i[g]))){if("*"===j){h.length=0,h.push("*");break}-1===h.indexOf(j)&&h.push(j)}}return h};return function(h,l){var k=bT(l.swfPath);null===k&&(k=h);var j=f(l.trustedDomains),g=j.length;if(g>0){if(1===g&&"*"===j[0]){return"always"}if(-1!==j.indexOf(h)){return 1===g&&h===k?"sameDomain":"always"}}return"never"}}(),ax=function(){try{return a4.activeElement}catch(f){return null}},bx=function(j,g){var l,k,h,f=[];if("string"==typeof g&&g&&(f=g.split(/\s+/)),j&&1===j.nodeType&&f.length>0){if(j.classList){for(l=0,k=f.length;k>l;l++){j.classList.add(f[l])}}else{if(j.hasOwnProperty("className")){for(h=" "+j.className+" ",l=0,k=f.length;k>l;l++){-1===h.indexOf(" "+f[l]+" ")&&(h+=f[l]+" ")}j.className=h.replace(/^\s+|\s+$/g,"")}}}return j},an=function(j,g){var l,k,h,f=[];if("string"==typeof g&&g&&(f=g.split(/\s+/)),j&&1===j.nodeType&&f.length>0){if(j.classList&&j.classList.length>0){for(l=0,k=f.length;k>l;l++){j.classList.remove(f[l])}}else{if(j.className){for(h=(" "+j.className+" ").replace(/[\r\n\t]/g," "),l=0,k=f.length;k>l;l++){h=h.replace(" "+f[l]+" "," ")}j.className=h.replace(/^\s+|\s+$/g,"")}}}return j},a7=function(g,f){var h=aL(g,null).getPropertyValue(f);return"cursor"!==f||h&&"auto"!==h||"A"!==g.nodeName?h:"pointer"},ad=function(m){var w={left:0,top:0,width:0,height:0};if(m.getBoundingClientRect){var j=m.getBoundingClientRect(),g=aQ.pageXOffset,f=aQ.pageYOffset,k=a4.documentElement.clientLeft||0,x=a4.documentElement.clientTop||0,v=0,q=0;if("relative"===a7(a4.body,"position")){var l=a4.body.getBoundingClientRect(),p=a4.documentElement.getBoundingClientRect();v=l.left-p.left||0,q=l.top-p.top||0}w.left=j.left+g-k-v,w.top=j.top+f-x-q,w.width="width" in j?j.width:j.right-j.left,w.height="height" in j?j.height:j.bottom-j.top}return w},bP=function(m){if(!m){return !1}var q=aL(m,null),h=az(q.height)>0,g=az(q.width)>0,f=az(q.top)>=0,k=az(q.left)>=0,u=h&&g&&f&&k,j=u?null:ad(m),p="none"!==q.display&&"collapse"!==q.visibility&&(u||!!j&&(h||j.height>0)&&(g||j.width>0)&&(f||j.top>=0)&&(k||j.left>=0));return p},bK=function(){aU(bA),bA=0,aY(bU),bU=0},n=function(){var g;if(aT&&(g=bG(bB.bridge))){var f=ad(aT);bn(g.style,{width:f.width+"px",height:f.height+"px",top:f.top+"px",left:f.left+"px",zIndex:""+b4(bl.zIndex)})}},bL=function(f){bB.ready===!0&&(bB.bridge&&"function"==typeof bB.bridge.setHandCursor?bB.bridge.setHandCursor(f):bB.ready=!1)},b4=function(g){if(/^(?:auto|inherit)$/.test(g)){return g}var f;return"number"!=typeof g||a3(g)?"string"==typeof g&&(f=b4(aD(g,10))):f=g,"number"==typeof f?f:"auto"},bz=function(k){var p,m,j,g=bB.sandboxed,h=null;if(k=k===!0,bd===!1){h=!1}else{try{m=aF.frameElement||null}catch(f){j={name:f.name,message:f.message}}if(m&&1===m.nodeType&&"IFRAME"===m.nodeName){try{h=m.hasAttribute("sandbox")}catch(f){h=null}}else{try{p=document.domain||null}catch(f){p=null}(null===p||j&&"SecurityError"===j.name&&/(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(j.message.toLowerCase()))&&(h=!0)}}return bB.sandboxed=h,g===h||k||ak(aN),h},ak=function(x){function B(h){var f=h.match(/[\d]+/g);return f.length=3,f.join(".")}function m(f){return !!f&&(f=f.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(f)||"chrome.plugin"===f.slice(-13))}function k(f){f&&(q=!0,f.version&&(v=B(f.version)),!v&&f.description&&(v=B(f.description)),f.filename&&(z=m(f.filename)))}var g,u,C,q=!1,A=!1,z=!1,v="";if(aE.plugins&&aE.plugins.length){g=aE.plugins["Shockwave Flash"],k(g),aE.plugins["Shockwave Flash 2.0"]&&(q=!0,v="2.0.0.11")}else{if(aE.mimeTypes&&aE.mimeTypes.length){C=aE.mimeTypes["application/x-shockwave-flash"],g=C&&C.enabledPlugin,k(g)}else{if("undefined"!=typeof x){A=!0;try{u=new x("ShockwaveFlash.ShockwaveFlash.7"),q=!0,v=B(u.GetVariable("$version"))}catch(y){try{u=new x("ShockwaveFlash.ShockwaveFlash.6"),q=!0,v="6.0.21"}catch(w){try{u=new x("ShockwaveFlash.ShockwaveFlash"),q=!0,v=B(u.GetVariable("$version"))}catch(j){A=!1}}}}}}bB.disabled=q!==!0,bB.outdated=v&&az(v)<az(bI),bB.version=v||"0.0.0",bB.pluginType=z?"pepper":A?"activex":q?"netscape":"unknown"};ak(aN),bz(!0);var aq=function(){return this instanceof aq?void ("function"==typeof aq._createClient&&aq._createClient.apply(this,br(arguments))):new aq};bk(aq,"version",{value:"2.2.0",writable:!1,configurable:!0,enumerable:!0}),aq.config=function(){return ab.apply(this,br(arguments))},aq.state=function(){return bE.apply(this,br(arguments))},aq.isFlashUnusable=function(){return bw.apply(this,br(arguments))},aq.on=function(){return aV.apply(this,br(arguments))},aq.off=function(){return b5.apply(this,br(arguments))},aq.handlers=function(){return aO.apply(this,br(arguments))},aq.emit=function(){return bS.apply(this,br(arguments))},aq.create=function(){return b3.apply(this,br(arguments))},aq.destroy=function(){return bN.apply(this,br(arguments))},aq.setData=function(){return a1.apply(this,br(arguments))},aq.clearData=function(){return aJ.apply(this,br(arguments))},aq.getData=function(){return bo.apply(this,br(arguments))},aq.focus=aq.activate=function(){return am.apply(this,br(arguments))},aq.blur=aq.deactivate=function(){return b1.apply(this,br(arguments))},aq.activeElement=function(){return ap.apply(this,br(arguments))};var af=0,bZ={},aW=0,av={},b8={};bn(bl,{autoActivate:!0});var bh=function(g){var f=this;f.id=""+af++,bZ[f.id]={instance:f,elements:[],handlers:{}},g&&f.clip(g),aq.on("*",function(h){return f.emit(h)}),aq.on("destroy",function(){f.destroy()}),aq.create()},ba=function(o,k){var p,j,m,g={},f=bZ[this.id],h=f&&f.handlers;if(!f){throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance")}if("string"==typeof o&&o){m=o.toLowerCase().split(/\s+/)}else{if("object"==typeof o&&o&&"undefined"==typeof k){for(p in o){bj.call(o,p)&&"string"==typeof p&&p&&"function"==typeof o[p]&&this.on(p,o[p])}}}if(m&&m.length){for(p=0,j=m.length;j>p;p++){o=m[p].replace(/^on/,""),g[o]=!0,h[o]||(h[o]=[]),h[o].push(k)}if(g.ready&&bB.ready&&this.emit({type:"ready",client:this}),g.error){for(p=0,j=aK.length;j>p;p++){if(bB[aK[p].replace(/^flash-/,"")]){this.emit({type:"error",name:aK[p],client:this});break}}aI!==aM&&aq.version!==aI&&this.emit({type:"error",name:"version-mismatch",jsVersion:aq.version,swfVersion:aI})}}return this},aB=function(m,q){var h,g,f,k,u,j=bZ[this.id],p=j&&j.handlers;if(!p){return this}if(0===arguments.length){k=a5(p)}else{if("string"==typeof m&&m){k=m.split(/\s+/)}else{if("object"==typeof m&&m&&"undefined"==typeof q){for(h in m){bj.call(m,h)&&"string"==typeof h&&h&&"function"==typeof m[h]&&this.off(h,m[h])}}}}if(k&&k.length){for(h=0,g=k.length;g>h;h++){if(m=k[h].toLowerCase().replace(/^on/,""),u=p[m],u&&u.length){if(q){for(f=u.indexOf(q);-1!==f;){u.splice(f,1),f=u.indexOf(q,f)}}else{u.length=0}}}}return this},b0=function(g){var f=null,h=bZ[this.id]&&bZ[this.id].handlers;return h&&(f="string"==typeof g&&g?h[g]?h[g].slice(0):[]:aR(h)),f},aw=function(g){if(au.call(this,g)){"object"==typeof g&&g&&"string"==typeof g.type&&g.type&&(g=bn({},g));var f=bn({},bQ(g),{client:this});a6.call(this,f)}return this},bM=function(g){if(!bZ[this.id]){throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance")}g=ai(g);for(var f=0;f<g.length;f++){if(bj.call(g,f)&&g[f]&&1===g[f].nodeType){g[f].zcClippingId?-1===av[g[f].zcClippingId].indexOf(this.id)&&av[g[f].zcClippingId].push(this.id):(g[f].zcClippingId="zcClippingId_"+aW++,av[g[f].zcClippingId]=[this.id],bl.autoActivate===!0&&bW(g[f]));var h=bZ[this.id]&&bZ[this.id].elements;-1===h.indexOf(g[f])&&h.push(g[f])}}return this},bY=function(j){var g=bZ[this.id];if(!g){return this}var l,k=g.elements;j="undefined"==typeof j?k.slice(0):ai(j);for(var h=j.length;h--;){if(bj.call(j,h)&&j[h]&&1===j[h].nodeType){for(l=0;-1!==(l=k.indexOf(j[h],l));){k.splice(l,1)}var f=av[j[h].zcClippingId];if(f){for(l=0;-1!==(l=f.indexOf(this.id,l));){f.splice(l,1)}0===f.length&&(bl.autoActivate===!0&&al(j[h]),delete j[h].zcClippingId)}}}return this},bF=function(){var f=bZ[this.id];return f&&f.elements?f.elements.slice(0):[]},aH=function(){bZ[this.id]&&(this.unclip(),this.off(),delete bZ[this.id])},au=function(k){if(!k||!k.type){return !1}if(k.client&&k.client!==this){return !1}var g=bZ[this.id],m=g&&g.elements,l=!!m&&m.length>0,j=!k.target||l&&-1!==m.indexOf(k.target),f=k.relatedTarget&&l&&-1!==m.indexOf(k.relatedTarget),h=k.client&&k.client===this;return !(!g||!(j||f||h))},a6=function(m){var x=bZ[this.id];if("object"==typeof m&&m&&m.type&&x){var j=bV(m),g=x&&x.handlers["*"]||[],f=x&&x.handlers[m.type]||[],k=g.concat(f);if(k&&k.length){var y,v,w,q,l,p=this;for(y=0,v=k.length;v>y;y++){w=k[y],q=p,"string"==typeof w&&"function"==typeof aQ[w]&&(w=aQ[w]),"object"==typeof w&&w&&"function"==typeof w.handleEvent&&(q=w,w=w.handleEvent),"function"==typeof w&&(l=bn({},m),bi(w,q,[l],j))}}}},ai=function(f){return"string"==typeof f&&(f=[]),"number"!=typeof f.length?[f]:f},bW=function(g){if(g&&1===g.nodeType){var f=function(i){(i||(i=aQ.event))&&("js"!==i._source&&(i.stopImmediatePropagation(),i.preventDefault()),delete i._source)},h=function(i){(i||(i=aQ.event))&&(f(i),aq.focus(g))};g.addEventListener("mouseover",h,!1),g.addEventListener("mouseout",f,!1),g.addEventListener("mouseenter",f,!1),g.addEventListener("mouseleave",f,!1),g.addEventListener("mousemove",f,!1),b8[g.zcClippingId]={mouseover:h,mouseout:f,mouseenter:f,mouseleave:f,mousemove:f}}},al=function(k){if(k&&1===k.nodeType){var g=b8[k.zcClippingId];if("object"==typeof g&&g){for(var m,l,j=["move","leave","enter","out","over"],f=0,h=j.length;h>f;f++){m="mouse"+j[f],l=g[m],"function"==typeof l&&k.removeEventListener(m,l,!1)}delete b8[k.zcClippingId]}}};aq._createClient=function(){bh.apply(this,br(arguments))},aq.prototype.on=function(){return ba.apply(this,br(arguments))},aq.prototype.off=function(){return aB.apply(this,br(arguments))},aq.prototype.handlers=function(){return b0.apply(this,br(arguments))},aq.prototype.emit=function(){return aw.apply(this,br(arguments))},aq.prototype.clip=function(){return bM.apply(this,br(arguments))},aq.prototype.unclip=function(){return bY.apply(this,br(arguments))},aq.prototype.elements=function(){return bF.apply(this,br(arguments))},aq.prototype.destroy=function(){return aH.apply(this,br(arguments))},aq.prototype.setText=function(f){if(!bZ[this.id]){throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance")}return aq.setData("text/plain",f),this},aq.prototype.setHtml=function(f){if(!bZ[this.id]){throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance")}return aq.setData("text/html",f),this},aq.prototype.setRichText=function(f){if(!bZ[this.id]){throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance")}return aq.setData("application/rtf",f),this},aq.prototype.setData=function(){if(!bZ[this.id]){throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance")}return aq.setData.apply(this,br(arguments)),this},aq.prototype.clearData=function(){if(!bZ[this.id]){throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance")}return aq.clearData.apply(this,br(arguments)),this},aq.prototype.getData=function(){if(!bZ[this.id]){throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance")}return aq.getData.apply(this,br(arguments))},"function"==typeof b&&b.amd?b(function(){return aq}):"object"==typeof e&&e&&"object"==typeof e.exports&&e.exports?e.exports=aq:aF.ZeroClipboard=aq}(function(){return this||window}())},{}]},{},[23,61,63,62,64,85,86,87,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,88,89,90,91,105,106,107,108,94,95,96,97,98,99,31,35,32,33,40,34,36,37,38,39])(23)});